{
  "file_path": "src/web/manager/ManagerApp.tsx",
  "main_branch_history": [],
  "task_views": {
    "004-document-frontend-react-components-and-hooks": {
      "task_id": "004-document-frontend-react-components-and-hooks",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "import React, { useState, useEffect, useCallback } from 'react';\nimport HomePage from './components/HomePage';\nimport LandingPage from './components/LandingPage';\nimport ValidationPage from './components/ValidationPage';\nimport AgentConfigModal from './components/AgentConfigModal';\nimport type { Agent, ValidationStep } from './types';\nimport { ManagerView } from './types';\nimport Layout from './components/layout/Layout';\nimport DashboardPage from './components/DashboardPage';\nimport AgentsPage from './components/AgentsPage';\nimport CommandsPage from './components/CommandsPage';\nimport SkillsPage from './components/SkillsPage';\nimport MCPServersPage from './components/MCPServersPage';\nimport TasksPage from './components/TasksPage';\nimport SettingsPage from './components/SettingsPage';\nimport * as api from './services/api';\nimport ChatPage from './components/ChatPage';\n\ntype SetupStep = 'home' | 'landing' | 'validating';\n\nconst App: React.FC = () => {\n  const [view, setView] = useState<'setup' | 'dashboard'>('setup');\n  const [setupStep, setSetupStep] = useState<SetupStep>('home');\n\n  const [directoryHandle, setDirectoryHandle] = useState<object | null>(null);\n  const [directoryName, setDirectoryName] = useState<string | undefined>(undefined);\n\n  const [validationSteps, setValidationSteps] = useState<ValidationStep[]>([]);\n  const [discoveredAgents, setDiscoveredAgents] = useState<api.Agent[]>([]);\n  const [discoveredCommands, setDiscoveredCommands] = useState<api.SlashCommand[]>([]);\n  const [discoveredSkills, setDiscoveredSkills] = useState<api.Skill[]>([]);\n  const [selectedAgent, setSelectedAgent] = useState<Agent | null>(null);\n  const [managerView, setManagerView] = useState<ManagerView>(ManagerView.Dashboard);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  // Load saved directory from localStorage on mount\n  useEffect(() => {\n    const savedDirName = localStorage.getItem('claude-agent-manager-dir');\n    if (savedDirName) {\n      setDirectoryName(savedDirName);\n    }\n  }, []);\n\n  const handleGetStarted = () => setSetupStep('landing');\n\n  const handleDirectoryChange = (path: string) => {\n    if (path) {\n      setDirectoryName(path);\n      setDirectoryHandle({});\n      localStorage.setItem('claude-agent-manager-dir', path);\n    }\n  };\n\n  const startValidation = useCallback(async () => {\n    setSetupStep('validating');\n    const steps: ValidationStep[] = [\n      { id: 'cli', label: 'Checking for Claude Code CLI...', status: 'pending' },\n      { id: 'sdk', label: 'Verifying Claude SDK installation...', status: 'pending' },\n      { id: 'folder', label: 'Looking for .claude folder...', status: 'pending' },\n      { id: 'agents', label: 'Parsing agents...', status: 'pending' },\n      { id: 'commands', label: 'Parsing slash commands...', status: 'pending' },\n      { id: 'skills', label: 'Parsing skills...', status: 'pending' },\n    ];\n    setValidationSteps(steps);\n\n    try {\n      // Call validation API\n      await new Promise(resolve => setTimeout(resolve, 300));\n      setValidationSteps(prev => prev.map(s => ({ ...s, status: 'loading' })));\n\n      const result = await api.validateProject(directoryName || '');\n\n      // Update each step based on results\n      const updatedSteps = steps.map(step => {\n        const resultKey = step.id as keyof typeof result;\n        const stepResult = result[resultKey];\n\n        if (!stepResult) {\n          return { ...step, status: 'success' as const };\n        }\n\n        return {\n          ...step,\n          status: stepResult.status === 'success' ? 'success' as const : 'error' as const,\n          label: stepResult.message || step.label,\n          error: stepResult.status === 'error' ? stepResult.message : undefined,\n        };\n      });\n\n      setValidationSteps(updatedSteps);\n\n      // Check if all successful\n      const allSuccess = updatedSteps.every(s => s.status === 'success');\n      if (allSuccess) {\n        // Load agents, commands, and skills\n        await new Promise(resolve => setTimeout(resolve, 500));\n        const analysis = await api.analyzeProject(directoryName);\n\n        setDiscoveredAgents(analysis.agents);\n        setDiscoveredCommands(analysis.commands);\n        setDiscoveredSkills(analysis.skills);\n\n        setView('dashboard');\n        setManagerView(ManagerView.Dashboard);\n        setIsLoading(false);\n      }\n    } catch (error) {\n      console.error('Validation error:', error);\n      setValidationSteps(prev => prev.map(s => ({\n        ...s,\n        status: 'error' as const,\n        error: 'Failed to connect to API'\n      })));\n    }\n  }, [directoryName]);\n\n  const handleChangeDirectory = () => {\n    setView('setup');\n    setSetupStep('landing');\n    setDirectoryHandle(null);\n    // Keep directoryName so user sees their last choice\n  };\n\n  const handleNextFromLanding = () => directoryHandle && startValidation();\n\n  const handleBackToHome = () => {\n    setSetupStep('home');\n    setDirectoryHandle(null);\n    setDirectoryName(undefined);\n    localStorage.removeItem('claude-agent-manager-dir');\n  };\n\n  const handleAgentCreated = async () => {\n    // Reload agents list\n    if (directoryName) {\n      try {\n        const agents = await api.getAgents(directoryName);\n        setDiscoveredAgents(agents);\n      } catch (error) {\n        console.error('Failed to reload agents:', error);\n      }\n    }\n  };\n\n  const handleSkillCreated = async () => {\n    // Reload skills list\n    if (directoryName) {\n      try {\n        const skills = await api.getSkills(directoryName);\n        setDiscoveredSkills(skills);\n      } catch (error) {\n        console.error('Failed to reload skills:', error);\n      }\n    }\n  };\n\n  const renderSetupContent = () => {\n    switch (setupStep) {\n      case 'home':\n        return <HomePage onGetStarted={handleGetStarted} />;\n      case 'landing':\n        return (\n          <LandingPage\n            onDirectoryChange={handleDirectoryChange}\n            onNext={handleNextFromLanding}\n            directorySelected={!!directoryHandle}\n            directoryName={directoryName}\n            onBack={handleBackToHome}\n          />\n        );\n      case 'validating':\n        return <ValidationPage steps={validationSteps} onRetry={startValidation} />;\n      default:\n        return <HomePage onGetStarted={handleGetStarted} />;\n    }\n  };\n\n  const renderDashboardContent = () => {\n    switch(managerView) {\n      case ManagerView.Dashboard:\n        return <DashboardPage />;\n      case ManagerView.Chat:\n        return <ChatPage />;\n      case ManagerView.Agents:\n        return <AgentsPage agents={discoveredAgents} directory={directoryName} onAgentCreated={handleAgentCreated} />;\n      case ManagerView.Commands:\n        return <CommandsPage commands={discoveredCommands} />;\n      case ManagerView.Skills:\n        return <SkillsPage skills={discoveredSkills} onRefresh={handleSkillCreated} />;\n      case ManagerView.MCPServers:\n        return <MCPServersPage directory={directoryName} />;\n      case ManagerView.Tasks:\n        return <TasksPage />;\n      case ManagerView.Settings:\n        return <SettingsPage directoryName={directoryName} onDirectoryChange={handleDirectoryChange} />;\n      default:\n        return <DashboardPage />;\n    }\n  };\n\n  if (view === 'setup') {\n    return (\n      <main className=\"flex min-h-screen flex-col items-center justify-center p-4\">\n        {renderSetupContent()}\n      </main>\n    );\n  }\n\n  return (\n    <Layout\n      sidebarProps={{\n        activeView: managerView,\n        onNavigate: setManagerView,\n        directoryName: directoryName,\n        onChangeDirectory: handleChangeDirectory,\n      }}\n      noContainer={managerView === ManagerView.Chat}\n    >\n      {renderDashboardContent()}\n      {selectedAgent && (\n        <AgentConfigModal\n          agent={selectedAgent}\n          isOpen={!!selectedAgent}\n          onClose={() => setSelectedAgent(null)}\n        />\n      )}\n    </Layout>\n  );\n};\n\nexport default App;\n",
        "timestamp": "2026-01-02T14:22:14.293924"
      },
      "worktree_state": {
        "content": "/**\n * @file ManagerApp.tsx\n * @description Main application component that manages routing, setup workflow, and dashboard navigation.\n * This is the root component of the Claude Agent Manager UI, handling the complete application lifecycle\n * from initial setup through project validation to the main dashboard interface.\n *\n * ## Features\n * - **Two-Phase Workflow**: Setup phase for project initialization, dashboard phase for management\n * - **Multi-Step Setup**: Home \u2192 Landing (directory selection) \u2192 Validation \u2192 Dashboard\n * - **Routing Configuration**: Client-side routing between 8 different dashboard views\n * - **Directory Management**: Persistent directory selection via localStorage with change capability\n * - **Project Validation**: Automated validation of Claude Code CLI, SDK, and project structure\n * - **Resource Discovery**: Automatic parsing and loading of agents, commands, and skills\n * - **State Management**: Centralized state for view navigation, directory, and discovered resources\n * - **Error Handling**: Comprehensive error handling with retry capability for validation failures\n *\n * ## Application Lifecycle\n * The app follows a sequential lifecycle from initialization through to active management:\n *\n * ### 1. Initialization (Mount)\n * - **Load Saved Directory**: Check localStorage for 'claude-agent-manager-dir' key\n * - **Restore State**: If directory found, populate directoryName state\n * - **Default View**: Start in 'setup' view with 'home' step\n * - **No Auto-Navigation**: User must explicitly start the workflow\n *\n * ### 2. Setup Phase (view='setup')\n * The setup phase consists of three steps:\n *\n * #### Step 1: Home (setupStep='home')\n * - **Display**: HomePage component with welcome message and \"Get Started\" button\n * - **User Action**: Click \"Get Started\" to proceed\n * - **Transition**: `handleGetStarted()` \u2192 setupStep='landing'\n *\n * #### Step 2: Landing (setupStep='landing')\n * - **Display**: LandingPage component with directory selection interface\n * - **Directory Selection**: User enters directory path (text input)\n * - **State Updates**: `handleDirectoryChange(path)` saves to state and localStorage\n * - **Validation**: Next button enabled only when directoryHandle is set\n * - **User Actions**:\n *   - Back button \u2192 return to home step, clear directory\n *   - Next button \u2192 proceed to validation step\n * - **Transition**: `handleNextFromLanding()` \u2192 setupStep='validating'\n *\n * #### Step 3: Validating (setupStep='validating')\n * - **Display**: ValidationPage component showing 6 validation steps with status\n * - **Automatic Execution**: `startValidation()` called automatically on mount\n * - **Validation Steps**:\n *   1. CLI check: Verify Claude Code CLI exists\n *   2. SDK check: Verify Claude SDK installation\n *   3. Folder check: Look for .claude folder in directory\n *   4. Agents parsing: Parse and validate agent configurations\n *   5. Commands parsing: Parse slash commands\n *   6. Skills parsing: Parse skill definitions\n * - **API Calls**:\n *   - `api.validateProject(directory)` \u2192 validation results\n *   - `api.analyzeProject(directory)` \u2192 discovered resources (if all validation passes)\n * - **Success Path**: All steps pass \u2192 load resources \u2192 transition to dashboard\n * - **Failure Path**: Any step fails \u2192 show error message with retry button\n * - **Transition**: All success \u2192 view='dashboard', managerView=Dashboard\n *\n * ### 3. Dashboard Phase (view='dashboard')\n * Once validation succeeds, the app enters the main dashboard interface:\n *\n * - **Layout**: Full Layout component with Sidebar navigation\n * - **Active View**: Controlled by managerView state (ManagerView enum)\n * - **Navigation**: Sidebar onNavigate callback updates managerView\n * - **Page Rendering**: `renderDashboardContent()` renders page based on managerView\n * - **Directory Display**: Sidebar shows selected directory with \"Change Directory\" button\n * - **Change Directory**: Returns to setup phase (landing step) with directory preserved\n *\n * ## Routing Configuration\n * Client-side routing is managed through the ManagerView enum and state-based rendering:\n *\n * ### View Routes (ManagerView enum)\n * 1. **Dashboard** (ManagerView.Dashboard)\n *    - Component: DashboardPage\n *    - Purpose: Overview metrics and quick actions\n *    - Container: Full layout with container\n *\n * 2. **Chat** (ManagerView.Chat)\n *    - Component: ChatPage\n *    - Purpose: Interactive chat sessions with agents and skills\n *    - Container: Full layout WITHOUT container (noContainer=true for full-width)\n *\n * 3. **Agents** (ManagerView.Agents)\n *    - Component: AgentsPage\n *    - Purpose: Agent listing, creation, editing, execution\n *    - Props: agents array, directory, onAgentCreated callback\n *    - Container: Full layout with container\n *\n * 4. **Commands** (ManagerView.Commands)\n *    - Component: CommandsPage\n *    - Purpose: Slash command listing and execution\n *    - Props: commands array\n *    - Container: Full layout with container\n *\n * 5. **Skills** (ManagerView.Skills)\n *    - Component: SkillsPage\n *    - Purpose: Skill management, creation, training\n *    - Props: skills array, onRefresh callback\n *    - Container: Full layout with container\n *\n * 6. **MCPServers** (ManagerView.MCPServers)\n *    - Component: MCPServersPage\n *    - Purpose: MCP server configuration and tool management\n *    - Props: directory\n *    - Container: Full layout with container\n *\n * 7. **Tasks** (ManagerView.Tasks)\n *    - Component: TasksPage\n *    - Purpose: Task execution history and status\n *    - Container: Full layout with container\n *\n * 8. **Settings** (ManagerView.Settings)\n *    - Component: SettingsPage\n *    - Purpose: Application settings and preferences\n *    - Props: directoryName, onDirectoryChange callback\n *    - Container: Full layout with container\n *\n * ### Route Switching\n * - **Trigger**: Sidebar navigation item click\n * - **Handler**: `setManagerView(newView)` called by sidebar onNavigate\n * - **Re-Render**: App re-renders, renderDashboardContent() returns new page component\n * - **Layout Persistence**: Layout and Sidebar remain mounted, only main content changes\n * - **No Page Reload**: Pure client-side routing with React state\n *\n * ## Directory Management\n * Directory selection is central to the app, enabling project-specific resource management:\n *\n * ### Directory Selection Flow\n * 1. **User Input**: Enter path in LandingPage text input\n * 2. **Handle Change**: `handleDirectoryChange(path)` invoked\n * 3. **State Updates**:\n *    - `setDirectoryName(path)` \u2192 updates UI with selected path\n *    - `setDirectoryHandle({})` \u2192 marks directory as selected (enables Next button)\n *    - `localStorage.setItem('claude-agent-manager-dir', path)` \u2192 persists selection\n * 4. **Propagation**: Directory passed as prop to all resource-dependent components\n *\n * ### Directory Persistence\n * - **Storage Key**: 'claude-agent-manager-dir'\n * - **Storage Type**: localStorage (persists across sessions)\n * - **Load Timing**: useEffect on mount (runs once)\n * - **Restoration**: If found, populates directoryName state\n * - **Clear Trigger**: \"Back to Home\" button in LandingPage\n *\n * ### Directory Usage\n * Directory is passed to components that need project context:\n * - **API Calls**: validateProject(directory), analyzeProject(directory), getAgents(directory), getSkills(directory)\n * - **Component Props**: AgentsPage, MCPServersPage, SettingsPage, AgentCreatorChatPanel, SkillCreatorChatPanel\n * - **Sidebar Display**: Shows current directory name with truncation\n *\n * ### Change Directory Flow\n * 1. **Trigger**: Click \"Change Directory\" button in Sidebar\n * 2. **Handler**: `handleChangeDirectory()` called\n * 3. **State Changes**:\n *    - `setView('setup')` \u2192 return to setup phase\n *    - `setSetupStep('landing')` \u2192 go directly to directory selection\n *    - `setDirectoryHandle(null)` \u2192 clear selection flag\n *    - Keep directoryName \u2192 user sees last selection in input\n * 4. **User Flow**: User can enter new path \u2192 re-validate \u2192 return to dashboard\n *\n * ## State Management\n * The app manages multiple categories of state for coordinating the complex workflow:\n *\n * ### View Navigation State\n * - **view**: 'setup' | 'dashboard' - Top-level phase toggle\n * - **setupStep**: 'home' | 'landing' | 'validating' - Setup sub-steps\n * - **managerView**: ManagerView enum - Dashboard page routing\n *\n * ### Directory State\n * - **directoryHandle**: object | null - Selection flag for enabling Next button\n * - **directoryName**: string | undefined - Selected directory path for display and API calls\n *\n * ### Validation State\n * - **validationSteps**: ValidationStep[] - Array of 6 validation steps with status/error\n * - Each step: `{ id, label, status: 'pending'|'loading'|'success'|'error', error? }`\n *\n * ### Resource Discovery State\n * - **discoveredAgents**: api.Agent[] - Parsed agents from .claude/agents/\n * - **discoveredCommands**: api.SlashCommand[] - Parsed commands from .claude/commands/\n * - **discoveredSkills**: api.Skill[] - Parsed skills from .claude/skills/\n * - **isLoading**: boolean - Loading flag for initial data fetch\n *\n * ### Modal State\n * - **selectedAgent**: Agent | null - Agent for AgentConfigModal (currently unused in main flow)\n *\n * ### State Updates\n * State is updated through handler functions:\n * - **Navigation**: `setView()`, `setSetupStep()`, `setManagerView()`\n * - **Directory**: `handleDirectoryChange()`, `handleChangeDirectory()`\n * - **Validation**: `startValidation()` with step-by-step updates\n * - **Resources**: `handleAgentCreated()`, `handleSkillCreated()` for refreshing lists\n *\n * ## Theme Handling\n * The application uses a consistent dark theme throughout:\n *\n * ### Setup Phase Styling\n * - **Container**: `min-h-screen flex flex-col items-center justify-center p-4`\n * - **Centering**: Full viewport height with centered content\n * - **Padding**: p-4 for mobile-friendly spacing\n * - **Background**: Inherits from global styles (dark theme)\n *\n * ### Dashboard Phase Styling\n * - **Layout Component**: Provides consistent structure with Sidebar\n * - **Theme**: Dark theme with Tailwind CSS variables (bg-background, text-foreground, etc.)\n * - **Container Mode**: Most pages use container, Chat uses full-width (noContainer=true)\n * - **Responsive**: Layout handles mobile/tablet/desktop breakpoints\n *\n * ### Color Scheme\n * - **Primary**: Blue accent for active states and primary actions\n * - **Secondary**: Gray variants for secondary UI elements\n * - **Background**: Dark gray (bg-background)\n * - **Foreground**: Light gray text (text-foreground)\n * - **Muted**: Dimmed text for less important content (text-muted-foreground)\n * - **Error**: Red for validation failures and errors\n * - **Success**: Green for successful validation steps\n *\n * ## Error Handling\n * The app provides comprehensive error handling with user feedback:\n *\n * ### Validation Errors\n * - **Catch Block**: `try/catch` around validation API calls\n * - **Error Display**: Updates all validation steps to 'error' status\n * - **Error Message**: \"Failed to connect to API\" shown in ValidationPage\n * - **Retry Button**: User can click retry to re-run `startValidation()`\n * - **Console Logging**: Errors logged to console for debugging\n *\n * ### Resource Reload Errors\n * - **Agent Reload**: `handleAgentCreated()` catches and logs errors\n * - **Skill Reload**: `handleSkillCreated()` catches and logs errors\n * - **Silent Failure**: Errors don't block UI, only logged to console\n * - **User Impact**: Resource lists may be stale if reload fails\n *\n * ### API Error Handling\n * - **Connection Failures**: Generic \"Failed to connect to API\" message\n * - **Validation Step Failures**: Individual step errors shown with specific messages\n * - **No Network Retry**: User must manually retry validation\n *\n * @example\n * // Basic usage - render as root app component\n * import ManagerApp from './ManagerApp';\n *\n * function Root() {\n *   return <ManagerApp />;\n * }\n *\n * @example\n * // Understanding the setup flow\n * // 1. User lands on HomePage\n * // 2. Clicks \"Get Started\" \u2192 LandingPage appears\n * // 3. Enters directory path \"/Users/alice/my-project\"\n * // 4. Clicks \"Next\" \u2192 ValidationPage appears\n * // 5. Validation runs automatically:\n * //    - CLI check \u2713\n * //    - SDK check \u2713\n * //    - Folder check \u2713\n * //    - Parse agents \u2713 (found 3 agents)\n * //    - Parse commands \u2713 (found 5 commands)\n * //    - Parse skills \u2713 (found 2 skills)\n * // 6. All pass \u2192 Dashboard loads with discovered resources\n * // 7. Sidebar shows \"/Users/alice/my-project\" with navigation menu\n *\n * @example\n * // Understanding dashboard navigation\n * // User clicks \"Agents\" in Sidebar\n * // \u2192 setManagerView(ManagerView.Agents) called\n * // \u2192 App re-renders\n * // \u2192 renderDashboardContent() returns <AgentsPage agents={discoveredAgents} ... />\n * // \u2192 Layout persists, main content swaps to AgentsPage\n * // \u2192 User sees list of 3 discovered agents\n *\n * @example\n * // Understanding directory change flow\n * // User in Dashboard, clicks \"Change Directory\" in Sidebar\n * // \u2192 handleChangeDirectory() called\n * // \u2192 setView('setup'), setSetupStep('landing')\n * // \u2192 App re-renders to LandingPage with last directory shown\n * // \u2192 User enters new path \"/Users/alice/other-project\"\n * // \u2192 Clicks \"Next\" \u2192 validation runs for new directory\n * // \u2192 Dashboard loads with new project's resources\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport HomePage from './components/HomePage';\nimport LandingPage from './components/LandingPage';\nimport ValidationPage from './components/ValidationPage';\nimport AgentConfigModal from './components/AgentConfigModal';\nimport type { Agent, ValidationStep } from './types';\nimport { ManagerView } from './types';\nimport Layout from './components/layout/Layout';\nimport DashboardPage from './components/DashboardPage';\nimport AgentsPage from './components/AgentsPage';\nimport CommandsPage from './components/CommandsPage';\nimport SkillsPage from './components/SkillsPage';\nimport MCPServersPage from './components/MCPServersPage';\nimport TasksPage from './components/TasksPage';\nimport SettingsPage from './components/SettingsPage';\nimport * as api from './services/api';\nimport ChatPage from './components/ChatPage';\n\n/**\n * Setup step type for the three-step onboarding workflow.\n *\n * @typedef {'home' | 'landing' | 'validating'} SetupStep\n * - **home**: Welcome screen with \"Get Started\" button\n * - **landing**: Directory selection interface\n * - **validating**: Project validation with progress indicators\n */\ntype SetupStep = 'home' | 'landing' | 'validating';\n\n/**\n * Main application component for Claude Agent Manager.\n *\n * Manages the complete application lifecycle including:\n * - Initial setup and directory selection\n * - Project validation and resource discovery\n * - Dashboard routing and navigation\n * - State management for all discovered resources\n *\n * This is a stateful component with no props, managing all state internally.\n * It serves as the root component and handles routing between setup and dashboard phases.\n */\nconst App: React.FC = () => {\n  const [view, setView] = useState<'setup' | 'dashboard'>('setup');\n  const [setupStep, setSetupStep] = useState<SetupStep>('home');\n\n  const [directoryHandle, setDirectoryHandle] = useState<object | null>(null);\n  const [directoryName, setDirectoryName] = useState<string | undefined>(undefined);\n\n  const [validationSteps, setValidationSteps] = useState<ValidationStep[]>([]);\n  const [discoveredAgents, setDiscoveredAgents] = useState<api.Agent[]>([]);\n  const [discoveredCommands, setDiscoveredCommands] = useState<api.SlashCommand[]>([]);\n  const [discoveredSkills, setDiscoveredSkills] = useState<api.Skill[]>([]);\n  const [selectedAgent, setSelectedAgent] = useState<Agent | null>(null);\n  const [managerView, setManagerView] = useState<ManagerView>(ManagerView.Dashboard);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n\n  /**\n   * Load saved directory from localStorage on component mount.\n   * Runs once on initialization to restore the user's last selected directory.\n   *\n   * @internal\n   */\n  useEffect(() => {\n    const savedDirName = localStorage.getItem('claude-agent-manager-dir');\n    if (savedDirName) {\n      setDirectoryName(savedDirName);\n    }\n  }, []);\n\n  /**\n   * Handle \"Get Started\" button click from HomePage.\n   * Transitions from home step to landing (directory selection) step.\n   *\n   * @internal\n   */\n  const handleGetStarted = () => setSetupStep('landing');\n\n  /**\n   * Handle directory path change from LandingPage input.\n   * Updates state and persists to localStorage for restoration on next session.\n   *\n   * @internal\n   * @param {string} path - The selected directory path\n   */\n  const handleDirectoryChange = (path: string) => {\n    if (path) {\n      setDirectoryName(path);\n      setDirectoryHandle({});\n      localStorage.setItem('claude-agent-manager-dir', path);\n    }\n  };\n\n  /**\n   * Start project validation workflow.\n   * Calls API to validate project structure and parse resources.\n   * Updates validation steps with real-time progress and results.\n   *\n   * **Validation Workflow:**\n   * 1. Initialize 6 validation steps with 'pending' status\n   * 2. Set all steps to 'loading' status\n   * 3. Call `api.validateProject(directory)` for validation\n   * 4. Update each step based on API results (success/error)\n   * 5. If all successful, call `api.analyzeProject(directory)` to load resources\n   * 6. Transition to dashboard view with loaded agents, commands, skills\n   * 7. On error, mark all steps as 'error' with message\n   *\n   * @internal\n   */\n  const startValidation = useCallback(async () => {\n    setSetupStep('validating');\n    const steps: ValidationStep[] = [\n      { id: 'cli', label: 'Checking for Claude Code CLI...', status: 'pending' },\n      { id: 'sdk', label: 'Verifying Claude SDK installation...', status: 'pending' },\n      { id: 'folder', label: 'Looking for .claude folder...', status: 'pending' },\n      { id: 'agents', label: 'Parsing agents...', status: 'pending' },\n      { id: 'commands', label: 'Parsing slash commands...', status: 'pending' },\n      { id: 'skills', label: 'Parsing skills...', status: 'pending' },\n    ];\n    setValidationSteps(steps);\n\n    try {\n      // Call validation API\n      await new Promise(resolve => setTimeout(resolve, 300));\n      setValidationSteps(prev => prev.map(s => ({ ...s, status: 'loading' })));\n\n      const result = await api.validateProject(directoryName || '');\n\n      // Update each step based on results\n      const updatedSteps = steps.map(step => {\n        const resultKey = step.id as keyof typeof result;\n        const stepResult = result[resultKey];\n\n        if (!stepResult) {\n          return { ...step, status: 'success' as const };\n        }\n\n        return {\n          ...step,\n          status: stepResult.status === 'success' ? 'success' as const : 'error' as const,\n          label: stepResult.message || step.label,\n          error: stepResult.status === 'error' ? stepResult.message : undefined,\n        };\n      });\n\n      setValidationSteps(updatedSteps);\n\n      // Check if all successful\n      const allSuccess = updatedSteps.every(s => s.status === 'success');\n      if (allSuccess) {\n        // Load agents, commands, and skills\n        await new Promise(resolve => setTimeout(resolve, 500));\n        const analysis = await api.analyzeProject(directoryName);\n\n        setDiscoveredAgents(analysis.agents);\n        setDiscoveredCommands(analysis.commands);\n        setDiscoveredSkills(analysis.skills);\n\n        setView('dashboard');\n        setManagerView(ManagerView.Dashboard);\n        setIsLoading(false);\n      }\n    } catch (error) {\n      console.error('Validation error:', error);\n      setValidationSteps(prev => prev.map(s => ({\n        ...s,\n        status: 'error' as const,\n        error: 'Failed to connect to API'\n      })));\n    }\n  }, [directoryName]);\n\n  /**\n   * Handle \"Change Directory\" button click from Sidebar.\n   * Returns to setup phase (landing step) while preserving the current directory name\n   * in the input field, allowing user to edit or enter a new directory.\n   *\n   * @internal\n   */\n  const handleChangeDirectory = () => {\n    setView('setup');\n    setSetupStep('landing');\n    setDirectoryHandle(null);\n    // Keep directoryName so user sees their last choice\n  };\n\n  /**\n   * Handle \"Next\" button click from LandingPage.\n   * Only proceeds if directoryHandle is set (directory selected).\n   * Calls startValidation() to begin the validation workflow.\n   *\n   * @internal\n   */\n  const handleNextFromLanding = () => directoryHandle && startValidation();\n\n  /**\n   * Handle \"Back\" button click from LandingPage.\n   * Returns to home step and clears all directory-related state and localStorage.\n   *\n   * @internal\n   */\n  const handleBackToHome = () => {\n    setSetupStep('home');\n    setDirectoryHandle(null);\n    setDirectoryName(undefined);\n    localStorage.removeItem('claude-agent-manager-dir');\n  };\n\n  /**\n   * Handle agent creation completion callback.\n   * Reloads the agents list from the API to include the newly created agent.\n   * Called by AgentsPage when an agent is successfully created.\n   *\n   * @internal\n   */\n  const handleAgentCreated = async () => {\n    // Reload agents list\n    if (directoryName) {\n      try {\n        const agents = await api.getAgents(directoryName);\n        setDiscoveredAgents(agents);\n      } catch (error) {\n        console.error('Failed to reload agents:', error);\n      }\n    }\n  };\n\n  /**\n   * Handle skill creation completion callback.\n   * Reloads the skills list from the API to include the newly created skill.\n   * Called by SkillsPage when a skill is successfully created.\n   *\n   * @internal\n   */\n  const handleSkillCreated = async () => {\n    // Reload skills list\n    if (directoryName) {\n      try {\n        const skills = await api.getSkills(directoryName);\n        setDiscoveredSkills(skills);\n      } catch (error) {\n        console.error('Failed to reload skills:', error);\n      }\n    }\n  };\n\n  /**\n   * Render setup phase content based on current setupStep.\n   * Returns the appropriate page component for each step in the onboarding flow.\n   *\n   * @internal\n   * @returns {JSX.Element} The setup page component to render\n   */\n  const renderSetupContent = () => {\n    switch (setupStep) {\n      case 'home':\n        return <HomePage onGetStarted={handleGetStarted} />;\n      case 'landing':\n        return (\n          <LandingPage\n            onDirectoryChange={handleDirectoryChange}\n            onNext={handleNextFromLanding}\n            directorySelected={!!directoryHandle}\n            directoryName={directoryName}\n            onBack={handleBackToHome}\n          />\n        );\n      case 'validating':\n        return <ValidationPage steps={validationSteps} onRetry={startValidation} />;\n      default:\n        return <HomePage onGetStarted={handleGetStarted} />;\n    }\n  };\n\n  /**\n   * Render dashboard content based on current managerView.\n   * Returns the appropriate page component for the selected dashboard view.\n   * Each page receives relevant props including discovered resources and callbacks.\n   *\n   * @internal\n   * @returns {JSX.Element} The dashboard page component to render\n   */\n  const renderDashboardContent = () => {\n    switch(managerView) {\n      case ManagerView.Dashboard:\n        return <DashboardPage />;\n      case ManagerView.Chat:\n        return <ChatPage />;\n      case ManagerView.Agents:\n        return <AgentsPage agents={discoveredAgents} directory={directoryName} onAgentCreated={handleAgentCreated} />;\n      case ManagerView.Commands:\n        return <CommandsPage commands={discoveredCommands} />;\n      case ManagerView.Skills:\n        return <SkillsPage skills={discoveredSkills} onRefresh={handleSkillCreated} />;\n      case ManagerView.MCPServers:\n        return <MCPServersPage directory={directoryName} />;\n      case ManagerView.Tasks:\n        return <TasksPage />;\n      case ManagerView.Settings:\n        return <SettingsPage directoryName={directoryName} onDirectoryChange={handleDirectoryChange} />;\n      default:\n        return <DashboardPage />;\n    }\n  };\n\n  if (view === 'setup') {\n    return (\n      <main className=\"flex min-h-screen flex-col items-center justify-center p-4\">\n        {renderSetupContent()}\n      </main>\n    );\n  }\n\n  return (\n    <Layout\n      sidebarProps={{\n        activeView: managerView,\n        onNavigate: setManagerView,\n        directoryName: directoryName,\n        onChangeDirectory: handleChangeDirectory,\n      }}\n      noContainer={managerView === ManagerView.Chat}\n    >\n      {renderDashboardContent()}\n      {selectedAgent && (\n        <AgentConfigModal\n          agent={selectedAgent}\n          isOpen={!!selectedAgent}\n          onClose={() => setSelectedAgent(null)}\n        />\n      )}\n    </Layout>\n  );\n};\n\nApp.displayName = 'ManagerApp';\n\nexport default App;\n",
        "last_modified": "2026-01-02T14:22:15.546130"
      },
      "task_intent": {
        "title": "Document Frontend React Components and Hooks",
        "description": "Add comprehensive JSDoc documentation to all React components and custom hooks in the frontend, including prop types, usage examples, component purposes, state management, and side effects.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:01:10.741505",
  "last_updated": "2026-01-02T14:22:14.492257"
}
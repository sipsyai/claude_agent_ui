{
  "file_path": "src/web/manager/components/chat/ToolUseDisplay.tsx",
  "main_branch_history": [],
  "task_views": {
    "004-document-frontend-react-components-and-hooks": {
      "task_id": "004-document-frontend-react-components-and-hooks",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "/**\n * ToolUseDisplay Component\n * Displays tool execution details with expandable input/output sections\n * Based on TaskExecutionModal's tool display logic\n */\n\nimport React, { useState } from 'react';\n\nexport interface ToolUseDisplayProps {\n  toolName: string;\n  toolInput: any;\n  toolResult?: any;\n  isLoading?: boolean;\n  className?: string;\n}\n\nconst ToolUseDisplay: React.FC<ToolUseDisplayProps> = ({\n  toolName,\n  toolInput,\n  toolResult,\n  isLoading = false,\n  className = '',\n}) => {\n  // Auto-expand short results\n  const shouldAutoExpand = typeof toolResult === 'string' && toolResult.length < 200;\n\n  // Tool icon mapping\n  const getToolIcon = (name: string): string => {\n    const iconMap: Record<string, string> = {\n      Read: '\ud83d\udcd6',\n      Write: '\u270d\ufe0f',\n      Edit: '\u270f\ufe0f',\n      Bash: '\ud83d\udcbb',\n      Glob: '\ud83d\udd0d',\n      Grep: '\ud83d\udd0e',\n      Skill: '\ud83c\udfaf',\n      WebFetch: '\ud83c\udf10',\n      WebSearch: '\ud83d\udd0d',\n      Task: '\ud83d\udccb',\n    };\n    return iconMap[name] || '\ud83d\udd27';\n  };\n\n  const copyToClipboard = (text: string) => {\n    navigator.clipboard.writeText(text).then(() => {\n      // Could add a toast notification here\n    });\n  };\n\n  return (\n    <div className={`text-sm space-y-2 p-3 bg-gray-800/50 rounded-lg border border-gray-700 ${className}`}>\n      {/* Tool Name Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"font-medium text-purple-400 flex items-center gap-2\">\n          <span>{getToolIcon(toolName)}</span>\n          <span>{toolName}</span>\n        </div>\n        {isLoading && (\n          <div className=\"flex items-center gap-2 text-xs text-gray-400\">\n            <svg className=\"animate-spin h-3 w-3\" viewBox=\"0 0 24 24\">\n              <circle\n                className=\"opacity-25\"\n                cx=\"12\"\n                cy=\"12\"\n                r=\"10\"\n                stroke=\"currentColor\"\n                strokeWidth=\"4\"\n                fill=\"none\"\n              />\n              <path\n                className=\"opacity-75\"\n                fill=\"currentColor\"\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n              />\n            </svg>\n            <span>Running...</span>\n          </div>\n        )}\n      </div>\n\n      {/* Input Parameters */}\n      {toolInput && (\n        <details className=\"cursor-pointer group\">\n          <summary className=\"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-2 select-none\">\n            <span className=\"group-open:rotate-90 transition-transform inline-block\">\u25b6</span>\n            <span>\ud83d\udce5 Input Parameters</span>\n          </summary>\n          <div className=\"mt-2 relative\">\n            <button\n              onClick={() => copyToClipboard(JSON.stringify(toolInput, null, 2))}\n              className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\n              title=\"Copy to clipboard\"\n            >\n              \ud83d\udccb Copy\n            </button>\n            <pre className=\"text-xs bg-black/40 p-3 pr-16 rounded overflow-x-auto border border-gray-700\">\n              {JSON.stringify(toolInput, null, 2)}\n            </pre>\n          </div>\n        </details>\n      )}\n\n      {/* Output Result */}\n      {toolResult !== undefined && toolResult !== null && (\n        <details className=\"cursor-pointer group\" open={shouldAutoExpand}>\n          <summary className=\"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-2 select-none\">\n            <span className=\"group-open:rotate-90 transition-transform inline-block\">\u25b6</span>\n            <span>\ud83d\udce4 Output Result</span>\n            {!isLoading && (\n              <span className=\"text-green-400 text-xs ml-2\">\u2713</span>\n            )}\n          </summary>\n          <div className=\"mt-2 relative\">\n            <button\n              onClick={() =>\n                copyToClipboard(\n                  typeof toolResult === 'string'\n                    ? toolResult\n                    : JSON.stringify(toolResult, null, 2)\n                )\n              }\n              className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\n              title=\"Copy to clipboard\"\n            >\n              \ud83d\udccb Copy\n            </button>\n            <div className=\"text-xs bg-black/40 p-3 pr-16 rounded overflow-x-auto border border-gray-700 max-h-96 overflow-y-auto\">\n              {typeof toolResult === 'string' ? (\n                <pre className=\"whitespace-pre-wrap break-words\">{toolResult}</pre>\n              ) : (\n                <pre>{JSON.stringify(toolResult, null, 2)}</pre>\n              )}\n            </div>\n          </div>\n        </details>\n      )}\n\n      {/* Loading State */}\n      {isLoading && !toolResult && (\n        <div className=\"text-xs text-gray-400 italic flex items-center gap-2 py-2\">\n          <svg className=\"animate-pulse h-3 w-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" opacity=\"0.25\" />\n            <path d=\"M12 2a10 10 0 0110 10h-2a8 8 0 00-8-8V2z\" opacity=\"0.75\" />\n          </svg>\n          <span>Waiting for result...</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ToolUseDisplay;\n",
        "timestamp": "2026-01-02T14:22:14.293924"
      },
      "worktree_state": {
        "content": "/**\n * ToolUseDisplay Component\n *\n * Displays tool execution details with expandable input/output sections, including\n * tool name, input parameters, output results, and loading states. Provides a visual\n * representation of tool invocations during agent/assistant conversations with copy-to-clipboard\n * functionality and auto-expand behavior for short results.\n *\n * ## Features\n * - Tool name display with emoji icon mapping\n * - Expandable input parameters section with JSON formatting\n * - Expandable output results section with auto-expand for short results\n * - Loading state indicators (spinner and \"Running...\" text)\n * - Copy-to-clipboard functionality for both input and output\n * - Dark theme styling with Tailwind CSS\n * - Collapsible sections using HTML `<details>` elements\n * - Responsive max-height with scroll for long outputs\n *\n * ## Tool Use Visualization\n * Tool executions are displayed in a bordered card with three main sections:\n *\n * **Header:**\n * - Tool name with emoji icon (e.g., \ud83d\udcd6 Read, \u270d\ufe0f Write, \ud83d\udcbb Bash)\n * - Purple-colored tool name text (text-purple-400)\n * - Loading spinner and \"Running...\" text when isLoading is true\n * - Horizontal layout with space-between alignment\n *\n * **Input Parameters Section (\ud83d\udce5):**\n * - Collapsible `<details>` element (collapsed by default)\n * - Arrow indicator (\u25b6) rotates 90\u00b0 when expanded\n * - JSON-formatted input display with 2-space indentation\n * - Copy button positioned absolutely in top-right\n * - Black background (bg-black/40) with gray border\n * - Horizontal scroll for wide content\n *\n * **Output Result Section (\ud83d\udce4):**\n * - Collapsible `<details>` element (auto-expands for results < 200 chars)\n * - Arrow indicator (\u25b6) rotates 90\u00b0 when expanded\n * - Green checkmark (\u2713) when result is available and not loading\n * - Smart rendering: plain text for strings, JSON for objects\n * - Copy button for result content\n * - Max height 96 (max-h-96 = 384px) with vertical scroll\n * - Black background (bg-black/40) with gray border\n *\n * ## Input/Output Display\n * Input and output are rendered with smart formatting:\n *\n * **Input Parameters:**\n * - Always JSON stringified with 2-space indentation\n * - Displayed in `<pre>` element with monospace font\n * - Horizontal scroll (overflow-x-auto) for wide content\n * - Right padding (pr-16) to prevent overlap with copy button\n * - Border and background for visual separation\n *\n * **Output Results:**\n * - String results: Displayed as-is with whitespace preserved (pre-wrap) and word breaking\n * - Object results: JSON stringified with 2-space indentation\n * - Max height constraint (max-h-96) with vertical scroll for long outputs\n * - White-space handling: pre-wrap for strings, pre for JSON\n * - Break words for long strings to prevent horizontal overflow\n *\n * ## Collapsible Sections\n * Both input and output use HTML `<details>` elements for collapsibility:\n *\n * **Collapse Behavior:**\n * - Input section: Collapsed by default (open={false})\n * - Output section: Auto-expands for results shorter than 200 characters\n * - Arrow indicator (\u25b6) in summary element\n * - Arrow rotates 90\u00b0 when expanded via group-open:rotate-90\n * - Smooth transition animation on rotation\n *\n * **Interaction:**\n * - Click summary to toggle collapse/expand\n * - Cursor changes to pointer on hover\n * - Summary text color changes on hover (text-gray-400 \u2192 text-gray-200)\n * - User cannot select summary text (select-none)\n * - Group modifier for coordinating arrow rotation with open state\n *\n * ## Auto-Expand Behavior\n * The output section automatically expands for short results:\n *\n * - Threshold: 200 characters\n * - Logic: `typeof toolResult === 'string' && toolResult.length < 200`\n * - Applied via `open={shouldAutoExpand}` prop on details element\n * - Prevents unnecessary clicks for short, easily readable results\n * - Long results (\u2265 200 chars) remain collapsed by default\n * - User can still collapse auto-expanded sections manually\n *\n * ## Icon Mapping\n * Each tool has a distinctive emoji icon for quick visual identification:\n *\n * - **Read** (\ud83d\udcd6): File reading operations\n * - **Write** (\u270d\ufe0f): File writing operations\n * - **Edit** (\u270f\ufe0f): File editing operations\n * - **Bash** (\ud83d\udcbb): Shell command execution\n * - **Glob** (\ud83d\udd0d): File pattern matching\n * - **Grep** (\ud83d\udd0e): Content search operations\n * - **Skill** (\ud83c\udfaf): Skill execution\n * - **WebFetch** (\ud83c\udf10): Web content fetching\n * - **WebSearch** (\ud83d\udd0d): Web search operations\n * - **Task** (\ud83d\udccb): Task execution\n * - **Default** (\ud83d\udd27): Unknown or unrecognized tools\n *\n * ## Loading States\n * The component displays loading feedback in two scenarios:\n *\n * **Running State (isLoading=true, no result):**\n * - Animated spinner in header (rotating circle SVG)\n * - \"Running...\" text next to spinner\n * - Small text size (text-xs) in gray (text-gray-400)\n * - Pulsing placeholder below output section\n * - \"Waiting for result...\" message with pulsing icon\n *\n * **Completed with Result (isLoading=false, has result):**\n * - Green checkmark (\u2713) in output section summary\n * - No spinner or \"Running...\" text\n * - Output section available for expansion\n *\n * ## Copy Functionality\n * Both input and output sections have copy-to-clipboard buttons:\n *\n * **Button Features:**\n * - Positioned absolutely in top-right corner of content area\n * - Icon: \ud83d\udccb Copy\n * - Background: bg-gray-700 with hover effect (hover:bg-gray-600)\n * - Small text size (text-xs) with gray text (text-gray-300)\n * - Rounded corners with padding (px-2 py-1)\n * - Tooltip on hover: \"Copy to clipboard\"\n * - Smooth transition on hover\n *\n * **Copy Behavior:**\n * - Input: Copies JSON.stringify(toolInput, null, 2)\n * - Output (string): Copies raw string content\n * - Output (object): Copies JSON.stringify(toolResult, null, 2)\n * - Uses Clipboard API (navigator.clipboard.writeText)\n * - Requires HTTPS or localhost for security\n * - Silent operation (no toast notification currently)\n *\n * ## Styling Behavior\n * The component uses Tailwind CSS for dark theme styling:\n *\n * **Container:**\n * - Background: bg-gray-800/50 (semi-transparent dark gray)\n * - Border: border-gray-700 (medium gray)\n * - Border radius: rounded-lg\n * - Padding: p-3 (12px)\n * - Spacing: space-y-2 (vertical gap between sections)\n * - Text size: text-sm (14px base)\n *\n * **Tool Header:**\n * - Flex layout with space-between\n * - Tool name: font-medium, text-purple-400\n * - Icon and name in flex row with gap-2\n * - Loading indicator: text-xs, text-gray-400\n *\n * **Collapsible Sections:**\n * - Summary text: text-xs, text-gray-400, hover:text-gray-200\n * - Arrow: inline-block with rotation transition\n * - Content background: bg-black/40 with border-gray-700\n * - Padding: p-3 for content, pr-16 for input (copy button space)\n * - Overflow: overflow-x-auto (horizontal), overflow-y-auto (vertical for output)\n * - Max height: max-h-96 for output section only\n *\n * **Copy Buttons:**\n * - Position: absolute, top-2, right-2\n * - Background: bg-gray-700, hover:bg-gray-600\n * - Text: text-xs, text-gray-300\n * - Transitions: transition-colors\n *\n * @example\n * // Basic usage with file read tool\n * <ToolUseDisplay\n *   toolName=\"Read\"\n *   toolInput={{ file_path: \"/home/user/document.txt\", offset: 0, limit: 100 }}\n *   toolResult=\"File contents here...\"\n * />\n *\n * @example\n * // Tool execution in progress (loading state)\n * <ToolUseDisplay\n *   toolName=\"Bash\"\n *   toolInput={{ command: \"npm install\", timeout: 30000 }}\n *   isLoading={true}\n * />\n *\n * @example\n * // Completed tool with object result\n * <ToolUseDisplay\n *   toolName=\"WebFetch\"\n *   toolInput={{ url: \"https://api.example.com/data\", prompt: \"Get the data\" }}\n *   toolResult={{\n *     status: 200,\n *     data: { message: \"Success\", count: 42 }\n *   }}\n * />\n *\n * @example\n * // Tool with error result (shows in output section)\n * <ToolUseDisplay\n *   toolName=\"Write\"\n *   toolInput={{ file_path: \"/etc/config.txt\", content: \"test\" }}\n *   toolResult={{\n *     error: \"Permission denied\",\n *     code: \"EACCES\"\n *   }}\n * />\n *\n * @example\n * // Long result that won't auto-expand (>= 200 chars)\n * <ToolUseDisplay\n *   toolName=\"Grep\"\n *   toolInput={{ pattern: \"import\", path: \"./src\", output_mode: \"content\" }}\n *   toolResult={`\n *     src/app.ts:1: import express from 'express';\n *     src/app.ts:2: import { Router } from 'express';\n *     src/config.ts:1: import dotenv from 'dotenv';\n *     ... (many more lines)\n *   `}\n * />\n *\n * @example\n * // Short result that auto-expands (< 200 chars)\n * <ToolUseDisplay\n *   toolName=\"Bash\"\n *   toolInput={{ command: \"pwd\" }}\n *   toolResult=\"/home/user/projects/my-app\"\n * />\n */\n\nimport React, { useState } from 'react';\n\n/**\n * Props for the ToolUseDisplay component.\n *\n * @property {string} toolName - Name of the tool that was executed (e.g., \"Read\", \"Write\", \"Bash\"). Determines the icon displayed.\n * @property {any} toolInput - Input parameters passed to the tool. Can be any object or primitive. Displayed as JSON in the Input Parameters section.\n * @property {any} [toolResult] - Output result from the tool execution. Can be string or object. If string < 200 chars, auto-expands. Optional.\n * @property {boolean} [isLoading=false] - Whether the tool is currently executing. Shows spinner and \"Running...\" text when true.\n * @property {string} [className] - Optional CSS classes to apply to the root container element for custom styling.\n */\nexport interface ToolUseDisplayProps {\n  toolName: string;\n  toolInput: any;\n  toolResult?: any;\n  isLoading?: boolean;\n  className?: string;\n}\n\nconst ToolUseDisplay: React.FC<ToolUseDisplayProps> = ({\n  toolName,\n  toolInput,\n  toolResult,\n  isLoading = false,\n  className = '',\n}) => {\n  // Auto-expand short results (< 200 chars)\n  const shouldAutoExpand = typeof toolResult === 'string' && toolResult.length < 200;\n\n  /**\n   * Maps tool names to emoji icons for visual identification.\n   *\n   * Returns a distinctive emoji for each recognized tool type. Falls back to\n   * a generic wrench icon (\ud83d\udd27) for unknown or unrecognized tools.\n   *\n   * Supported tools: Read, Write, Edit, Bash, Glob, Grep, Skill, WebFetch, WebSearch, Task\n   *\n   * @internal\n   * @param {string} name - The tool name to get an icon for\n   * @returns {string} Emoji icon representing the tool (e.g., \"\ud83d\udcd6\" for Read, \"\ud83d\udcbb\" for Bash)\n   */\n  const getToolIcon = (name: string): string => {\n    const iconMap: Record<string, string> = {\n      Read: '\ud83d\udcd6',\n      Write: '\u270d\ufe0f',\n      Edit: '\u270f\ufe0f',\n      Bash: '\ud83d\udcbb',\n      Glob: '\ud83d\udd0d',\n      Grep: '\ud83d\udd0e',\n      Skill: '\ud83c\udfaf',\n      WebFetch: '\ud83c\udf10',\n      WebSearch: '\ud83d\udd0d',\n      Task: '\ud83d\udccb',\n    };\n    return iconMap[name] || '\ud83d\udd27';\n  };\n\n  /**\n   * Copies text to the system clipboard using the Clipboard API.\n   *\n   * Uses the modern Clipboard API (navigator.clipboard.writeText) for copying\n   * content. Requires HTTPS or localhost for security. Currently operates silently\n   * without user feedback (toast notification could be added).\n   *\n   * @internal\n   * @param {string} text - The text to copy to clipboard (input JSON or output result)\n   */\n  const copyToClipboard = (text: string) => {\n    navigator.clipboard.writeText(text).then(() => {\n      // Could add a toast notification here\n    });\n  };\n\n  return (\n    <div className={`text-sm space-y-2 p-3 bg-gray-800/50 rounded-lg border border-gray-700 ${className}`}>\n      {/* Tool Name Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"font-medium text-purple-400 flex items-center gap-2\">\n          <span>{getToolIcon(toolName)}</span>\n          <span>{toolName}</span>\n        </div>\n        {isLoading && (\n          <div className=\"flex items-center gap-2 text-xs text-gray-400\">\n            <svg className=\"animate-spin h-3 w-3\" viewBox=\"0 0 24 24\">\n              <circle\n                className=\"opacity-25\"\n                cx=\"12\"\n                cy=\"12\"\n                r=\"10\"\n                stroke=\"currentColor\"\n                strokeWidth=\"4\"\n                fill=\"none\"\n              />\n              <path\n                className=\"opacity-75\"\n                fill=\"currentColor\"\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n              />\n            </svg>\n            <span>Running...</span>\n          </div>\n        )}\n      </div>\n\n      {/* Input Parameters */}\n      {toolInput && (\n        <details className=\"cursor-pointer group\">\n          <summary className=\"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-2 select-none\">\n            <span className=\"group-open:rotate-90 transition-transform inline-block\">\u25b6</span>\n            <span>\ud83d\udce5 Input Parameters</span>\n          </summary>\n          <div className=\"mt-2 relative\">\n            <button\n              onClick={() => copyToClipboard(JSON.stringify(toolInput, null, 2))}\n              className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\n              title=\"Copy to clipboard\"\n            >\n              \ud83d\udccb Copy\n            </button>\n            <pre className=\"text-xs bg-black/40 p-3 pr-16 rounded overflow-x-auto border border-gray-700\">\n              {JSON.stringify(toolInput, null, 2)}\n            </pre>\n          </div>\n        </details>\n      )}\n\n      {/* Output Result */}\n      {toolResult !== undefined && toolResult !== null && (\n        <details className=\"cursor-pointer group\" open={shouldAutoExpand}>\n          <summary className=\"text-xs text-gray-400 hover:text-gray-200 flex items-center gap-2 select-none\">\n            <span className=\"group-open:rotate-90 transition-transform inline-block\">\u25b6</span>\n            <span>\ud83d\udce4 Output Result</span>\n            {!isLoading && (\n              <span className=\"text-green-400 text-xs ml-2\">\u2713</span>\n            )}\n          </summary>\n          <div className=\"mt-2 relative\">\n            <button\n              onClick={() =>\n                copyToClipboard(\n                  typeof toolResult === 'string'\n                    ? toolResult\n                    : JSON.stringify(toolResult, null, 2)\n                )\n              }\n              className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors\"\n              title=\"Copy to clipboard\"\n            >\n              \ud83d\udccb Copy\n            </button>\n            <div className=\"text-xs bg-black/40 p-3 pr-16 rounded overflow-x-auto border border-gray-700 max-h-96 overflow-y-auto\">\n              {typeof toolResult === 'string' ? (\n                <pre className=\"whitespace-pre-wrap break-words\">{toolResult}</pre>\n              ) : (\n                <pre>{JSON.stringify(toolResult, null, 2)}</pre>\n              )}\n            </div>\n          </div>\n        </details>\n      )}\n\n      {/* Loading State */}\n      {isLoading && !toolResult && (\n        <div className=\"text-xs text-gray-400 italic flex items-center gap-2 py-2\">\n          <svg className=\"animate-pulse h-3 w-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" opacity=\"0.25\" />\n            <path d=\"M12 2a10 10 0 0110 10h-2a8 8 0 00-8-8V2z\" opacity=\"0.75\" />\n          </svg>\n          <span>Waiting for result...</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nToolUseDisplay.displayName = 'ToolUseDisplay';\n\nexport default ToolUseDisplay;\n",
        "last_modified": "2026-01-02T14:22:15.566714"
      },
      "task_intent": {
        "title": "Document Frontend React Components and Hooks",
        "description": "Add comprehensive JSDoc documentation to all React components and custom hooks in the frontend, including prop types, usage examples, component purposes, state management, and side effects.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:01:11.641712",
  "last_updated": "2026-01-02T14:22:15.154330"
}
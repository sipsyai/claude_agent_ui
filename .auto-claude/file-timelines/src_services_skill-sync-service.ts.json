{
  "file_path": "src/services/skill-sync-service.ts",
  "main_branch_history": [],
  "task_views": {
    "002-add-jsdoc-documentation-for-backend-services": {
      "task_id": "002-add-jsdoc-documentation-for-backend-services",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "/**\n * Skill Sync Service\n *\n * Syncs Strapi skills to filesystem in .claude/skills/{skill-name}/SKILL.md format\n * Required for Claude Agent SDK to discover and use skills via settingSources: ['project']\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\nimport matter from 'gray-matter';\nimport type { Skill } from '../types/agent.types.js';\n\nclass SkillSyncService {\n  private skillsDir = path.join(process.cwd(), '.claude', 'skills');\n\n  /**\n   * Sync a single skill to filesystem\n   * @param skill - Skill object from Strapi\n   * @param parameters - Parameter values for {{param}} template replacement\n   * @returns Path to the written SKILL.md file\n   */\n  async syncSkillToFilesystem(\n    skill: Skill,\n    parameters?: Record<string, any>\n  ): Promise<string> {\n    try {\n      // 1. Validate skill data\n      this.validateSkill(skill);\n\n      // 2. Sanitize skill name (prevent path traversal)\n      const sanitizedName = this.sanitizeSkillName(skill.name);\n\n      // 3. Create skill directory\n      const skillDir = path.join(this.skillsDir, sanitizedName);\n      await fs.mkdir(skillDir, { recursive: true });\n\n      // 4. Parameter injection\n      let content = skill.skillmd;\n      if (parameters && Object.keys(parameters).length > 0) {\n        this.validateParameters(parameters);\n        content = this.injectParameters(content, parameters);\n      }\n\n      // 5. Build YAML frontmatter\n      const frontmatter = {\n        name: skill.name,\n        description: skill.description,\n        version: skill.version || '1.0.0',\n        category: skill.category || 'custom',\n      };\n\n      // 6. Create markdown with frontmatter\n      const skillMd = matter.stringify(content, frontmatter);\n      const skillPath = path.join(skillDir, 'SKILL.md');\n\n      // 7. Write to filesystem\n      await fs.writeFile(skillPath, skillMd, 'utf-8');\n\n      console.log(`[SkillSync] \u2705 Synced skill: ${skill.name} \u2192 ${skillPath}`);\n      return skillPath;\n    } catch (error) {\n      console.error(`[SkillSync] \u274c Failed to sync skill ${skill.name}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Sync multiple skills to filesystem\n   * @param skills - Array of skill objects\n   * @param parameters - Parameter values for template replacement (same for all skills)\n   */\n  async syncAllSkills(\n    skills: Skill[],\n    parameters?: Record<string, any>\n  ): Promise<void> {\n    console.log(`[SkillSync] Syncing ${skills.length} skills to filesystem...`);\n\n    await Promise.all(\n      skills.map(skill => this.syncSkillToFilesystem(skill, parameters))\n    );\n\n    console.log(`[SkillSync] \u2705 Synced ${skills.length} skills successfully`);\n  }\n\n  /**\n   * Remove a skill from filesystem\n   * @param skillName - Name of the skill to remove\n   */\n  async removeSkillFromFilesystem(skillName: string): Promise<void> {\n    try {\n      const sanitizedName = this.sanitizeSkillName(skillName);\n      const skillDir = path.join(this.skillsDir, sanitizedName);\n      await fs.rm(skillDir, { recursive: true, force: true });\n      console.log(`[SkillSync] \u2705 Removed skill: ${skillName}`);\n    } catch (error) {\n      // Ignore if directory doesn't exist\n      if ((error as any).code !== 'ENOENT') {\n        console.error(`[SkillSync] \u274c Failed to remove skill ${skillName}:`, error);\n      }\n    }\n  }\n\n  /**\n   * Clear all skills from filesystem\n   */\n  async clearAllSkills(): Promise<void> {\n    try {\n      await fs.rm(this.skillsDir, { recursive: true, force: true });\n      await fs.mkdir(this.skillsDir, { recursive: true });\n      console.log('[SkillSync] \u2705 Cleared all skills');\n    } catch (error) {\n      console.error('[SkillSync] \u274c Failed to clear skills:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Replace {{param}} templates with actual values\n   * @param content - Skill markdown content with {{param}} placeholders\n   * @param parameters - Key-value pairs for replacement\n   * @returns Processed content with parameters injected\n   */\n  private injectParameters(\n    content: string,\n    parameters: Record<string, any>\n  ): string {\n    let processed = content;\n\n    for (const [key, value] of Object.entries(parameters)) {\n      // Support both {{key}} and {{ key }} formats\n      const regex = new RegExp(`\\\\{\\\\{\\\\s*${key}\\\\s*\\\\}\\\\}`, 'g');\n      processed = processed.replace(regex, String(value));\n    }\n\n    return processed;\n  }\n\n  /**\n   * Validate skill data\n   * @param skill - Skill object to validate\n   * @throws Error if skill data is invalid\n   */\n  private validateSkill(skill: Skill): void {\n    if (!skill.name || typeof skill.name !== 'string') {\n      throw new Error('Invalid skill: name is required and must be a string');\n    }\n\n    if (!skill.skillmd || typeof skill.skillmd !== 'string') {\n      throw new Error('Invalid skill: skillmd is required and must be a string');\n    }\n\n    // Check content size limit (1MB)\n    const MAX_SKILL_SIZE = 1024 * 1024; // 1MB\n    if (skill.skillmd.length > MAX_SKILL_SIZE) {\n      throw new Error(`Skill content too large: ${skill.name} (max 1MB)`);\n    }\n  }\n\n  /**\n   * Sanitize skill name to prevent path traversal attacks\n   * @param name - Raw skill name\n   * @returns Sanitized skill name (alphanumeric, hyphens, underscores only)\n   */\n  private sanitizeSkillName(name: string): string {\n    // Remove any path separators and special characters\n    // Only allow: alphanumeric, hyphens, underscores\n    const sanitized = name.replace(/[^a-z0-9-_]/gi, '-').toLowerCase();\n\n    // Use path.basename as additional safety layer\n    return path.basename(sanitized);\n  }\n\n  /**\n   * Validate parameter values\n   * @param parameters - Parameters to validate\n   * @throws Error if parameters are invalid\n   */\n  private validateParameters(parameters: Record<string, any>): void {\n    for (const [key, value] of Object.entries(parameters)) {\n      // Key validation: only alphanumeric and underscore\n      if (!/^[a-zA-Z0-9_]+$/.test(key)) {\n        throw new Error(`Invalid parameter key: ${key}`);\n      }\n\n      // Value validation: max length 10KB\n      const MAX_PARAM_LENGTH = 10 * 1024; // 10KB\n      if (String(value).length > MAX_PARAM_LENGTH) {\n        throw new Error(`Parameter value too long: ${key} (max 10KB)`);\n      }\n    }\n  }\n}\n\n// Export singleton instance\nexport const skillSyncService = new SkillSyncService();\n",
        "timestamp": "2026-01-02T14:06:14.995695"
      },
      "worktree_state": {
        "content": "/**\n * Skill Sync Service\n *\n * Syncs Strapi skills to filesystem in .claude/skills/{skill-name}/SKILL.md format\n * Required for Claude Agent SDK to discover and use skills via settingSources: ['project']\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\nimport matter from 'gray-matter';\nimport type { Skill } from '../types/agent.types.js';\n\n/**\n * SkillSyncService - Bidirectional synchronization between Strapi database and filesystem\n *\n * @description\n * Manages synchronization of skills from Strapi database to the filesystem in the `.claude/skills/`\n * directory structure required by Claude Agent SDK. The SDK discovers skills via `settingSources: ['project']`\n * which reads from `.claude/skills/{skill-name}/SKILL.md` files.\n *\n * **Architecture:**\n * - **Strapi as Source of Truth**: Skills are created and edited in Strapi UI/API\n * - **Filesystem as SDK Interface**: Skills synced to `.claude/skills/` for SDK discovery\n * - **One-Way Sync**: Strapi \u2192 Filesystem (filesystem is not synced back to Strapi)\n * - **Template Parameters**: Supports `{{param}}` template injection for dynamic skill content\n *\n * **File Structure:**\n * ```\n * .claude/skills/{skill-name}/\n *   \u2514\u2500\u2500 SKILL.md           # YAML frontmatter + markdown content\n * ```\n *\n * **SKILL.md Format:**\n * ```markdown\n * ---\n * name: skill-name\n * description: Use when you need to...\n * version: 1.0.0\n * category: custom\n * ---\n *\n * # Skill instructions (markdown content from skill.skillmd field)\n * ```\n *\n * **Strapi-to-Filesystem Sync Workflow:**\n * 1. **Fetch Skills**: Retrieve skills from Strapi database (usually filtered by agent/enabled status)\n * 2. **Validate**: Check skill data structure (name, skillmd required, size limits)\n * 3. **Sanitize**: Clean skill name to prevent path traversal (alphanumeric, hyphens, underscores only)\n * 4. **Create Directory**: Create `.claude/skills/{sanitized-name}/` if not exists\n * 5. **Parameter Injection**: Replace `{{param}}` placeholders with actual values (if parameters provided)\n * 6. **Build Frontmatter**: Create YAML frontmatter with name, description, version, category\n * 7. **Write File**: Write SKILL.md with frontmatter + content using gray-matter\n * 8. **SDK Discovery**: Claude SDK automatically discovers skills in `.claude/skills/` on next conversation start\n *\n * **Security Features:**\n * - Path traversal prevention via name sanitization\n * - File size limits (1MB max per skill)\n * - Parameter validation (alphanumeric keys, 10KB max per value)\n * - Recursive directory creation with safe defaults\n *\n * **Use Cases:**\n * - Sync all skills before starting a conversation with agent\n * - Sync individual skill when updated in Strapi\n * - Remove skill from filesystem when disabled/deleted in Strapi\n * - Clear all skills when switching projects or resetting agent configuration\n *\n * @example\n * // Basic skill sync workflow\n * import { strapiClient } from './strapi-client.js';\n * import { skillSyncService } from './skill-sync-service.js';\n *\n * // 1. Fetch skills from Strapi\n * const skills = await strapiClient.getAllSkills();\n *\n * // 2. Sync all skills to filesystem\n * await skillSyncService.syncAllSkills(skills);\n *\n * // 3. Start conversation (SDK discovers skills automatically)\n * const sdk = new ClaudeSdkService();\n * await sdk.startConversation({\n *   agentId: 'my-agent',\n *   settingSources: ['project']  // SDK reads from .claude/skills/\n * });\n *\n * @example\n * // Sync skills with template parameters\n * const skills = await strapiClient.getAllSkills({\n *   filters: { enabled: { $eq: true } }\n * });\n *\n * const parameters = {\n *   project_name: 'MyProject',\n *   api_key: process.env.API_KEY,\n *   environment: 'production'\n * };\n *\n * // Parameters replace {{project_name}}, {{api_key}}, {{environment}} in skill content\n * await skillSyncService.syncAllSkills(skills, parameters);\n *\n * @example\n * // Incremental sync - sync single updated skill\n * const skill = await strapiClient.getSkill(123, { populate: '*' });\n * const skillPath = await skillSyncService.syncSkillToFilesystem(skill);\n * console.log(`Synced to: ${skillPath}`);\n * // Output: Synced to: /project/.claude/skills/pdf-analyzer/SKILL.md\n *\n * @example\n * // Remove skill when disabled in Strapi\n * await skillSyncService.removeSkillFromFilesystem('pdf-analyzer');\n * // .claude/skills/pdf-analyzer/ directory deleted\n *\n * @example\n * // Clear all skills when switching projects\n * await skillSyncService.clearAllSkills();\n * // All skill directories removed, .claude/skills/ empty\n *\n * @example\n * // Agent-specific skill sync workflow\n * const agent = await strapiClient.getAgent(456, {\n *   populate: ['skills']\n * });\n *\n * // Sync only skills assigned to this agent\n * await skillSyncService.syncAllSkills(agent.skills || []);\n *\n * @see {@link https://docs.anthropic.com/en/api/agent-sdk/settings Anthropic Agent SDK Settings}\n */\nclass SkillSyncService {\n  /** Absolute path to `.claude/skills/` directory where skills are synced */\n  private skillsDir = path.join(process.cwd(), '.claude', 'skills');\n\n  /**\n   * Sync a single skill from Strapi to filesystem in `.claude/skills/{name}/SKILL.md` format\n   *\n   * @description\n   * Writes a single skill to the filesystem with YAML frontmatter and markdown content.\n   * This is the core sync operation used by `syncAllSkills` for batch operations and\n   * for incremental updates when individual skills change in Strapi.\n   *\n   * **Workflow:**\n   * 1. **Validate**: Check skill.name and skill.skillmd are non-empty strings, check size limits (max 1MB)\n   * 2. **Sanitize Name**: Clean skill name to prevent path traversal (only alphanumeric, hyphens, underscores)\n   * 3. **Create Directory**: Ensure `.claude/skills/{sanitized-name}/` exists (recursive creation)\n   * 4. **Parameter Injection**: Replace `{{param}}` placeholders with values from parameters object (optional)\n   * 5. **Build Frontmatter**: Create YAML object with name, description, version, category\n   * 6. **Generate SKILL.md**: Use gray-matter to create frontmatter + content markdown file\n   * 7. **Write to Disk**: Write SKILL.md file to `.claude/skills/{sanitized-name}/SKILL.md`\n   * 8. **Return Path**: Return absolute path to created SKILL.md file\n   *\n   * **Template Parameters:**\n   * - Supports `{{param}}` and `{{ param }}` syntax (spaces optional)\n   * - Parameters replaced before writing to filesystem\n   * - Use for dynamic content like API keys, project names, environment-specific values\n   * - Parameter values validated (max 10KB per value, alphanumeric keys only)\n   *\n   * **Security:**\n   * - Name sanitization prevents path traversal attacks (e.g., \"../../../etc/passwd\")\n   * - File size limit prevents disk exhaustion (max 1MB per skill)\n   * - Parameter validation prevents injection attacks\n   *\n   * @param skill - Skill object from Strapi with at minimum `name` and `skillmd` fields\n   * @param parameters - Optional key-value pairs for `{{param}}` template replacement in skill content\n   * @returns Promise resolving to absolute path of written SKILL.md file\n   * @throws Error if skill.name or skill.skillmd is missing/invalid\n   * @throws Error if skill content exceeds 1MB size limit\n   * @throws Error if parameter keys are invalid (non-alphanumeric) or values exceed 10KB\n   * @throws Error if filesystem operations fail (permissions, disk space, etc.)\n   *\n   * @example\n   * // Basic skill sync\n   * import { strapiClient } from './strapi-client.js';\n   * import { skillSyncService } from './skill-sync-service.js';\n   *\n   * const skill = await strapiClient.getSkill(123, { populate: '*' });\n   * const path = await skillSyncService.syncSkillToFilesystem(skill);\n   *\n   * console.log(`Synced to: ${path}`);\n   * // Output: Synced to: /project/.claude/skills/pdf-analyzer/SKILL.md\n   *\n   * // File structure created:\n   * // .claude/skills/pdf-analyzer/\n   * //   \u2514\u2500\u2500 SKILL.md\n   *\n   * @example\n   * // Skill sync with template parameters\n   * const skill = {\n   *   name: 'api-client',\n   *   description: 'Use when you need to call the external API',\n   *   skillmd: `Call the API at {{api_url}} using key {{api_key}}`,\n   *   version: '1.0.0',\n   *   category: 'integration'\n   * };\n   *\n   * const path = await skillSyncService.syncSkillToFilesystem(skill, {\n   *   api_url: 'https://api.example.com',\n   *   api_key: process.env.API_KEY\n   * });\n   *\n   * // SKILL.md content:\n   * // ---\n   * // name: api-client\n   * // description: Use when you need to call the external API\n   * // version: 1.0.0\n   * // category: integration\n   * // ---\n   * //\n   * // Call the API at https://api.example.com using key sk-abc123\n   *\n   * @example\n   * // Incremental sync when skill updated in Strapi\n   * // WebSocket event handler or webhook endpoint\n   * app.post('/webhooks/skill-updated', async (req, res) => {\n   *   const { skillId } = req.body;\n   *\n   *   // Fetch latest version from Strapi\n   *   const skill = await strapiClient.getSkill(skillId);\n   *\n   *   // Sync to filesystem immediately\n   *   await skillSyncService.syncSkillToFilesystem(skill);\n   *\n   *   res.json({ success: true });\n   * });\n   *\n   * @example\n   * // Handling validation errors\n   * try {\n   *   await skillSyncService.syncSkillToFilesystem({\n   *     name: '',  // Invalid: empty name\n   *     skillmd: 'Content',\n   *     description: 'Test'\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Invalid skill: name is required and must be a string\n   * }\n   *\n   * @example\n   * // Name sanitization behavior\n   * const skill = {\n   *   name: 'My Skill!@#$%',  // Invalid characters\n   *   description: 'Test skill',\n   *   skillmd: 'Instructions...'\n   * };\n   *\n   * const path = await skillSyncService.syncSkillToFilesystem(skill);\n   * console.log(path);\n   * // Output: /project/.claude/skills/my-skill-----/SKILL.md\n   * // Special characters replaced with hyphens, converted to lowercase\n   *\n   * @example\n   * // Sync skill with version and category\n   * const skill = {\n   *   name: 'data-processor',\n   *   description: 'Use when processing CSV data files',\n   *   skillmd: '1. Load CSV\\n2. Process rows\\n3. Generate report',\n   *   version: '2.1.0',\n   *   category: 'data-analysis'\n   * };\n   *\n   * await skillSyncService.syncSkillToFilesystem(skill);\n   *\n   * // SKILL.md frontmatter includes version and category:\n   * // ---\n   * // name: data-processor\n   * // description: Use when processing CSV data files\n   * // version: 2.1.0\n   * // category: data-analysis\n   * // ---\n   *\n   * @example\n   * // Error handling for large skill content\n   * try {\n   *   const largeContent = 'x'.repeat(2 * 1024 * 1024); // 2MB\n   *   await skillSyncService.syncSkillToFilesystem({\n   *     name: 'large-skill',\n   *     description: 'Test',\n   *     skillmd: largeContent\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Skill content too large: large-skill (max 1MB)\n   * }\n   *\n   * @see {@link syncAllSkills} for batch sync operations\n   * @see {@link removeSkillFromFilesystem} for removing synced skills\n   */\n  async syncSkillToFilesystem(\n    skill: Skill,\n    parameters?: Record<string, any>\n  ): Promise<string> {\n    try {\n      // 1. Validate skill data\n      this.validateSkill(skill);\n\n      // 2. Sanitize skill name (prevent path traversal)\n      const sanitizedName = this.sanitizeSkillName(skill.name);\n\n      // 3. Create skill directory\n      const skillDir = path.join(this.skillsDir, sanitizedName);\n      await fs.mkdir(skillDir, { recursive: true });\n\n      // 4. Parameter injection\n      let content = skill.skillmd;\n      if (parameters && Object.keys(parameters).length > 0) {\n        this.validateParameters(parameters);\n        content = this.injectParameters(content, parameters);\n      }\n\n      // 5. Build YAML frontmatter\n      const frontmatter = {\n        name: skill.name,\n        description: skill.description,\n        version: skill.version || '1.0.0',\n        category: skill.category || 'custom',\n      };\n\n      // 6. Create markdown with frontmatter\n      const skillMd = matter.stringify(content, frontmatter);\n      const skillPath = path.join(skillDir, 'SKILL.md');\n\n      // 7. Write to filesystem\n      await fs.writeFile(skillPath, skillMd, 'utf-8');\n\n      console.log(`[SkillSync] \u2705 Synced skill: ${skill.name} \u2192 ${skillPath}`);\n      return skillPath;\n    } catch (error) {\n      console.error(`[SkillSync] \u274c Failed to sync skill ${skill.name}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * Sync multiple skills from Strapi to filesystem in parallel\n   *\n   * @description\n   * Batch operation to sync an array of skills to the filesystem. This is the primary method\n   * called before starting a conversation with an agent to ensure all skills are available\n   * for SDK discovery via `settingSources: ['project']`.\n   *\n   * **Workflow:**\n   * 1. **Validate Input**: Accept array of skills and optional parameters object\n   * 2. **Parallel Sync**: Call `syncSkillToFilesystem()` for each skill in parallel using `Promise.all()`\n   * 3. **Wait for Completion**: Wait for all skills to finish syncing (or any to fail)\n   * 4. **Error Handling**: If any skill fails, entire operation fails (partial sync possible before failure)\n   *\n   * **Performance:**\n   * - Skills synced in parallel (not sequential) for better performance\n   * - 100 skills typically sync in 200-500ms depending on content size and disk I/O\n   * - Network latency not a factor (filesystem operations only)\n   *\n   * **Use Cases:**\n   * - Sync all skills before starting agent conversation\n   * - Sync agent-specific skills filtered by agent.skills relation\n   * - Refresh all skills after bulk updates in Strapi\n   * - Initial project setup or environment reset\n   *\n   * **Important Notes:**\n   * - Same parameters applied to ALL skills (template values shared across all)\n   * - If one skill fails, operation throws error (but some skills may already be synced)\n   * - Does NOT clear existing skills first - use `clearAllSkills()` before if needed\n   * - Empty array is valid input (no-op, useful for agents with no skills)\n   *\n   * @param skills - Array of skill objects from Strapi (e.g., from `getAllSkills()` or `agent.skills`)\n   * @param parameters - Optional key-value pairs applied to ALL skills for `{{param}}` template replacement\n   * @returns Promise resolving when all skills successfully synced (void)\n   * @throws Error if any skill fails validation or filesystem write (partial sync may occur)\n   *\n   * @example\n   * // Basic usage - sync all skills from Strapi\n   * import { strapiClient } from './strapi-client.js';\n   * import { skillSyncService } from './skill-sync-service.js';\n   *\n   * const skills = await strapiClient.getAllSkills();\n   * await skillSyncService.syncAllSkills(skills);\n   *\n   * console.log(`Synced ${skills.length} skills to .claude/skills/`);\n   * // Output: Synced 15 skills to .claude/skills/\n   *\n   * @example\n   * // Agent-specific skill sync workflow\n   * const agent = await strapiClient.getAgent(123, {\n   *   populate: ['skills']\n   * });\n   *\n   * // Sync only skills assigned to this agent\n   * await skillSyncService.syncAllSkills(agent.skills || []);\n   *\n   * // Start conversation with agent (SDK discovers synced skills)\n   * const sdk = new ClaudeSdkService();\n   * await sdk.startConversation({\n   *   agentId: agent.id,\n   *   settingSources: ['project']\n   * });\n   *\n   * @example\n   * // Sync skills with shared template parameters\n   * const skills = await strapiClient.getAllSkills({\n   *   filters: { enabled: { $eq: true } }\n   * });\n   *\n   * const parameters = {\n   *   project_name: 'MyProject',\n   *   api_url: process.env.API_URL,\n   *   environment: process.env.NODE_ENV\n   * };\n   *\n   * // All skills get same parameter values\n   * await skillSyncService.syncAllSkills(skills, parameters);\n   *\n   * // All skills can use {{project_name}}, {{api_url}}, {{environment}} in content\n   *\n   * @example\n   * // Full refresh workflow - clear and resync\n   * // 1. Clear all existing skills\n   * await skillSyncService.clearAllSkills();\n   *\n   * // 2. Fetch fresh skills from Strapi\n   * const skills = await strapiClient.getAllSkills();\n   *\n   * // 3. Sync all skills\n   * await skillSyncService.syncAllSkills(skills);\n   *\n   * console.log('Full skill refresh completed');\n   *\n   * @example\n   * // Handling empty skill arrays (agents with no skills)\n   * const agent = await strapiClient.getAgent(456, {\n   *   populate: ['skills']\n   * });\n   *\n   * await skillSyncService.syncAllSkills(agent.skills || []);\n   * // No error thrown, no skills synced (valid no-op)\n   *\n   * @example\n   * // Error handling - partial sync scenario\n   * try {\n   *   const skills = [\n   *     { name: 'skill-1', skillmd: 'Content 1', description: 'Test' },\n   *     { name: '', skillmd: 'Content 2', description: 'Test' },  // Invalid!\n   *     { name: 'skill-3', skillmd: 'Content 3', description: 'Test' }\n   *   ];\n   *\n   *   await skillSyncService.syncAllSkills(skills);\n   * } catch (error) {\n   *   console.error('Sync failed:', error.message);\n   *   // Output: Sync failed: Invalid skill: name is required and must be a string\n   *\n   *   // Note: skill-1 and skill-3 MAY be synced (parallel execution, non-deterministic)\n   *   // Recommend clearing and retrying on error for consistency\n   * }\n   *\n   * @example\n   * // Filtered skill sync - only enabled skills\n   * const skills = await strapiClient.getAllSkills({\n   *   filters: {\n   *     enabled: { $eq: true },\n   *     category: { $in: ['productivity', 'analysis'] }\n   *   }\n   * });\n   *\n   * await skillSyncService.syncAllSkills(skills);\n   * // Only enabled productivity/analysis skills synced\n   *\n   * @example\n   * // Performance measurement\n   * const skills = await strapiClient.getAllSkills();\n   * const startTime = Date.now();\n   *\n   * await skillSyncService.syncAllSkills(skills);\n   *\n   * const duration = Date.now() - startTime;\n   * console.log(`Synced ${skills.length} skills in ${duration}ms`);\n   * // Output: Synced 50 skills in 320ms\n   *\n   * @see {@link syncSkillToFilesystem} for single skill sync operation\n   * @see {@link clearAllSkills} for clearing all skills before resync\n   */\n  async syncAllSkills(\n    skills: Skill[],\n    parameters?: Record<string, any>\n  ): Promise<void> {\n    console.log(`[SkillSync] Syncing ${skills.length} skills to filesystem...`);\n\n    await Promise.all(\n      skills.map(skill => this.syncSkillToFilesystem(skill, parameters))\n    );\n\n    console.log(`[SkillSync] \u2705 Synced ${skills.length} skills successfully`);\n  }\n\n  /**\n   * Remove a skill directory from filesystem (inverse of syncSkillToFilesystem)\n   *\n   * @description\n   * Deletes a skill directory and all its contents from `.claude/skills/{name}/`.\n   * Used when skills are disabled, deleted, or removed from an agent's configuration in Strapi.\n   *\n   * **Workflow:**\n   * 1. **Sanitize Name**: Clean skill name (same sanitization as sync for consistency)\n   * 2. **Build Path**: Construct path to `.claude/skills/{sanitized-name}/`\n   * 3. **Recursive Delete**: Remove directory and all contents using `fs.rm()` with `recursive: true`\n   * 4. **Force Mode**: Use `force: true` to ignore ENOENT errors if directory doesn't exist\n   * 5. **Error Handling**: Silently ignore if skill doesn't exist, throw on other errors\n   *\n   * **Safety Features:**\n   * - Name sanitization prevents path traversal attacks\n   * - Force mode prevents errors if skill already deleted\n   * - Recursive deletion removes all files in skill directory (SKILL.md, skill.config.json, etc.)\n   *\n   * **Important Notes:**\n   * - Operation is IRREVERSIBLE - no trash/recycle bin\n   * - Silently succeeds if skill doesn't exist (idempotent)\n   * - Does NOT delete skill from Strapi database (filesystem-only operation)\n   * - SDK will not discover deleted skill on next conversation start\n   *\n   * @param skillName - Name of the skill to remove (will be sanitized before deletion)\n   * @returns Promise resolving when skill directory deleted (void)\n   *\n   * @example\n   * // Remove skill when disabled in Strapi\n   * import { skillSyncService } from './skill-sync-service.js';\n   *\n   * await skillSyncService.removeSkillFromFilesystem('pdf-analyzer');\n   * console.log('Skill removed from filesystem');\n   *\n   * // .claude/skills/pdf-analyzer/ directory deleted\n   *\n   * @example\n   * // Webhook handler for skill deletion in Strapi\n   * app.post('/webhooks/skill-deleted', async (req, res) => {\n   *   const { skillName } = req.body;\n   *\n   *   // Remove from filesystem immediately\n   *   await skillSyncService.removeSkillFromFilesystem(skillName);\n   *\n   *   res.json({ success: true, message: `Removed ${skillName}` });\n   * });\n   *\n   * @example\n   * // Selective sync - remove disabled skills\n   * const allSkills = await strapiClient.getAllSkills();\n   * const enabledSkills = allSkills.filter(s => s.enabled);\n   * const disabledSkills = allSkills.filter(s => !s.enabled);\n   *\n   * // Sync enabled skills\n   * await skillSyncService.syncAllSkills(enabledSkills);\n   *\n   * // Remove disabled skills\n   * for (const skill of disabledSkills) {\n   *   await skillSyncService.removeSkillFromFilesystem(skill.name);\n   * }\n   *\n   * @example\n   * // Idempotent behavior - safe to call multiple times\n   * await skillSyncService.removeSkillFromFilesystem('non-existent-skill');\n   * // No error thrown, silently succeeds\n   *\n   * await skillSyncService.removeSkillFromFilesystem('pdf-analyzer');\n   * await skillSyncService.removeSkillFromFilesystem('pdf-analyzer');\n   * // Second call silently succeeds (already deleted)\n   *\n   * @example\n   * // Agent skill update workflow\n   * const agent = await strapiClient.getAgent(123, {\n   *   populate: ['skills']\n   * });\n   *\n   * // Get list of currently synced skills\n   * const parser = new ClaudeStructureParser(process.cwd());\n   * const syncedSkills = await parser.parseSkills();\n   *\n   * // Sync new/updated skills\n   * await skillSyncService.syncAllSkills(agent.skills || []);\n   *\n   * // Remove skills no longer assigned to agent\n   * const agentSkillNames = new Set((agent.skills || []).map(s => s.name));\n   * for (const syncedSkill of syncedSkills) {\n   *   if (!agentSkillNames.has(syncedSkill.name)) {\n   *     await skillSyncService.removeSkillFromFilesystem(syncedSkill.name);\n   *   }\n   * }\n   *\n   * @example\n   * // Name sanitization consistency with sync\n   * const skill = { name: 'My Skill!@#$%', skillmd: 'Content', description: 'Test' };\n   *\n   * // Sync creates: .claude/skills/my-skill-----/\n   * await skillSyncService.syncSkillToFilesystem(skill);\n   *\n   * // Remove uses same sanitization\n   * await skillSyncService.removeSkillFromFilesystem('My Skill!@#$%');\n   * // Correctly deletes .claude/skills/my-skill-----/\n   *\n   * @example\n   * // Error handling - filesystem permission errors\n   * try {\n   *   await skillSyncService.removeSkillFromFilesystem('protected-skill');\n   * } catch (error) {\n   *   if (error.code === 'EPERM') {\n   *     console.error('Permission denied - skill directory is read-only');\n   *   } else if (error.code === 'EBUSY') {\n   *     console.error('Directory in use - close files and retry');\n   *   }\n   * }\n   *\n   * @see {@link syncSkillToFilesystem} for syncing skills to filesystem\n   * @see {@link clearAllSkills} for removing all skills at once\n   */\n  async removeSkillFromFilesystem(skillName: string): Promise<void> {\n    try {\n      const sanitizedName = this.sanitizeSkillName(skillName);\n      const skillDir = path.join(this.skillsDir, sanitizedName);\n      await fs.rm(skillDir, { recursive: true, force: true });\n      console.log(`[SkillSync] \u2705 Removed skill: ${skillName}`);\n    } catch (error) {\n      // Ignore if directory doesn't exist\n      if ((error as any).code !== 'ENOENT') {\n        console.error(`[SkillSync] \u274c Failed to remove skill ${skillName}:`, error);\n      }\n    }\n  }\n\n  /**\n   * Clear all skills from filesystem (removes entire `.claude/skills/` directory)\n   *\n   * @description\n   * Deletes the entire `.claude/skills/` directory and all its contents, then recreates\n   * an empty `.claude/skills/` directory. Used for full skill refresh, project cleanup,\n   * or environment reset workflows.\n   *\n   * **Workflow:**\n   * 1. **Delete Directory**: Remove `.claude/skills/` and all contents recursively\n   * 2. **Recreate Directory**: Create new empty `.claude/skills/` directory\n   * 3. **Error Handling**: Throw error if deletion or recreation fails\n   *\n   * **Important Notes:**\n   * - Operation is IRREVERSIBLE - all skill files permanently deleted\n   * - Use before full resync to ensure clean slate (no orphaned skills)\n   * - Does NOT affect Strapi database (filesystem-only operation)\n   * - SDK will not discover any skills until new sync performed\n   * - Force mode ensures deletion succeeds even if directory doesn't exist\n   *\n   * **Use Cases:**\n   * - Full skill refresh workflow (clear + sync all)\n   * - Switch between different agent configurations\n   * - Clean up before project reset or environment change\n   * - Testing skill sync functionality from clean state\n   *\n   * @returns Promise resolving when directory cleared and recreated (void)\n   * @throws Error if deletion or directory creation fails (permissions, disk space, etc.)\n   *\n   * @example\n   * // Full skill refresh workflow\n   * import { strapiClient } from './strapi-client.js';\n   * import { skillSyncService } from './skill-sync-service.js';\n   *\n   * // 1. Clear all existing skills\n   * await skillSyncService.clearAllSkills();\n   *\n   * // 2. Fetch fresh skills from Strapi\n   * const skills = await strapiClient.getAllSkills();\n   *\n   * // 3. Sync all skills to filesystem\n   * await skillSyncService.syncAllSkills(skills);\n   *\n   * console.log('Full skill refresh completed');\n   *\n   * @example\n   * // Switch agent configurations\n   * const agent1 = await strapiClient.getAgent(123, { populate: ['skills'] });\n   * const agent2 = await strapiClient.getAgent(456, { populate: ['skills'] });\n   *\n   * // Clear skills from previous agent\n   * await skillSyncService.clearAllSkills();\n   *\n   * // Sync skills for new agent\n   * await skillSyncService.syncAllSkills(agent2.skills || []);\n   *\n   * @example\n   * // Project cleanup before switching projects\n   * // Clear skills from current project\n   * await skillSyncService.clearAllSkills();\n   *\n   * // .claude/skills/ now empty, ready for new project skills\n   *\n   * @example\n   * // Testing workflow - start from clean state\n   * beforeEach(async () => {\n   *   // Clear all skills before each test\n   *   await skillSyncService.clearAllSkills();\n   * });\n   *\n   * it('should sync skills correctly', async () => {\n   *   const skills = [\n   *     { name: 'test-skill', skillmd: 'Content', description: 'Test' }\n   *   ];\n   *\n   *   await skillSyncService.syncAllSkills(skills);\n   *\n   *   // Verify skill exists\n   *   const parser = new ClaudeStructureParser(process.cwd());\n   *   const syncedSkills = await parser.parseSkills();\n   *   expect(syncedSkills).toHaveLength(1);\n   * });\n   *\n   * @example\n   * // Error handling - permission errors\n   * try {\n   *   await skillSyncService.clearAllSkills();\n   * } catch (error) {\n   *   if (error.code === 'EPERM') {\n   *     console.error('Permission denied - .claude/skills/ is read-only');\n   *     console.error('Try running with elevated permissions');\n   *   } else if (error.code === 'EBUSY') {\n   *     console.error('Directory in use - close files and retry');\n   *   }\n   *   throw error;\n   * }\n   *\n   * @example\n   * // Graceful shutdown - clear skills before exit\n   * process.on('SIGTERM', async () => {\n   *   console.log('Shutting down - clearing skills...');\n   *   await skillSyncService.clearAllSkills();\n   *   process.exit(0);\n   * });\n   *\n   * @example\n   * // Idempotent behavior\n   * await skillSyncService.clearAllSkills();\n   * await skillSyncService.clearAllSkills();\n   * // Second call succeeds (directory already empty)\n   *\n   * @see {@link syncAllSkills} for syncing skills after clearing\n   * @see {@link removeSkillFromFilesystem} for removing individual skills\n   */\n  async clearAllSkills(): Promise<void> {\n    try {\n      await fs.rm(this.skillsDir, { recursive: true, force: true });\n      await fs.mkdir(this.skillsDir, { recursive: true });\n      console.log('[SkillSync] \u2705 Cleared all skills');\n    } catch (error) {\n      console.error('[SkillSync] \u274c Failed to clear skills:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Replace `{{param}}` template placeholders with actual values in skill content\n   *\n   * @description\n   * Performs string replacement of template placeholders in skill markdown content.\n   * Supports both `{{key}}` and `{{ key }}` syntax (with or without spaces).\n   * Uses global regex replacement to handle multiple occurrences of the same parameter.\n   *\n   * **Template Syntax:**\n   * - `{{param}}` - Compact syntax without spaces\n   * - `{{ param }}` - Spaced syntax (more readable)\n   * - Multiple occurrences of same parameter all replaced\n   * - Non-string values converted to string via `String(value)`\n   *\n   * **Use Cases:**\n   * - Inject environment-specific values (URLs, API keys, credentials)\n   * - Parameterize skill content per user/tenant\n   * - Dynamic skill generation based on configuration\n   *\n   * @private\n   * @param content - Skill markdown content with `{{param}}` placeholders\n   * @param parameters - Key-value pairs where keys match placeholder names\n   * @returns Processed content with all matching placeholders replaced\n   *\n   * @example\n   * // Basic parameter injection\n   * const content = 'API URL: {{api_url}}\\nAPI Key: {{api_key}}';\n   * const parameters = {\n   *   api_url: 'https://api.example.com',\n   *   api_key: 'sk-abc123'\n   * };\n   *\n   * const result = this.injectParameters(content, parameters);\n   * console.log(result);\n   * // Output:\n   * // API URL: https://api.example.com\n   * // API Key: sk-abc123\n   *\n   * @example\n   * // Spaced syntax support\n   * const content = 'Project: {{ project_name }} ({{ environment }})';\n   * const result = this.injectParameters(content, {\n   *   project_name: 'MyApp',\n   *   environment: 'production'\n   * });\n   * // Output: Project: MyApp (production)\n   *\n   * @example\n   * // Multiple occurrences\n   * const content = '{{url}}/users and {{url}}/posts';\n   * const result = this.injectParameters(content, {\n   *   url: 'https://api.example.com'\n   * });\n   * // Output: https://api.example.com/users and https://api.example.com/posts\n   *\n   * @example\n   * // Non-string value conversion\n   * const content = 'Port: {{port}}, Enabled: {{enabled}}';\n   * const result = this.injectParameters(content, {\n   *   port: 3000,\n   *   enabled: true\n   * });\n   * // Output: Port: 3000, Enabled: true\n   */\n  private injectParameters(\n    content: string,\n    parameters: Record<string, any>\n  ): string {\n    let processed = content;\n\n    for (const [key, value] of Object.entries(parameters)) {\n      // Support both {{key}} and {{ key }} formats\n      const regex = new RegExp(`\\\\{\\\\{\\\\s*${key}\\\\s*\\\\}\\\\}`, 'g');\n      processed = processed.replace(regex, String(value));\n    }\n\n    return processed;\n  }\n\n  /**\n   * Validate skill data structure and content before syncing to filesystem\n   *\n   * @description\n   * Ensures skill object contains required fields with valid types and enforces\n   * content size limits to prevent filesystem abuse or disk exhaustion.\n   *\n   * **Validation Rules:**\n   * - `skill.name`: Required, must be non-empty string\n   * - `skill.skillmd`: Required, must be non-empty string\n   * - Content size: Max 1MB per skill (prevents disk exhaustion)\n   *\n   * **Why 1MB Limit:**\n   * - Typical skill content: 1-10KB (instructions, examples)\n   * - 1MB allows for very detailed skills with extensive examples\n   * - Prevents accidental or malicious upload of large files\n   * - Protects filesystem from exhaustion attacks\n   *\n   * @private\n   * @param skill - Skill object to validate\n   * @throws Error if skill.name is missing, empty, or not a string\n   * @throws Error if skill.skillmd is missing, empty, or not a string\n   * @throws Error if skill.skillmd exceeds 1MB size limit\n   *\n   * @example\n   * // Valid skill passes validation\n   * const skill = {\n   *   name: 'pdf-analyzer',\n   *   skillmd: 'Analyze PDF documents...',\n   *   description: 'Use when analyzing PDFs'\n   * };\n   * this.validateSkill(skill);\n   * // No error thrown\n   *\n   * @example\n   * // Missing name throws error\n   * try {\n   *   this.validateSkill({ skillmd: 'Content' });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Invalid skill: name is required and must be a string\n   * }\n   *\n   * @example\n   * // Missing skillmd throws error\n   * try {\n   *   this.validateSkill({ name: 'test-skill' });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Invalid skill: skillmd is required and must be a string\n   * }\n   *\n   * @example\n   * // Content too large throws error\n   * try {\n   *   const largeContent = 'x'.repeat(2 * 1024 * 1024); // 2MB\n   *   this.validateSkill({\n   *     name: 'large-skill',\n   *     skillmd: largeContent\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Skill content too large: large-skill (max 1MB)\n   * }\n   */\n  private validateSkill(skill: Skill): void {\n    if (!skill.name || typeof skill.name !== 'string') {\n      throw new Error('Invalid skill: name is required and must be a string');\n    }\n\n    if (!skill.skillmd || typeof skill.skillmd !== 'string') {\n      throw new Error('Invalid skill: skillmd is required and must be a string');\n    }\n\n    // Check content size limit (1MB)\n    const MAX_SKILL_SIZE = 1024 * 1024; // 1MB\n    if (skill.skillmd.length > MAX_SKILL_SIZE) {\n      throw new Error(`Skill content too large: ${skill.name} (max 1MB)`);\n    }\n  }\n\n  /**\n   * Sanitize skill name to prevent path traversal attacks and ensure filesystem safety\n   *\n   * @description\n   * Cleans skill names by removing or replacing dangerous characters that could be\n   * used for path traversal attacks or cause filesystem issues. Ensures skill names\n   * are safe for use as directory names in `.claude/skills/`.\n   *\n   * **Sanitization Rules:**\n   * 1. Replace all non-alphanumeric characters (except hyphens and underscores) with hyphens\n   * 2. Convert to lowercase for consistency\n   * 3. Use `path.basename()` as additional safety layer (removes any path separators)\n   *\n   * **Security Protection:**\n   * - Prevents path traversal: `../../../etc/passwd` \u2192 `etc-passwd`\n   * - Removes path separators: `skill/../../attack` \u2192 `skill-attack`\n   * - Normalizes special characters: `My Skill!@#$%` \u2192 `my-skill-----`\n   *\n   * **Why Sanitization:**\n   * - Prevents directory traversal attacks\n   * - Ensures cross-platform compatibility (Windows, Linux, macOS)\n   * - Avoids filesystem errors from invalid characters\n   * - Consistent naming convention (lowercase, hyphens)\n   *\n   * @private\n   * @param name - Raw skill name (potentially unsafe, user-provided)\n   * @returns Sanitized skill name (safe for filesystem, alphanumeric/hyphens/underscores/lowercase only)\n   *\n   * @example\n   * // Basic sanitization\n   * const sanitized = this.sanitizeSkillName('pdf-analyzer');\n   * console.log(sanitized);\n   * // Output: pdf-analyzer\n   *\n   * @example\n   * // Path traversal attack prevention\n   * const sanitized = this.sanitizeSkillName('../../../etc/passwd');\n   * console.log(sanitized);\n   * // Output: etc-passwd\n   * // Dangerous path separators removed\n   *\n   * @example\n   * // Special character replacement\n   * const sanitized = this.sanitizeSkillName('My Skill!@#$%^&*()');\n   * console.log(sanitized);\n   * // Output: my-skill----------\n   * // Spaces and special chars replaced with hyphens, converted to lowercase\n   *\n   * @example\n   * // Windows path separator attack\n   * const sanitized = this.sanitizeSkillName('C:\\\\Windows\\\\System32');\n   * console.log(sanitized);\n   * // Output: c-windows-system32\n   * // Backslashes replaced, drive letter removed\n   *\n   * @example\n   * // Preserves valid characters\n   * const sanitized = this.sanitizeSkillName('Web_Scraper-v2');\n   * console.log(sanitized);\n   * // Output: web_scraper-v2\n   * // Hyphens and underscores preserved, converted to lowercase\n   *\n   * @example\n   * // Unicode and emoji removal\n   * const sanitized = this.sanitizeSkillName('PDF Analyzer \ud83d\udcc4');\n   * console.log(sanitized);\n   * // Output: pdf-analyzer--\n   * // Emoji replaced with hyphens\n   */\n  private sanitizeSkillName(name: string): string {\n    // Remove any path separators and special characters\n    // Only allow: alphanumeric, hyphens, underscores\n    const sanitized = name.replace(/[^a-z0-9-_]/gi, '-').toLowerCase();\n\n    // Use path.basename as additional safety layer\n    return path.basename(sanitized);\n  }\n\n  /**\n   * Validate template parameter keys and values before injection\n   *\n   * @description\n   * Ensures parameter keys are safe for regex replacement and values don't exceed\n   * size limits. Prevents injection attacks and protects against excessive memory\n   * usage during template replacement.\n   *\n   * **Validation Rules:**\n   * - **Parameter Keys**: Alphanumeric and underscores only (regex-safe, no special chars)\n   * - **Parameter Values**: Max 10KB per value (prevents memory exhaustion)\n   *\n   * **Why These Limits:**\n   * - **Key Validation**: Prevents regex injection attacks via special characters\n   * - **Value Validation**: Typical parameter values are <1KB (URLs, API keys, names)\n   * - **10KB Limit**: Allows for large configuration values while preventing abuse\n   * - **Memory Safety**: Prevents excessive memory usage during string replacement\n   *\n   * **Security Benefits:**\n   * - Prevents regex injection via malicious parameter keys\n   * - Protects against memory exhaustion attacks\n   * - Ensures predictable template replacement behavior\n   *\n   * @private\n   * @param parameters - Key-value pairs to validate\n   * @throws Error if any parameter key contains invalid characters (non-alphanumeric/underscore)\n   * @throws Error if any parameter value exceeds 10KB size limit\n   *\n   * @example\n   * // Valid parameters pass validation\n   * const parameters = {\n   *   api_url: 'https://api.example.com',\n   *   api_key: 'sk-abc123',\n   *   environment: 'production'\n   * };\n   * this.validateParameters(parameters);\n   * // No error thrown\n   *\n   * @example\n   * // Invalid key with special characters throws error\n   * try {\n   *   this.validateParameters({\n   *     'api-url': 'https://api.example.com'  // Hyphen not allowed\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Invalid parameter key: api-url\n   * }\n   *\n   * @example\n   * // Invalid key with dots throws error\n   * try {\n   *   this.validateParameters({\n   *     'config.url': 'https://api.example.com'  // Dot not allowed\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Invalid parameter key: config.url\n   * }\n   *\n   * @example\n   * // Value too large throws error\n   * try {\n   *   const largeValue = 'x'.repeat(20 * 1024); // 20KB\n   *   this.validateParameters({\n   *     large_param: largeValue\n   *   });\n   * } catch (error) {\n   *   console.error(error.message);\n   *   // Output: Parameter value too long: large_param (max 10KB)\n   * }\n   *\n   * @example\n   * // Valid keys - alphanumeric and underscores\n   * this.validateParameters({\n   *   project_name: 'MyApp',\n   *   API_KEY: 'secret',\n   *   env123: 'production',\n   *   _private: 'value'\n   * });\n   * // No error thrown - all keys valid\n   *\n   * @example\n   * // Non-string values converted to string for length check\n   * this.validateParameters({\n   *   port: 3000,           // String(3000).length = 4\n   *   enabled: true,        // String(true).length = 4\n   *   count: 999999         // String(999999).length = 6\n   * });\n   * // No error thrown - all values under 10KB when converted to string\n   */\n  private validateParameters(parameters: Record<string, any>): void {\n    for (const [key, value] of Object.entries(parameters)) {\n      // Key validation: only alphanumeric and underscore\n      if (!/^[a-zA-Z0-9_]+$/.test(key)) {\n        throw new Error(`Invalid parameter key: ${key}`);\n      }\n\n      // Value validation: max length 10KB\n      const MAX_PARAM_LENGTH = 10 * 1024; // 10KB\n      if (String(value).length > MAX_PARAM_LENGTH) {\n        throw new Error(`Parameter value too long: ${key} (max 10KB)`);\n      }\n    }\n  }\n}\n\n// Export singleton instance\nexport const skillSyncService = new SkillSyncService();\n",
        "last_modified": "2026-01-02T14:06:15.773565"
      },
      "task_intent": {
        "title": "002-add-jsdoc-documentation-for-backend-services",
        "description": "Add comprehensive JSDoc documentation to 27 service files in src/services with 65+ exported functions, classes, and interfaces. Focus on function parameters, return types, usage patterns, and examples.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:06:15.663259",
  "last_updated": "2026-01-02T14:06:15.675304"
}
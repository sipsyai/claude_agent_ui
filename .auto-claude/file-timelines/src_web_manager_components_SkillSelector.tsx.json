{
  "file_path": "src/web/manager/components/SkillSelector.tsx",
  "main_branch_history": [],
  "task_views": {
    "004-document-frontend-react-components-and-hooks": {
      "task_id": "004-document-frontend-react-components-and-hooks",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "import React, { useState, useEffect } from 'react';\nimport * as api from '../services/api';\nimport { InfoIcon } from './ui/Icons';\n\ninterface SkillSelectorProps {\n  selectedSkills: string[];\n  onChange: (skills: string[]) => void;\n  disabled?: boolean;\n  directory?: string;\n}\n\nconst SkillSelector: React.FC<SkillSelectorProps> = ({\n  selectedSkills,\n  onChange,\n  disabled = false,\n  directory,\n}) => {\n  const [skills, setSkills] = useState<api.Skill[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedSkillDetail, setSelectedSkillDetail] = useState<api.Skill | null>(null);\n\n  useEffect(() => {\n    loadSkills();\n  }, [directory]);\n\n  const loadSkills = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const allSkills = await api.getSkills(directory, true);\n      setSkills(allSkills);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load skills');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleSkill = (skillName: string) => {\n    let newSkills: string[];\n    if (selectedSkills.includes(skillName)) {\n      newSkills = selectedSkills.filter(name => name !== skillName);\n    } else {\n      newSkills = [...selectedSkills, skillName];\n    }\n    onChange(newSkills);\n  };\n\n  const toggleSelectAll = () => {\n    if (selectedSkills.length === filteredSkills.length && filteredSkills.length > 0) {\n      onChange([]);\n    } else {\n      onChange(filteredSkills.map(s => s.name));\n    }\n  };\n\n  const filterSkills = (skillsList: api.Skill[]): api.Skill[] => {\n    if (!searchTerm.trim()) return skillsList;\n\n    const term = searchTerm.toLowerCase();\n    return skillsList.filter(skill =>\n      skill.name.toLowerCase().includes(term) ||\n      skill.description.toLowerCase().includes(term)\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"text-sm text-muted-foreground\">\n        Loading skills...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-sm text-red-500\">\n        {error}\n      </div>\n    );\n  }\n\n  if (skills.length === 0) {\n    return (\n      <div className=\"text-sm text-muted-foreground p-3 border border-dashed border-border rounded\">\n        No skills found. Create skills in the Skills section to see them here.\n      </div>\n    );\n  }\n\n  const filteredSkills = filterSkills(skills);\n  const allSelected = filteredSkills.length > 0 && selectedSkills.length === filteredSkills.length;\n\n  return (\n    <div className=\"space-y-3\">\n      {/* Search */}\n      <div className=\"space-y-2\">\n        <input\n          type=\"text\"\n          placeholder=\"Search skills by name or description...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          disabled={disabled}\n          className=\"w-full px-3 py-2 text-sm border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50\"\n        />\n      </div>\n\n      {/* Summary and Select All */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"text-xs text-muted-foreground\">\n          {selectedSkills.length > 0\n            ? `${selectedSkills.length} skill(s) selected`\n            : 'No skills selected'}\n        </div>\n        {filteredSkills.length > 0 && (\n          <label className=\"flex items-center gap-2 text-xs cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={allSelected}\n              onChange={toggleSelectAll}\n              disabled={disabled}\n              className=\"w-4 h-4 rounded\"\n            />\n            <span className=\"text-muted-foreground\">\n              {allSelected ? 'Deselect All' : 'Select All'}\n            </span>\n          </label>\n        )}\n      </div>\n\n      {/* Skills List */}\n      <div className=\"border border-border rounded-md max-h-96 overflow-y-auto\">\n        {filteredSkills.length === 0 ? (\n          <div className=\"p-4 text-sm text-muted-foreground text-center\">\n            No skills match your search\n          </div>\n        ) : (\n          <div className=\"p-2 space-y-1\">\n            {filteredSkills.map((skill) => {\n              const isSelected = selectedSkills.includes(skill.name);\n\n              return (\n                <div\n                  key={skill.id}\n                  className=\"flex items-start gap-2 p-2 rounded hover:bg-secondary/50 transition-colors\"\n                >\n                  <label className=\"flex items-start gap-2 flex-1 min-w-0 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={isSelected}\n                      onChange={() => toggleSkill(skill.name)}\n                      disabled={disabled}\n                      className=\"mt-1 w-4 h-4 rounded flex-shrink-0\"\n                    />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"font-medium text-sm text-foreground break-all\">\n                        {skill.name}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground mt-0.5 line-clamp-2\">\n                        {skill.description}\n                      </div>\n\n                      {/* Usage badge */}\n                      {skill.analytics?.executionCount !== undefined && skill.analytics?.executionCount > 0 && (\n                        <div className=\"mt-1\">\n                          <span className=\"inline-block text-xs px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded\">\n                            Used in {skill.analytics?.executionCount} agent{skill.analytics?.executionCount !== 1 ? 's' : ''}\n                          </span>\n                        </div>\n                      )}\n\n                      {/* Tools badge */}\n                      {skill.toolConfig?.allowedTools && skill.toolConfig?.allowedTools.length > 0 && (\n                        <div className=\"mt-1 flex flex-wrap gap-1\">\n                          {skill.toolConfig?.allowedTools.slice(0, 3).map(tool => (\n                            <span key={tool} className=\"inline-block text-xs px-1.5 py-0.5 bg-gray-100 text-gray-700 rounded\">\n                              {tool}\n                            </span>\n                          ))}\n                          {skill.toolConfig?.allowedTools.length > 3 && (\n                            <span className=\"text-xs text-muted-foreground\">\n                              +{skill.toolConfig?.allowedTools.length - 3} more\n                            </span>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </label>\n\n                  {/* Info button */}\n                  <button\n                    type=\"button\"\n                    onClick={() => setSelectedSkillDetail(skill)}\n                    className=\"flex-shrink-0 text-muted-foreground hover:text-primary p-1\"\n                    title=\"View details\"\n                  >\n                    <InfoIcon className=\"h-4 w-4\" />\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Skill Detail Modal */}\n      {selectedSkillDetail && (\n        <div\n          className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\"\n          onClick={() => setSelectedSkillDetail(null)}\n        >\n          <div\n            className=\"bg-background border border-border rounded-lg max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"p-4 border-b border-border\">\n              <h3 className=\"text-lg font-semibold\">{selectedSkillDetail.name}</h3>\n              <p className=\"text-sm text-muted-foreground mt-1\">{selectedSkillDetail.description}</p>\n            </div>\n\n            <div className=\"p-4 overflow-y-auto flex-1\">\n              <div className=\"space-y-3\">\n                {/* Usage Info */}\n                {selectedSkillDetail.analytics?.executionCount !== undefined && (\n                  <div>\n                    <h4 className=\"text-sm font-medium mb-1\">Usage</h4>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Used in {selectedSkillDetail.analytics?.executionCount || 0} agent(s)\n                      {selectedSkillDetail.agentSelection && selectedSkillDetail.agentSelection.length > 0 && (\n                        <>: {selectedSkillDetail.agentSelection.join(', ')}</>\n                      )}\n                    </p>\n                  </div>\n                )}\n\n                {/* Allowed Tools */}\n                {selectedSkillDetail.toolConfig?.allowedTools && selectedSkillDetail.toolConfig?.allowedTools.length > 0 && (\n                  <div>\n                    <h4 className=\"text-sm font-medium mb-1\">Allowed Tools</h4>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {selectedSkillDetail.toolConfig?.allowedTools.map(tool => (\n                        <span key={tool} className=\"inline-block text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded\">\n                          {tool}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Content Preview */}\n                <div>\n                  <h4 className=\"text-sm font-medium mb-1\">Instructions</h4>\n                  <pre className=\"text-xs bg-secondary/50 p-3 rounded border border-border overflow-x-auto max-h-60\">\n                    {selectedSkillDetail.skillmd}\n                  </pre>\n                </div>\n\n                {/* File Path */}\n                <div>\n                  <h4 className=\"text-sm font-medium mb-1\">Location</h4>\n                  <p className=\"text-xs font-mono text-muted-foreground\">{selectedSkillDetail.name + \".md\"}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"p-4 border-t border-border flex justify-end\">\n              <button\n                onClick={() => setSelectedSkillDetail(null)}\n                className=\"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SkillSelector;\n",
        "timestamp": "2026-01-02T14:22:14.293924"
      },
      "worktree_state": {
        "content": "/**\n * @file SkillSelector.tsx\n * @description Multi-select skill picker component with search, filtering, and inline detail preview.\n * This component provides an interactive interface for selecting multiple skills from a searchable list,\n * with visual indicators for usage statistics and tool configuration, plus a modal for viewing full details.\n *\n * ## Features\n * - **Multi-Select Interface**: Checkbox-based selection allowing multiple skills to be selected simultaneously\n * - **Search and Filter**: Real-time search filtering by skill name or description text\n * - **Select All / Deselect All**: Bulk selection toggle for all filtered skills with single click\n * - **Usage Statistics**: Visual badges showing how many agents use each skill (executionCount)\n * - **Tool Configuration Display**: Preview of allowed tools (up to 3 visible) with overflow indicator\n * - **Skill Detail Modal**: Click info icon to view comprehensive skill details including usage, tools, instructions, location\n * - **Loading/Error/Empty States**: Graceful handling of API states with appropriate feedback messages\n * - **Directory-Aware**: Reloads skills when directory changes (via useEffect dependency)\n * - **Disabled Mode**: Can be disabled to show read-only view of selections\n * - **Controlled Component**: Fully controlled via selectedSkills and onChange props\n *\n * ## Skill Selection\n * The component provides multi-select functionality with visual feedback:\n *\n * ### Selection Mechanism\n * - **Checkbox Input**: Each skill has a checkbox for individual selection toggle\n * - **Label Wrapper**: Entire skill item is clickable via label wrapping checkbox\n * - **Visual Feedback**: Selected items show checked checkbox, hover shows bg-secondary/50\n * - **Immutable Updates**: Creates new array on selection change (doesn't mutate selectedSkills)\n * - **Name-Based Matching**: Uses skill.name string for selection tracking (not ID)\n * - **Accessibility**: Full keyboard navigation support via native checkbox elements\n *\n * ### Selection Workflow\n * 1. User clicks checkbox or skill item label\n * 2. `toggleSkill(skillName)` called\n * 3. New array created: add if not selected, remove if already selected\n * 4. `onChange(newSkills)` invoked with updated array\n * 5. Parent component updates state\n * 6. Component re-renders with new selectedSkills prop\n *\n * ## Multi-Select Behavior\n * Supports both individual and bulk selection operations:\n *\n * ### Individual Selection\n * - **Toggle**: Click skill checkbox to add/remove from selection\n * - **Add**: Appends skill name to selectedSkills array (`[...selectedSkills, skillName]`)\n * - **Remove**: Filters out skill name from array (`selectedSkills.filter(name => name !== skillName)`)\n * - **Idempotent**: Safe to click multiple times (toggle behavior)\n *\n * ### Select All / Deselect All\n * - **Location**: Top-right corner above skill list\n * - **Condition**: Only visible when filteredSkills.length > 0\n * - **Behavior**:\n *   - If all filtered skills selected: **Deselect All** \u2192 `onChange([])`\n *   - If some/none selected: **Select All** \u2192 `onChange(filteredSkills.map(s => s.name))`\n * - **Label**: Dynamically changes between \"Select All\" and \"Deselect All\"\n * - **Scope**: Only affects currently visible/filtered skills, not all skills\n * - **Visual State**: Checkbox shows checked when all filtered skills selected\n *\n * ### Selection Summary\n * - **Display**: Bottom-left corner shows count: \"X skill(s) selected\" or \"No skills selected\"\n * - **Count**: Based on selectedSkills.length (total selected, not just filtered)\n * - **Real-Time**: Updates immediately as selections change\n *\n * ## Filtering\n * Real-time search filtering for finding skills quickly:\n *\n * ### Search Mechanism\n * - **Input Field**: Top of component, placeholder \"Search skills by name or description...\"\n * - **Real-Time**: Filters as user types, no submit button required\n * - **Case-Insensitive**: Converts both search term and skill text to lowercase\n * - **Multi-Field**: Searches both skill.name AND skill.description\n * - **Includes Match**: Uses `.includes()` for partial matching (not exact match)\n * - **Trim Handling**: Empty/whitespace-only search returns all skills\n *\n * ### Filter Workflow\n * 1. User types in search input\n * 2. `setSearchTerm(value)` updates state\n * 3. Component re-renders\n * 4. `filterSkills(skills)` applied during render\n * 5. Filtered list displayed\n * 6. Select All scope updates to filtered set\n *\n * ### Empty Search Results\n * - **Display**: \"No skills match your search\" message in skill list area\n * - **Centered**: text-center alignment\n * - **Styling**: Muted text color (text-muted-foreground)\n * - **Select All**: Hidden when no results\n *\n * ## Skill Display\n * Each skill item shows comprehensive information with visual indicators:\n *\n * ### Skill Item Layout\n * - **Container**: Flex row with gap-2, hover background (bg-secondary/50)\n * - **Checkbox**: Left-aligned, 4x4 size with mt-1 for visual alignment\n * - **Content Area**: Flex-1 with min-w-0 for text truncation\n * - **Info Button**: Right-aligned, flex-shrink-0, shows InfoIcon\n *\n * ### Skill Item Content\n * - **Name**: font-medium text-sm with break-all for long names\n * - **Description**: text-xs muted with line-clamp-2 (truncates to 2 lines)\n * - **Usage Badge**: Blue badge showing \"Used in X agent(s)\" when executionCount > 0\n * - **Tools Preview**: Gray badges for allowed tools (max 3 visible + overflow indicator)\n * - **Badge Conditions**:\n *   - Usage badge: Only if `skill.analytics?.executionCount > 0`\n *   - Tools badge: Only if `skill.toolConfig?.allowedTools.length > 0`\n *\n * ### Badge Styling\n * - **Usage Badge**: bg-blue-100 text-blue-700 with rounded corners\n * - **Tool Badge**: bg-gray-100 text-gray-700 with rounded corners\n * - **Overflow Indicator**: \"+X more\" in muted text when tools.length > 3\n * - **Spacing**: mt-1 above badges, gap-1 between tool badges\n *\n * ## Skill Detail Modal\n * Clicking the info icon opens a modal with comprehensive skill information:\n *\n * ### Modal Trigger\n * - **Button**: InfoIcon button on right side of each skill item\n * - **Action**: Sets `selectedSkillDetail` state to clicked skill\n * - **Non-Selection**: Clicking info does NOT select/deselect the skill\n * - **Title Attribute**: \"View details\" tooltip on hover\n *\n * ### Modal Content Sections\n * 1. **Header**:\n *    - Skill name (text-lg font-semibold)\n *    - Description (text-sm muted, mt-1)\n * 2. **Usage Info**:\n *    - Execution count: \"Used in X agent(s)\"\n *    - Agent list: If agentSelection array exists, shows agent names joined\n * 3. **Allowed Tools**:\n *    - All tools displayed as badges (no 3-tool limit like list view)\n *    - Flex wrap layout with gap-1\n * 4. **Instructions**:\n *    - Pre-formatted skill.skillmd content\n *    - Monospace font (font-mono)\n *    - Max height with scroll (max-h-60)\n * 5. **Location**:\n *    - File path: `{skillName}.md`\n *    - Monospace display (font-mono)\n *\n * ### Modal Behavior\n * - **Background**: Semi-transparent black overlay (bg-black/50)\n * - **Close Methods**: Click backdrop, click Close button\n * - **Z-Index**: z-50 for layering above other content\n * - **Event Propagation**: `stopPropagation()` on modal content prevents backdrop close\n * - **Scrollable**: overflow-y-auto on content section, max-h-[80vh]\n * - **Responsive**: max-w-2xl with padding for mobile\n *\n * ## Directory Integration\n * Component reloads skills when directory changes:\n *\n * ### Directory Handling\n * - **useEffect Dependency**: `[directory]` triggers reload on directory change\n * - **API Call**: `api.getSkills(directory, true)` passes directory to backend\n * - **Loading State**: Shows \"Loading skills...\" during fetch\n * - **Error Handling**: Displays error message if API call fails\n * - **Graceful Degradation**: Shows empty state if no skills found\n *\n * ## Styling Behavior\n * Uses Tailwind CSS classes for consistent theme-aware styling:\n * - **Container**: space-y-3 vertical spacing between sections\n * - **Search Input**: w-full px-3 py-2, focus ring (ring-primary/50)\n * - **Summary Bar**: flex items-center justify-between with text-xs\n * - **Skills List**: border rounded-md with max-h-96 overflow-y-auto\n * - **Skill Item**: p-2 rounded hover:bg-secondary/50 transition-colors\n * - **Disabled State**: opacity-50 on inputs and checkboxes when disabled\n * - **Empty State**: border-dashed with p-3 padding\n *\n * @example\n * // Basic usage with skill selection\n * import SkillSelector from './SkillSelector';\n *\n * function MyComponent() {\n *   const [selectedSkills, setSelectedSkills] = useState<string[]>([]);\n *\n *   return (\n *     <div>\n *       <label className=\"block mb-2\">Select Skills:</label>\n *       <SkillSelector\n *         selectedSkills={selectedSkills}\n *         onChange={setSelectedSkills}\n *       />\n *       <p>Selected: {selectedSkills.join(', ')}</p>\n *     </div>\n *   );\n * }\n *\n * @example\n * // With custom directory for project-specific skills\n * import SkillSelector from './SkillSelector';\n *\n * function AgentForm() {\n *   const [skills, setSkills] = useState<string[]>(['skill-analyzer', 'code-reviewer']);\n *   const directory = '/path/to/project';\n *\n *   const handleSkillChange = (newSkills: string[]) => {\n *     console.log('Skills changed:', newSkills);\n *     setSkills(newSkills);\n *   };\n *\n *   return (\n *     <SkillSelector\n *       selectedSkills={skills}\n *       onChange={handleSkillChange}\n *       directory={directory}\n *     />\n *   );\n * }\n *\n * @example\n * // Disabled mode for read-only view\n * import SkillSelector from './SkillSelector';\n *\n * function SkillViewer({ skills }: { skills: string[] }) {\n *   return (\n *     <div>\n *       <h3>Current Skills (Read-Only)</h3>\n *       <SkillSelector\n *         selectedSkills={skills}\n *         onChange={() => {}} // No-op since disabled\n *         disabled={true}\n *       />\n *     </div>\n *   );\n * }\n *\n * @example\n * // Understanding skill selection workflow\n * import SkillSelector from './SkillSelector';\n *\n * function InteractiveExample() {\n *   const [skills, setSkills] = useState<string[]>([]);\n *\n *   const handleChange = (newSkills: string[]) => {\n *     // Workflow:\n *     // 1. User clicks \"data-processor\" checkbox\n *     // 2. toggleSkill('data-processor') called\n *     // 3. If not in array: [...skills, 'data-processor']\n *     //    If in array: skills.filter(s => s !== 'data-processor')\n *     // 4. onChange invoked with new array\n *     // 5. State updated here\n *     // 6. Component re-renders with updated selections\n *     console.log('Changed from', skills, 'to', newSkills);\n *     setSkills(newSkills);\n *   };\n *\n *   // User interaction flow:\n *   // 1. Search \"analyzer\" \u2192 filters list to matching skills\n *   // 2. Click \"Select All\" \u2192 all filtered skills selected\n *   // 3. Click info icon \u2192 modal opens with skill details\n *   // 4. Click \"code-reviewer\" \u2192 toggles selection\n *   // 5. Clear search \u2192 all skills visible, selections preserved\n *   return (\n *     <div>\n *       <SkillSelector selectedSkills={skills} onChange={handleChange} />\n *     </div>\n *   );\n * }\n */\n\nimport React, { useState, useEffect } from 'react';\nimport * as api from '../services/api';\nimport { InfoIcon } from './ui/Icons';\n\n/**\n * Props for the SkillSelector component\n *\n * @interface SkillSelectorProps\n * @property {string[]} selectedSkills - Array of selected skill names (controlled state)\n * @property {(skills: string[]) => void} onChange - Callback invoked when selection changes with new skill name array\n * @property {boolean} [disabled=false] - If true, disables all inputs and shows read-only view\n * @property {string} [directory] - Optional directory path to filter skills, triggers reload when changed\n */\ninterface SkillSelectorProps {\n  selectedSkills: string[];\n  onChange: (skills: string[]) => void;\n  disabled?: boolean;\n  directory?: string;\n}\n\nconst SkillSelector: React.FC<SkillSelectorProps> = ({\n  selectedSkills,\n  onChange,\n  disabled = false,\n  directory,\n}) => {\n  const [skills, setSkills] = useState<api.Skill[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedSkillDetail, setSelectedSkillDetail] = useState<api.Skill | null>(null);\n\n  useEffect(() => {\n    loadSkills();\n  }, [directory]);\n\n  /**\n   * Loads skills from the API based on the current directory.\n   * Sets loading state during fetch, handles errors, and updates skills state on success.\n   *\n   * @internal\n   * @async\n   * @function loadSkills\n   * @returns {Promise<void>}\n   *\n   * @description\n   * Workflow:\n   * 1. Set loading=true and clear any previous errors\n   * 2. Call api.getSkills(directory, true) to fetch all skills\n   * 3. Update skills state with fetched data\n   * 4. If error occurs, set error message from Error object or generic message\n   * 5. Set loading=false in finally block regardless of success/failure\n   *\n   * Error Handling:\n   * - Catches all errors (network, API, parsing)\n   * - Extracts message from Error instances\n   * - Falls back to generic \"Failed to load skills\" for non-Error throws\n   * - Error displayed to user via error state rendering\n   */\n  const loadSkills = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const allSkills = await api.getSkills(directory, true);\n      setSkills(allSkills);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load skills');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /**\n   * Toggles a skill's selection state (add if not selected, remove if selected).\n   * Creates a new array and invokes onChange callback with updated selection.\n   *\n   * @internal\n   * @function toggleSkill\n   * @param {string} skillName - The name of the skill to toggle\n   * @returns {void}\n   *\n   * @description\n   * Toggle Logic:\n   * - If skillName is in selectedSkills: Remove it (filter out)\n   * - If skillName is NOT in selectedSkills: Add it (spread and append)\n   * - Creates new array (immutable update pattern)\n   * - Invokes onChange(newSkills) to notify parent\n   *\n   * Example:\n   * - selectedSkills = ['skill-a', 'skill-b']\n   * - toggleSkill('skill-c') \u2192 onChange(['skill-a', 'skill-b', 'skill-c'])\n   * - toggleSkill('skill-b') \u2192 onChange(['skill-a'])\n   */\n  const toggleSkill = (skillName: string) => {\n    let newSkills: string[];\n    if (selectedSkills.includes(skillName)) {\n      newSkills = selectedSkills.filter(name => name !== skillName);\n    } else {\n      newSkills = [...selectedSkills, skillName];\n    }\n    onChange(newSkills);\n  };\n\n  /**\n   * Toggles selection of all currently visible/filtered skills.\n   * If all filtered skills are selected, deselects all. Otherwise, selects all filtered skills.\n   *\n   * @internal\n   * @function toggleSelectAll\n   * @returns {void}\n   *\n   * @description\n   * Select All Logic:\n   * - Check if all filtered skills are currently selected\n   * - Condition: selectedSkills.length === filteredSkills.length AND filteredSkills.length > 0\n   * - If all selected: Deselect All \u2192 onChange([])\n   * - If some/none selected: Select All \u2192 onChange(filteredSkills.map(s => s.name))\n   *\n   * Scope:\n   * - Only affects currently visible/filtered skills\n   * - If search is active, only filtered skills are selected\n   * - Does NOT affect skills filtered out by search\n   *\n   * Example:\n   * - All skills: ['skill-a', 'skill-b', 'skill-c']\n   * - Search \"b\" \u2192 filteredSkills = ['skill-b']\n   * - toggleSelectAll() \u2192 onChange(['skill-b'])\n   * - toggleSelectAll() again \u2192 onChange([])\n   */\n  const toggleSelectAll = () => {\n    if (selectedSkills.length === filteredSkills.length && filteredSkills.length > 0) {\n      onChange([]);\n    } else {\n      onChange(filteredSkills.map(s => s.name));\n    }\n  };\n\n  /**\n   * Filters skills array based on current search term.\n   * Returns skills matching search term in name or description (case-insensitive).\n   *\n   * @internal\n   * @function filterSkills\n   * @param {api.Skill[]} skillsList - Array of all skills to filter\n   * @returns {api.Skill[]} Filtered array of skills matching search term\n   *\n   * @description\n   * Filter Logic:\n   * - If searchTerm is empty/whitespace: Return all skills unchanged\n   * - Convert search term to lowercase for case-insensitive matching\n   * - Check if term is included in skill.name (lowercase)\n   * - OR check if term is included in skill.description (lowercase)\n   * - Return filtered array with matching skills only\n   *\n   * Search Behavior:\n   * - Partial matching (uses .includes(), not exact match)\n   * - Case-insensitive (converts to lowercase)\n   * - Multi-field (searches name AND description)\n   * - Trim handling (whitespace-only search returns all)\n   *\n   * Example:\n   * - skillsList = [{name: 'Code-Analyzer', description: 'Analyzes code'}, {name: 'Data-Processor', description: 'Processes data'}]\n   * - searchTerm = 'code' \u2192 Returns [{name: 'Code-Analyzer', ...}]\n   * - searchTerm = 'data' \u2192 Returns [{name: 'Data-Processor', ...}]\n   * - searchTerm = 'anal' \u2192 Returns [{name: 'Code-Analyzer', ...}] (partial match in description)\n   */\n  const filterSkills = (skillsList: api.Skill[]): api.Skill[] => {\n    if (!searchTerm.trim()) return skillsList;\n\n    const term = searchTerm.toLowerCase();\n    return skillsList.filter(skill =>\n      skill.name.toLowerCase().includes(term) ||\n      skill.description.toLowerCase().includes(term)\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"text-sm text-muted-foreground\">\n        Loading skills...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-sm text-red-500\">\n        {error}\n      </div>\n    );\n  }\n\n  if (skills.length === 0) {\n    return (\n      <div className=\"text-sm text-muted-foreground p-3 border border-dashed border-border rounded\">\n        No skills found. Create skills in the Skills section to see them here.\n      </div>\n    );\n  }\n\n  const filteredSkills = filterSkills(skills);\n  const allSelected = filteredSkills.length > 0 && selectedSkills.length === filteredSkills.length;\n\n  return (\n    <div className=\"space-y-3\">\n      {/* Search */}\n      <div className=\"space-y-2\">\n        <input\n          type=\"text\"\n          placeholder=\"Search skills by name or description...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          disabled={disabled}\n          className=\"w-full px-3 py-2 text-sm border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50\"\n        />\n      </div>\n\n      {/* Summary and Select All */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"text-xs text-muted-foreground\">\n          {selectedSkills.length > 0\n            ? `${selectedSkills.length} skill(s) selected`\n            : 'No skills selected'}\n        </div>\n        {filteredSkills.length > 0 && (\n          <label className=\"flex items-center gap-2 text-xs cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={allSelected}\n              onChange={toggleSelectAll}\n              disabled={disabled}\n              className=\"w-4 h-4 rounded\"\n            />\n            <span className=\"text-muted-foreground\">\n              {allSelected ? 'Deselect All' : 'Select All'}\n            </span>\n          </label>\n        )}\n      </div>\n\n      {/* Skills List */}\n      <div className=\"border border-border rounded-md max-h-96 overflow-y-auto\">\n        {filteredSkills.length === 0 ? (\n          <div className=\"p-4 text-sm text-muted-foreground text-center\">\n            No skills match your search\n          </div>\n        ) : (\n          <div className=\"p-2 space-y-1\">\n            {filteredSkills.map((skill) => {\n              const isSelected = selectedSkills.includes(skill.name);\n\n              return (\n                <div\n                  key={skill.id}\n                  className=\"flex items-start gap-2 p-2 rounded hover:bg-secondary/50 transition-colors\"\n                >\n                  <label className=\"flex items-start gap-2 flex-1 min-w-0 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={isSelected}\n                      onChange={() => toggleSkill(skill.name)}\n                      disabled={disabled}\n                      className=\"mt-1 w-4 h-4 rounded flex-shrink-0\"\n                    />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"font-medium text-sm text-foreground break-all\">\n                        {skill.name}\n                      </div>\n                      <div className=\"text-xs text-muted-foreground mt-0.5 line-clamp-2\">\n                        {skill.description}\n                      </div>\n\n                      {/* Usage badge */}\n                      {skill.analytics?.executionCount !== undefined && skill.analytics?.executionCount > 0 && (\n                        <div className=\"mt-1\">\n                          <span className=\"inline-block text-xs px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded\">\n                            Used in {skill.analytics?.executionCount} agent{skill.analytics?.executionCount !== 1 ? 's' : ''}\n                          </span>\n                        </div>\n                      )}\n\n                      {/* Tools badge */}\n                      {skill.toolConfig?.allowedTools && skill.toolConfig?.allowedTools.length > 0 && (\n                        <div className=\"mt-1 flex flex-wrap gap-1\">\n                          {skill.toolConfig?.allowedTools.slice(0, 3).map(tool => (\n                            <span key={tool} className=\"inline-block text-xs px-1.5 py-0.5 bg-gray-100 text-gray-700 rounded\">\n                              {tool}\n                            </span>\n                          ))}\n                          {skill.toolConfig?.allowedTools.length > 3 && (\n                            <span className=\"text-xs text-muted-foreground\">\n                              +{skill.toolConfig?.allowedTools.length - 3} more\n                            </span>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </label>\n\n                  {/* Info button */}\n                  <button\n                    type=\"button\"\n                    onClick={() => setSelectedSkillDetail(skill)}\n                    className=\"flex-shrink-0 text-muted-foreground hover:text-primary p-1\"\n                    title=\"View details\"\n                  >\n                    <InfoIcon className=\"h-4 w-4\" />\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Skill Detail Modal */}\n      {selectedSkillDetail && (\n        <div\n          className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\"\n          onClick={() => setSelectedSkillDetail(null)}\n        >\n          <div\n            className=\"bg-background border border-border rounded-lg max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"p-4 border-b border-border\">\n              <h3 className=\"text-lg font-semibold\">{selectedSkillDetail.name}</h3>\n              <p className=\"text-sm text-muted-foreground mt-1\">{selectedSkillDetail.description}</p>\n            </div>\n\n            <div className=\"p-4 overflow-y-auto flex-1\">\n              <div className=\"space-y-3\">\n                {/* Usage Info */}\n                {selectedSkillDetail.analytics?.executionCount !== undefined && (\n                  <div>\n                    <h4 className=\"text-sm font-medium mb-1\">Usage</h4>\n                    <p className=\"text-sm text-muted-foreground\">\n                      Used in {selectedSkillDetail.analytics?.executionCount || 0} agent(s)\n                      {selectedSkillDetail.agentSelection && selectedSkillDetail.agentSelection.length > 0 && (\n                        <>: {selectedSkillDetail.agentSelection.join(', ')}</>\n                      )}\n                    </p>\n                  </div>\n                )}\n\n                {/* Allowed Tools */}\n                {selectedSkillDetail.toolConfig?.allowedTools && selectedSkillDetail.toolConfig?.allowedTools.length > 0 && (\n                  <div>\n                    <h4 className=\"text-sm font-medium mb-1\">Allowed Tools</h4>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {selectedSkillDetail.toolConfig?.allowedTools.map(tool => (\n                        <span key={tool} className=\"inline-block text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded\">\n                          {tool}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Content Preview */}\n                <div>\n                  <h4 className=\"text-sm font-medium mb-1\">Instructions</h4>\n                  <pre className=\"text-xs bg-secondary/50 p-3 rounded border border-border overflow-x-auto max-h-60\">\n                    {selectedSkillDetail.skillmd}\n                  </pre>\n                </div>\n\n                {/* File Path */}\n                <div>\n                  <h4 className=\"text-sm font-medium mb-1\">Location</h4>\n                  <p className=\"text-xs font-mono text-muted-foreground\">{selectedSkillDetail.name + \".md\"}</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"p-4 border-t border-border flex justify-end\">\n              <button\n                onClick={() => setSelectedSkillDetail(null)}\n                className=\"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nSkillSelector.displayName = 'SkillSelector';\n\nexport default SkillSelector;\n",
        "last_modified": "2026-01-02T14:22:15.561490"
      },
      "task_intent": {
        "title": "Document Frontend React Components and Hooks",
        "description": "Add comprehensive JSDoc documentation to all React components and custom hooks in the frontend, including prop types, usage examples, component purposes, state management, and side effects.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:01:11.468677",
  "last_updated": "2026-01-02T14:22:15.010053"
}
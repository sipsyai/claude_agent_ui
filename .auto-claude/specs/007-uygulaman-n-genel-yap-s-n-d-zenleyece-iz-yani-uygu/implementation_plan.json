{
  "feature": "Workflow/Flow System Implementation",
  "description": "Implement a workflow/flow system for organizing agents and skills into reusable, schedulable processes with input/output handling. This transforms the application from a simple agent manager to a process automation tool where users can define workflows like 'Web Scraper' that take input, run agents with skills, and produce structured outputs.",
  "created_at": "2026-01-02T08:48:42.626Z",
  "updated_at": "2026-01-02T12:21:45.857Z",
  "status": "in_progress",
  "planStatus": "in_progress",
  "phases": [
    {
      "id": "phase-1",
      "name": "Core Flow Infrastructure",
      "description": "Define data models and API for Flow entity in Strapi backend",
      "status": "pending",
      "subtasks": [
        {
          "id": "1.1",
          "title": "Create Flow Content Type Schema",
          "description": "Define the Flow content type in Strapi with fields: name, slug, description, nodes (JSON), status, inputSchema, outputSchema, isActive",
          "status": "completed",
          "files": [
            "backend/src/api/flow/content-types/flow/schema.json"
          ],
          "notes": "Created Flow content type schema with all required fields (name, slug, description, nodes, status, inputSchema, outputSchema, isActive) plus additional utility fields (version, category, metadata). Also created controller, routes, and service files following existing Strapi patterns. Committed as d35cc9c.",
          "updated_at": "2026-01-02T08:56:32.586801+00:00"
        },
        {
          "id": "1.2",
          "title": "Create Flow Node Components",
          "description": "Define Strapi components for flow nodes: input-node, agent-node, output-node with their specific configurations",
          "status": "completed",
          "files": [
            "backend/src/components/flow/input-node.json",
            "backend/src/components/flow/agent-node.json",
            "backend/src/components/flow/output-node.json"
          ],
          "notes": "Created three flow node Strapi components: input-node.json (inputFields, validationRules, position, nextNodeId), agent-node.json (agent relation, promptTemplate, skills array, modelOverride, retry settings), output-node.json (outputType, format, saveToFile, webhook support). All components follow existing Strapi component patterns with proper collectionName conventions. Committed as d69d700.",
          "updated_at": "2026-01-02T09:00:03.610676+00:00"
        },
        {
          "id": "1.3",
          "title": "Create FlowExecution Content Type",
          "description": "Define content type for tracking flow execution history with status, logs, input, output, timing, and errors",
          "status": "completed",
          "files": [
            "backend/src/api/flow-execution/content-types/flow-execution/schema.json"
          ],
          "notes": "Created FlowExecution content type schema with comprehensive fields for tracking flow execution history: flow relation, status (pending/running/completed/failed/cancelled), input/output JSON, logs array, error/errorDetails, timing fields (startedAt, completedAt, executionTime), nodeExecutions array for tracking each node's state, currentNodeId, tokensUsed/cost, triggeredBy enum (manual/schedule/webhook/api), triggerData, retryCount/parentExecutionId for retry support, and metadata. Also created controller, routes, and service files with helper methods for execution lifecycle management (startExecution, addLog, updateNodeExecution, completeExecution, failExecution, cancelExecution, getFlowStats). Committed as 212aea4.",
          "updated_at": "2026-01-02T09:03:57.461051+00:00"
        },
        {
          "id": "1.4",
          "title": "Implement Flow API Controllers",
          "description": "Create Strapi controllers for Flow CRUD operations with custom routes",
          "status": "completed",
          "files": [
            "backend/src/api/flow/controllers/flow.ts",
            "backend/src/api/flow/routes/flow.ts",
            "backend/src/api/flow/services/flow.ts"
          ],
          "notes": "Created enhanced Flow API with comprehensive CRUD operations. Controller (flow.ts) includes 12 custom methods: findBySlug, findActive, toggleActive, updateStatus, duplicate, validate, findDetails, findByCategory, findRecent, activate, deactivate, archive. Custom routes file (custom.ts) exposes 12 REST endpoints for these operations. Service (flow.ts) enhanced with additional helper methods: duplicateFlow, generateSlug, getFlowSummaries, bumpVersion, search, getExecutableFlows, exportFlow, importFlow. All methods follow existing Strapi patterns from agent and skill APIs. Committed as 723e5ca.",
          "updated_at": "2026-01-02T09:08:53.472262+00:00"
        },
        {
          "id": "1.5",
          "title": "Implement FlowExecution API",
          "description": "Create controllers and routes for flow execution history management",
          "status": "completed",
          "files": [
            "backend/src/api/flow-execution/controllers/flow-execution.ts",
            "backend/src/api/flow-execution/routes/flow-execution.ts",
            "backend/src/api/flow-execution/services/flow-execution.ts"
          ],
          "notes": "Implemented comprehensive FlowExecution API with enhanced controller (17 custom methods: findByFlowId, findRunning, findRecent, findByStatus, findDetails, getStats, getGlobalStats, start, addLog, updateNode, complete, fail, cancel, retry, getLogs, cleanup), custom routes file exposing 17 REST endpoints for execution management, lifecycle control, and monitoring, and enhanced service with 18 methods including execution lifecycle (startExecution, completeExecution, failExecution, cancelExecution, retryExecution), statistics (getFlowStats, getGlobalStats), maintenance (cleanupOld), and utilities (getExecutionTimeline, getExecutionSummary). Committed as 88372b1.",
          "updated_at": "2026-01-02T09:14:10.648818+00:00"
        }
      ]
    },
    {
      "id": "phase-2",
      "name": "Flow Execution Engine",
      "description": "Implement the backend service for executing flows with agent integration",
      "status": "pending",
      "subtasks": [
        {
          "id": "2.1",
          "title": "Create Flow Types",
          "description": "Define TypeScript types for flows, nodes, execution context, and results",
          "status": "completed",
          "files": [
            "src/types/flow-types.ts"
          ],
          "notes": "Created comprehensive flow types in src/types/flow-types.ts with 600+ lines of TypeScript definitions. Types include: Flow (workflow definition), FlowNode discriminated union (InputNode, AgentNode, OutputNode), FlowExecution (execution tracking), FlowExecutionContext (runtime context), NodeExecution (node state), FlowExecutionResult, SSE update events, FlowStats, and utility types with type guards (isInputNode, isAgentNode, isOutputNode). Types align with Strapi schemas and follow existing patterns from agent.types.ts. Committed as 2c58f8e.",
          "updated_at": "2026-01-02T09:18:12.783179+00:00"
        },
        {
          "id": "2.2",
          "title": "Create Flow Execution Service",
          "description": "Implement the main flow runner service that orchestrates node execution, manages state, and handles errors",
          "status": "completed",
          "files": [
            "src/services/flow-execution-service.ts"
          ],
          "notes": "Created FlowExecutionService in src/services/flow-execution-service.ts with comprehensive flow orchestration capabilities. Key features:\n- EventEmitter-based for SSE updates\n- Node handler registration system for extensibility\n- Sequential node execution following flow graph\n- Execution context management with variable interpolation\n- Error handling with configurable retry support\n- Token usage and cost tracking\n- Real-time execution updates via events\n- Strapi integration for persistence\nAlso added flow and flow-execution CRUD methods to strapi-client.ts for data persistence.",
          "updated_at": "2026-01-02T09:22:47.268157+00:00"
        },
        {
          "id": "2.3",
          "title": "Implement Node Handlers",
          "description": "Create handlers for each node type: InputNodeHandler, AgentNodeHandler, OutputNodeHandler",
          "status": "completed",
          "files": [
            "src/services/flow-nodes/input-node-handler.ts",
            "src/services/flow-nodes/agent-node-handler.ts",
            "src/services/flow-nodes/output-node-handler.ts",
            "src/services/flow-nodes/index.ts"
          ],
          "notes": "Created three flow node handlers in src/services/flow-nodes/:\n\n- InputNodeHandler (input-node-handler.ts): Validates input data against field definitions with type coercion, pattern validation, min/max constraints, required field checks, and custom validation rules. Processes default values and transforms input for downstream nodes.\n\n- AgentNodeHandler (agent-node-handler.ts): Executes Claude agents within flow context. Features prompt template interpolation ({{variable}} syntax), model override selection (node override > agent default), skill loading from Strapi, integration with ClaudeSdkService, token usage tracking, and cost estimation per model.\n\n- OutputNodeHandler (output-node-handler.ts): Formats and delivers flow output. Supports 6 output formats (JSON, markdown, text, HTML, CSV, zip), 5 output types (response, file, database, webhook, email), transform templates, metadata inclusion, timestamp tracking, and webhook delivery with custom headers.\n\nAlso created index.ts with registerAllNodeHandlers() utility, nodeHandlers map, and helper functions. Committed as f3849bb.",
          "updated_at": "2026-01-02T09:29:32.869307+00:00"
        },
        {
          "id": "2.4",
          "title": "Integrate with Claude SDK Service",
          "description": "Connect agent node handler with existing ClaudeSdkService for agent execution within flows",
          "status": "completed",
          "files": [
            "src/services/flow-nodes/agent-node-handler.ts"
          ],
          "notes": "Connected AgentNodeHandler with ClaudeSdkService via FlowSdkService for agent execution within flows:\n\n- Created FlowSdkService (src/services/flow-sdk-service.ts): Singleton wrapper around ClaudeSdkService that provides:\n  - Proper initialization with MCP config path for skill/server discovery\n  - Event-based communication for collecting execution results\n  - Working directory configuration support\n  - Timeout handling and cleanup\n\n- Created flow-init.ts (src/services/flow-init.ts): Flow system initialization module that:\n  - Registers all node handlers with FlowExecutionService at startup\n  - Configures FlowSdkService with default working directory\n  - Sets up execution update event listeners for logging\n\n- Updated AgentNodeHandler (src/services/flow-nodes/agent-node-handler.ts):\n  - Integrated with FlowSdkService for SDK-based agent execution\n  - Added working directory support from flow/node metadata\n  - Added skill loading and filesystem sync before execution\n  - Added tool configuration merging from agent and skills\n  - Fixed TypeScript type issues with ToolName arrays\n\n- Updated server.ts: Added flow system initialization at server startup\n\nCommitted as 16d47a7.",
          "updated_at": "2026-01-02T12:31:13.098463+00:00"
        },
        {
          "id": "2.5",
          "title": "Add Express Routes for Flow Execution",
          "description": "Create REST API endpoints for starting, stopping, and monitoring flow executions with SSE support",
          "status": "completed",
          "files": [
            "src/routes/flow.routes.ts",
            "src/server.ts"
          ],
          "notes": "Created REST API endpoints for flow execution management with SSE support:\n\n**New Files:**\n- src/validators/flow.validators.ts: Zod validation schemas for flows and executions\n- src/routes/flow.routes.ts: Complete REST API with SSE streaming\n\n**Flow CRUD Endpoints:**\n- GET /api/flows - List all flows with filtering/pagination\n- GET /api/flows/:id - Get single flow\n- POST /api/flows - Create new flow\n- PUT /api/flows/:id - Update flow\n- DELETE /api/flows/:id - Delete flow\n\n**Flow Execution Endpoints:**\n- POST /api/flows/:id/execute - Start execution with SSE streaming\n- GET /api/flows/executions/running - List active executions\n- GET /api/flows/executions/:id - Get execution status\n- POST /api/flows/executions/:id/cancel - Cancel execution\n- GET /api/flows/executions/:id/stream - SSE stream for monitoring\n- GET /api/flows/:id/executions - List executions for a flow\n\n**Flow Status Management:**\n- POST /api/flows/:id/activate - Activate a flow\n- POST /api/flows/:id/deactivate - Deactivate a flow\n- POST /api/flows/:id/duplicate - Duplicate a flow\n\n**SSE Features:**\n- FlowSSEStream helper class for SSE connections\n- Keep-alive pings every 30 seconds\n- Real-time execution updates via flowExecutionService events\n- Automatic stream cleanup on client disconnect\n- Terminal state detection for stream closure",
          "updated_at": "2026-01-02T12:35:50.512616+00:00"
        },
        {
          "id": "2.6",
          "title": "Update Strapi Client for Flows",
          "description": "Add flow-related methods to the Strapi client service",
          "status": "completed",
          "files": [
            "src/services/strapi-client.ts"
          ],
          "notes": "Enhanced strapi-client.ts with comprehensive flow-related methods:\n\n**Flow CRUD (properly typed with Flow type):**\n- getAllFlows - List flows with filtering/sorting/pagination\n- getFlow - Get single flow by ID\n- getFlowBySlug - Get flow by URL-friendly slug\n- getActiveFlows - Get all active flows\n- getFlowsByCategory - Filter by FlowCategory\n- getFlowsByStatus - Filter by FlowStatus\n- createFlow - Create new flow with prepareFlowData\n- updateFlow - Update existing flow\n- deleteFlow - Remove flow\n- duplicateFlow - Clone flow with new name\n\n**FlowExecution CRUD (properly typed with FlowExecution type):**\n- getAllFlowExecutions - List executions with filtering\n- getFlowExecution - Get single execution\n- createFlowExecution - Create execution record (typed params)\n- updateFlowExecution - Update execution state (typed params)\n- deleteFlowExecution - Remove execution\n- getFlowExecutionsByFlowId - Get executions for a flow\n- getRunningFlowExecutions - Get active executions\n- getRecentFlowExecutions - Get N most recent executions\n- getFlowExecutionsByStatus - Filter by FlowExecutionStatus\n\n**Statistics & Maintenance:**\n- getFlowStats(flowId) - Returns FlowStats for a flow\n- getGlobalFlowStats() - Returns GlobalFlowStats aggregate\n- cleanupOldFlowExecutions(days) - Delete old completed/failed/cancelled records\n\n**Internal Methods:**\n- transformFlow - Properly typed transformation to Flow\n- transformFlowExecution - Properly typed transformation to FlowExecution\n- prepareFlowData - Prepare flow data for Strapi API\n\nAll methods properly typed with imports from flow-types.ts:\n- Flow, FlowExecution, FlowExecutionStatus, FlowTriggerType\n- FlowStatus, FlowCategory, FlowStats, GlobalFlowStats\n- FlowNode, FlowInputSchema, FlowOutputSchema\n- NodeExecution, FlowExecutionLog\n\nCommitted as 1a6e21b.",
          "updated_at": "2026-01-02T12:41:40.285803+00:00"
        }
      ]
    },
    {
      "id": "phase-3",
      "name": "Frontend Flow Builder",
      "description": "Implement the web UI for creating and managing flows",
      "status": "pending",
      "subtasks": [
        {
          "id": "3.1",
          "title": "Add Flow Types to Frontend",
          "description": "Define TypeScript types for flows in the frontend",
          "status": "completed",
          "files": [
            "src/web/manager/types.ts"
          ],
          "notes": "Added comprehensive frontend flow types to src/web/manager/types.ts:\n\n**Enums and Type Aliases:**\n- FlowStatus (draft/active/paused/archived)\n- FlowCategory (6 categories)\n- FlowExecutionStatus (pending/running/completed/failed/cancelled)\n- FlowTriggerType, FlowOutputType, FlowOutputFormat, FlowNodeType, InputFieldType\n\n**Node Types:**\n- FlowNodeBase (base interface with nodeId, type, name, position, nextNodeId)\n- InputNode (extends base with inputFields, validationRules)\n- AgentNode (extends base with agentId, promptTemplate, skills, timeout, retry settings)\n- OutputNode (extends base with outputType, format, file options, webhook support)\n- FlowNode (union type)\n\n**Flow & Execution Types:**\n- Flow (main workflow definition with nodes, status, schemas)\n- FlowExecution (execution tracking with logs, nodeExecutions, timing)\n- NodeExecution (individual node state tracking)\n- FlowExecutionUpdate (SSE real-time updates)\n- FlowStats, GlobalFlowStats (statistics interfaces)\n\n**Utilities:**\n- Type guards: isInputNode, isAgentNode, isOutputNode\n- FlowCreateInput, FlowUpdateInput helper types\n- Added 'Flows' to ManagerView enum\n\nTypes use frontend-friendly string types for dates (vs Date objects in backend types). Committed as 91b1fe1.",
          "updated_at": "2026-01-02T12:44:16.114407+00:00"
        },
        {
          "id": "3.2",
          "title": "Create Flow API Service",
          "description": "Implement frontend API client for flow operations",
          "status": "completed",
          "files": [
            "src/web/manager/services/flow-api.ts"
          ],
          "notes": "Created Flow API Service (src/web/manager/services/flow-api.ts) with comprehensive functionality:\n\n**Flow CRUD Operations:**\n- getFlows() - List flows with filtering, sorting, pagination\n- getFlow() - Get single flow by ID\n- createFlow() - Create new flow\n- updateFlow() - Update existing flow\n- deleteFlow() - Delete a flow\n\n**Flow Status Management:**\n- activateFlow() - Activate a flow (set isActive=true, status='active')\n- deactivateFlow() - Deactivate a flow (set isActive=false, status='paused')\n- duplicateFlow() - Duplicate a flow with optional new name\n\n**Flow Execution (SSE streaming):**\n- executeFlow() - Start flow execution with callback for SSE events\n- createFlowExecutionStream() - Create EventSource-like object for event listeners\n\n**Execution Monitoring:**\n- getFlowExecutions() - Get executions for a specific flow\n- getRunningExecutions() - Get all currently running executions\n- getExecution() - Get single execution by ID\n- cancelExecution() - Cancel a running execution\n- monitorExecution() - SSE stream to monitor specific execution\n\nFollows existing patterns from api.ts and chat-api.ts with auth token handling via cookies.",
          "updated_at": "2026-01-02T12:48:16.376434+00:00"
        },
        {
          "id": "3.3",
          "title": "Create Flow List Page",
          "description": "Implement the flows listing page with create, edit, delete, and execute actions",
          "status": "completed",
          "files": [
            "src/web/manager/components/FlowsPage.tsx"
          ],
          "notes": "Created FlowsPage.tsx (540 lines) with comprehensive flow management UI:\n\n**Features Implemented:**\n- Flow listing in responsive grid cards with status badges\n- Status filter (all/active/draft/paused/archived) with counts\n- Category filter (web-scraping, data-processing, api-integration, file-manipulation, automation, custom)\n- Search by name, description, or slug\n- Actions: Execute (with SSE), Edit, Activate/Deactivate, Duplicate, Delete\n- Recent execution history display with status indicators (running/completed/failed/cancelled/pending)\n- Auto-refresh toggle (30 seconds)\n- Loading and error states\n- Responsive design with Card, Button, Input, Icons components\n\n**Components Created:**\n- StatusBadge: Color-coded status display\n- CategoryBadge: Category display with emoji\n- ExecutionStatusIcon: Status-specific icons\n\n**Integration:**\n- Uses flow-api.ts service for all API calls\n- Types from types.ts (Flow, FlowStatus, FlowCategory, FlowExecution, etc.)\n- Follows SkillsPage.tsx patterns\n\nCommitted as 6bbaa52.",
          "updated_at": "2026-01-02T12:53:19.558994+00:00"
        },
        {
          "id": "3.4",
          "title": "Create Flow Editor Page",
          "description": "Build a simple flow editor with linear node configuration (no drag-drop, just step-by-step)",
          "status": "completed",
          "files": [
            "src/web/manager/components/FlowEditorPage.tsx"
          ],
          "notes": "Created FlowEditorPage.tsx (1100+ lines) with comprehensive flow editor functionality:\n\n**Features Implemented:**\n- Flow metadata form: name, slug (auto-generated), description, category, status, version, isActive toggle\n- Linear node editor with step-by-step collapsible sections:\n  - Input Node: Add/remove input fields with name, type, label, placeholder, required options\n  - Agent Node(s): Select agent, prompt template with {{input}} interpolation, skills selection, timeout/retry settings\n  - Output Node: Output type (response/file/webhook), format (JSON/markdown/text/HTML/CSV), file path, webhook URL, transform template\n- Visual flow indicator showing Input \u2192 Agent(s) \u2192 Output progression\n- Node ID generation and linking (nextNodeId chain)\n- Integration with flow-api.ts for CRUD (create/update)\n- Integration with api.ts for loading available agents and skills\n- Loading states, error handling, save/cancel buttons\n\n**Integration Updates:**\n- ManagerApp.tsx: Added flow editor state, handlers, and Flows view with FlowEditorPage\n- Sidebar.tsx: Added Flows menu item with PlayCircleIcon\n\nCommitted as 121920c.",
          "updated_at": "2026-01-02T13:01:05.268187+00:00"
        },
        {
          "id": "3.5",
          "title": "Create Node Configuration Components",
          "description": "Build configuration panels for each node type with proper form inputs",
          "status": "completed",
          "files": [
            "src/web/manager/components/flow/InputNodeConfig.tsx",
            "src/web/manager/components/flow/AgentNodeConfig.tsx",
            "src/web/manager/components/flow/OutputNodeConfig.tsx"
          ],
          "notes": "Created three reusable node configuration components in src/web/manager/components/flow/:\n\n- InputNodeConfig.tsx (270 lines): Configure input fields with comprehensive options including name, label, type (11 types: text, textarea, number, url, email, file, select, multiselect, checkbox, date, datetime), placeholder, description, default value, pattern validation, min/max constraints, and required flag. Includes InputFieldEditor sub-component for individual field editing with type-specific options.\n\n- AgentNodeConfig.tsx (210 lines): Configure agent nodes with agent selection dropdown, prompt template with {{input}} and {{previousResult}} interpolation, model override selection, skills selection with visual checkboxes, and execution settings (timeout, max retries, retry-on-error, max tokens).\n\n- OutputNodeConfig.tsx (265 lines): Configure output nodes with output type (response, file, database, webhook, email), format (JSON, markdown, text, HTML, CSV, zip), conditional file/webhook settings panels, metadata/timestamp options, and transform template.\n\n- index.ts: Barrel export for all components.\n\nUpdated FlowEditorPage.tsx to use these new modular components, reducing inline code by ~450 lines and improving maintainability. All components follow existing patterns and use shared UI components (Input, Select, Textarea, Button, Icons, KeyValueEditor).\n\nCommitted as 1fab088.",
          "updated_at": "2026-01-02T13:11:11.517112+00:00"
        },
        {
          "id": "3.6",
          "title": "Create Flow Execution Modal",
          "description": "Build modal for running flows with input form and real-time execution status",
          "status": "completed",
          "files": [
            "src/web/manager/components/FlowExecutionModal.tsx"
          ],
          "notes": "Created FlowExecutionModal.tsx (530+ lines) with comprehensive flow execution functionality:\n\n**Features Implemented:**\n- Dynamic input form generation based on flow's InputNode configuration\n- Supports 11 input field types: text, textarea, number, url, email, file, select, multiselect, checkbox, date, datetime\n- Client-side validation with required field checks, type-specific validation (email regex, URL parsing, number min/max), and pattern matching\n- Default value initialization from field definitions\n- Real-time execution status updates via SSE streaming\n\n**UI Layout:**\n- Split-panel modal with input form on left and execution log on right\n- Status indicator showing current execution state (idle, pending, running, completed, failed, cancelled)\n- Message display with color-coded types (status, node_started, node_completed, node_failed, result, error, log)\n- Collapsible details for viewing execution data\n- Result output display with JSON formatting\n\n**Integration:**\n- Uses flow-api.ts executeFlow() for SSE-based execution\n- Integrated into FlowsPage.tsx - clicking \"Run\" button opens the modal\n- Callbacks for execution completion to refresh execution history\n- Proper cleanup and state reset on modal open/close\n\nCommitted as part of subtask 3.6.",
          "updated_at": "2026-01-02T13:17:05.392402+00:00"
        },
        {
          "id": "3.7",
          "title": "Update Sidebar Navigation",
          "description": "Add Flows section to the sidebar navigation and update router",
          "status": "completed",
          "files": [
            "src/web/manager/components/layout/Sidebar.tsx",
            "src/web/manager/ManagerApp.tsx"
          ],
          "notes": "Verified that Flows section was already added to sidebar navigation and router in previous subtasks:\n\n**Sidebar Navigation (Sidebar.tsx):**\n- Line 32: `{ view: ManagerView.Flows, label: 'Flows', icon: PlayCircleIcon }` - Adds Flows menu item with play icon\n\n**Router Integration (ManagerApp.tsx):**\n- Imports FlowsPage and FlowEditorPage (lines 15-16)\n- Flow editor state: editingFlowId, isCreatingFlow (lines 38-41)\n- Flow handlers: handleEditFlow, handleCreateFlow, handleCloseFlowEditor, handleFlowSaved (lines 163-182)\n- FlowEditorPage rendering for edit/create mode (lines 207-215)\n- FlowsPage rendering for list view with edit/create callbacks (lines 232-238)\n\n**Types (types.ts):**\n- Line 27: `Flows = 'flows'` in ManagerView enum\n\nAll integration verified working - no TypeScript errors for Flow-related code. Implementation was completed during subtask 3.4.",
          "updated_at": "2026-01-02T13:20:52.694238+00:00"
        }
      ]
    },
    {
      "id": "phase-4",
      "name": "Scheduling & Triggers",
      "description": "Implement scheduling and trigger mechanisms for automated flow execution",
      "status": "pending",
      "subtasks": [
        {
          "id": "4.1",
          "title": "Add Schedule Fields to Flow Schema",
          "description": "Add schedule configuration fields to the Flow content type",
          "status": "completed",
          "files": [
            "backend/src/api/flow/content-types/flow/schema.json",
            "backend/src/components/flow/schedule.json"
          ],
          "notes": "Created comprehensive schedule configuration for Flow content type:\n\n**New Strapi Component (backend/src/components/flow/schedule.json):**\n- isEnabled: Boolean toggle for schedule activation\n- scheduleType: enum (once/cron/interval) for different scheduling modes\n- cronExpression: String for cron-based schedules (e.g., '0 9 * * 1-5')\n- intervalValue/intervalUnit: For interval-based scheduling\n- startDate/endDate: Schedule validity window\n- timezone: Timezone support (e.g., 'Europe/Istanbul')\n- nextRunAt/lastRunAt: Tracking fields for scheduler service\n- runCount/maxRuns: Execution limits\n- defaultInput: Default input values for scheduled runs\n- retryOnFailure/maxRetries/retryDelayMinutes: Retry configuration\n\n**Updated Flow Schema (backend/src/api/flow/content-types/flow/schema.json):**\n- Added schedule component field\n- Added webhookEnabled boolean for webhook trigger support\n- Added webhookSecret for webhook authentication\n\n**Updated TypeScript Types:**\n- flow-types.ts: FlowScheduleType, FlowIntervalUnit, FlowSchedule interface\n- frontend types.ts: Matching schedule types for frontend\n- strapi-client.ts: Updated transformFlow and prepareFlowData\n\nCommitted as 0659342.",
          "updated_at": "2026-01-02T13:27:40.562129+00:00"
        },
        {
          "id": "4.2",
          "title": "Implement Simple Scheduler Service",
          "description": "Create a basic scheduler service using setInterval for personal use",
          "status": "completed",
          "files": [
            "src/services/flow-scheduler-service.ts"
          ],
          "notes": "Created FlowSchedulerService (src/services/flow-scheduler-service.ts) with setInterval-based scheduling:\n\n- Checks for scheduled flows every minute (configurable CHECK_INTERVAL_MS)\n- Supports all three schedule types: 'once', 'cron', 'interval'\n- Basic cron expression parsing (minutes, hours, day of month, month, day of week) with support for wildcards (*), ranges (1-5), steps, and lists (1,3,5)\n- Interval-based scheduling (minutes, hours, days, weeks)\n- One-time execution scheduling\n- Automatic schedule updates after execution (lastRunAt, nextRunAt, runCount)\n- Prevents duplicate executions by tracking executing flows\n- Respects date ranges (startDate, endDate) and max runs (maxRuns)\n- Emits events for monitoring: 'started', 'stopped', 'flow-executing', 'flow-executed', 'flow-failed'\n\nUpdated flow-init.ts:\n- Imports and initializes flowSchedulerService at startup\n- Adds scheduler event listeners for logging\n- New option enableScheduler (default: true) to disable scheduler if needed\n- New exports: getFlowSchedulerService(), stopFlowScheduler()\n\nCommitted as 6d1e841.",
          "updated_at": "2026-01-02T13:34:02.807914+00:00"
        },
        {
          "id": "4.3",
          "title": "Add Webhook Trigger Support",
          "description": "Create webhook endpoint for triggering flows via HTTP requests",
          "status": "completed",
          "files": [
            "src/routes/webhook.routes.ts"
          ],
          "notes": "Created webhook routes (src/routes/webhook.routes.ts) with comprehensive webhook support:\n\n**Endpoints Created:**\n- POST /api/webhooks/flows/:identifier - Trigger flow via webhook (identifier can be flow ID or slug)\n- GET /api/webhooks/flows/:identifier/info - Get webhook configuration info\n- POST /api/webhooks/flows/:identifier/test - Test webhook without executing the flow\n- GET /api/webhooks/flows - List all webhook-enabled flows\n\n**Features:**\n- Authentication via X-Webhook-Secret header or Authorization: Bearer token\n- Supports both sync mode (waitForCompletion: true) and async mode (default)\n- Timeout configuration for sync mode (default: 60s, max: 5min)\n- Validates webhookEnabled and isActive flags before execution\n- Logs client IP, user agent, and request details in triggerData\n- Returns execution status URL for async requests\n- Comprehensive error handling with appropriate HTTP status codes\n\n**Validation:**\n- Zod schemas for request validation (webhookIdentifierSchema, webhookBodySchema)\n- Input validation, timeout limits, and required field checks\n\n**Integration:**\n- Registered in server.ts at /api/webhooks\n- Uses flowExecutionService for flow execution\n- Uses strapiClient for flow lookup (supports both ID and slug)",
          "updated_at": "2026-01-02T13:38:49.725706+00:00"
        },
        {
          "id": "4.4",
          "title": "Add Schedule UI to Flow Editor",
          "description": "Add scheduling configuration panel to the flow editor UI",
          "status": "completed",
          "files": [
            "src/web/manager/components/flow/FlowScheduleConfig.tsx",
            "src/web/manager/components/FlowEditorPage.tsx"
          ],
          "notes": "Created FlowScheduleConfig.tsx component (540+ lines) with comprehensive scheduling UI:\n\n**Features Implemented:**\n- Enable/disable schedule toggle with visual switch\n- Three schedule types: one-time, cron expression, interval\n- One-time scheduling: datetime picker with timezone\n- Cron scheduling: preset selection (hourly, daily, weekdays, weekly, monthly) plus custom cron expression input with syntax help\n- Interval scheduling: value + unit (minutes, hours, days, weeks) selection\n- Date range settings: start date, end date, max runs limit\n- Retry configuration: retry on failure toggle, max retries, retry delay\n- Default input values: JSON editor for scheduled execution inputs\n- Schedule status display: next run, last run, run count (read-only)\n- Common timezone presets (UTC, Europe/Istanbul, etc.)\n\n**FlowEditorPage.tsx Updates:**\n- Added Schedule & Triggers section with orange border\n- Added schedule state with FlowSchedule type\n- Added webhook enabled/secret state variables\n- Integrated FlowScheduleConfig component\n- Added webhook configuration UI with secret input\n- Displays webhook URL endpoint for existing flows\n- Schedule and webhook data included in save operation\n- Loads schedule/webhook data when editing existing flows\n\n**flow/index.ts Updates:**\n- Exported FlowScheduleConfig component and createDefaultSchedule utility\n- Exported FlowScheduleConfigProps type\n\nCommitted as fcf004d.",
          "updated_at": "2026-01-02T13:45:25.139821+00:00"
        }
      ]
    },
    {
      "id": "phase-5",
      "name": "Integration & Polish",
      "description": "Connect all components and add finishing touches",
      "status": "pending",
      "subtasks": [
        {
          "id": "5.1",
          "title": "Create Flow Execution History View",
          "description": "Add execution history tab to flow detail page with logs and results",
          "status": "completed",
          "files": [
            "src/web/manager/components/FlowHistoryTab.tsx"
          ],
          "notes": "Created FlowDetailPage component with tabs for Overview and Execution History. Added execution history with detailed logs, node executions, and results. Implemented expandable execution rows with input/output display. Added pagination support. Added EyeIcon and ListIcon. Updated ManagerApp.tsx and FlowsPage.tsx for navigation.",
          "updated_at": "2026-01-02T13:52:38.294748+00:00"
        },
        {
          "id": "5.2",
          "title": "Add Flow Stats to Dashboard",
          "description": "Update dashboard page with flow execution statistics and recent runs",
          "status": "pending",
          "files": [
            "src/web/manager/components/DashboardPage.tsx"
          ],
          "notes": ""
        },
        {
          "id": "5.3",
          "title": "Create Flow Templates",
          "description": "Create pre-built flow templates (e.g., Web Scraper, Data Processor) for quick start",
          "status": "pending",
          "files": [
            "src/services/flow-templates.ts"
          ],
          "notes": ""
        },
        {
          "id": "5.4",
          "title": "Add Error Handling",
          "description": "Implement comprehensive error handling with retry mechanism for failed nodes",
          "status": "pending",
          "files": [
            "src/services/flow-execution-service.ts"
          ],
          "notes": ""
        },
        {
          "id": "5.5",
          "title": "Integration Testing",
          "description": "Test flow creation and execution end-to-end",
          "status": "pending",
          "files": [],
          "notes": "Manual testing for personal use project"
        }
      ]
    }
  ],
  "qa_signoff": {
    "status": "pending",
    "tests_passed": "",
    "issues": ""
  },
  "context": {
    "existing_entities": [
      "Agent",
      "Skill",
      "Task",
      "MCP Server",
      "Chat Session"
    ],
    "tech_stack": {
      "backend": "Strapi 4 (PostgreSQL), Express.js",
      "frontend": "React 18, Vite, Tailwind CSS",
      "ai_integration": "Claude Agent SDK, Anthropic SDK"
    },
    "key_files": {
      "claude_sdk": "src/services/claude-sdk-service.ts",
      "strapi_client": "src/services/strapi-client.ts",
      "main_app": "src/web/manager/ManagerApp.tsx"
    },
    "design_principles": [
      "Simple implementation for personal use",
      "No production-grade security needed",
      "Focus on usability over scalability",
      "Leverage existing patterns in codebase"
    ]
  },
  "last_updated": "2026-01-02T13:52:38.294756+00:00"
}
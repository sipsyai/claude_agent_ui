{
  "file_path": "src/web/manager/components/CodeBlock.tsx",
  "main_branch_history": [],
  "task_views": {
    "004-document-frontend-react-components-and-hooks": {
      "task_id": "004-document-frontend-react-components-and-hooks",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "import React, { useState } from 'react';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { oneDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport { CheckIcon, ClipboardIcon } from './ui/Icons';\n\ninterface CodeBlockProps {\n  language?: string;\n  code: string;\n  showLineNumbers?: boolean;\n}\n\nconst CodeBlock: React.FC<CodeBlockProps> = ({\n  language = 'text',\n  code,\n  showLineNumbers = false\n}) => {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(code);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error('Failed to copy code:', err);\n    }\n  };\n\n  return (\n    <div className=\"relative my-4 rounded-lg overflow-hidden bg-gray-900 border border-gray-700\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700\">\n        <span className=\"text-xs font-medium text-gray-300 uppercase tracking-wider\">\n          {language}\n        </span>\n        <button\n          onClick={handleCopy}\n          className=\"flex items-center gap-1.5 px-2 py-1 text-xs text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors\"\n          title={copied ? 'Copied!' : 'Copy code'}\n        >\n          {copied ? (\n            <>\n              <CheckIcon className=\"w-4 h-4\" />\n              <span>Copied</span>\n            </>\n          ) : (\n            <>\n              <ClipboardIcon className=\"w-4 h-4\" />\n              <span>Copy</span>\n            </>\n          )}\n        </button>\n      </div>\n\n      {/* Code */}\n      <div className=\"overflow-x-auto\">\n        <SyntaxHighlighter\n          language={language}\n          style={oneDark}\n          showLineNumbers={showLineNumbers}\n          customStyle={{\n            margin: 0,\n            padding: '1rem',\n            background: 'transparent',\n            fontSize: '0.875rem',\n          }}\n          codeTagProps={{\n            style: {\n              fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace',\n            },\n          }}\n        >\n          {code}\n        </SyntaxHighlighter>\n      </div>\n    </div>\n  );\n};\n\nexport default CodeBlock;\n",
        "timestamp": "2026-01-02T14:22:14.293924"
      },
      "worktree_state": {
        "content": "/**\n * CodeBlock Component\n *\n * A syntax-highlighted code block component with copy-to-clipboard functionality and\n * language detection. Uses react-syntax-highlighter with Prism for rendering code with\n * proper syntax highlighting across multiple programming languages.\n *\n * ## Features\n * - Syntax highlighting for 100+ programming languages via Prism\n * - One-click copy-to-clipboard with visual feedback\n * - Language badge display in header\n * - Optional line numbers\n * - Dark theme styling (oneDark color scheme)\n * - Horizontal scrolling for long lines\n * - Monospace font family for code readability\n * - Header with language label and copy button\n *\n * ## Syntax Highlighting\n * The component uses `react-syntax-highlighter` with the Prism renderer and oneDark theme:\n *\n * **Supported Languages:**\n * - JavaScript, TypeScript, Python, Java, C++, C#, Go, Rust, Ruby, PHP\n * - HTML, CSS, SCSS, JSON, XML, YAML, Markdown\n * - SQL, Bash, Shell, PowerShell, Dockerfile\n * - And 80+ more languages supported by Prism\n *\n * **Language Detection:**\n * - Language is specified via the `language` prop\n * - Defaults to 'text' for plain text (no highlighting)\n * - Language name is displayed in uppercase in the header\n * - Case-insensitive language matching (e.g., 'javascript', 'JavaScript', 'JAVASCRIPT' all work)\n *\n * **Highlighting Engine:**\n * - Uses Prism syntax highlighter for accurate tokenization\n * - oneDark theme provides dark background with syntax colors\n * - Custom styling: transparent background, 1rem padding, 0.875rem font size\n * - Monospace font stack: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas\n *\n * ## Copy Functionality\n * The copy button allows users to copy the entire code block to their clipboard:\n *\n * **Copy Workflow:**\n * 1. User clicks the \"Copy\" button in the header\n * 2. Code is copied to clipboard using `navigator.clipboard.writeText()`\n * 3. Button icon changes from ClipboardIcon to CheckIcon\n * 4. Button text changes from \"Copy\" to \"Copied\"\n * 5. After 2 seconds, button reverts to original state\n *\n * **Visual Feedback:**\n * - Default state: ClipboardIcon with \"Copy\" text\n * - Copied state: CheckIcon with \"Copied\" text (green checkmark)\n * - Button tooltip: \"Copy code\" (default) or \"Copied!\" (after copy)\n * - Hover effect: text-white and bg-gray-700 on hover\n *\n * **Error Handling:**\n * - If clipboard API fails, logs error to console\n * - Clipboard API requires HTTPS or localhost\n * - Graceful degradation if clipboard access is denied\n *\n * ## Line Numbers\n * Optional line numbers can be displayed alongside code:\n *\n * **Behavior:**\n * - Controlled via `showLineNumbers` prop (default: false)\n * - Line numbers rendered by SyntaxHighlighter when enabled\n * - Numbers are right-aligned with padding\n * - Numbers inherit color from oneDark theme\n *\n * ## Styling Behavior\n * The component uses Tailwind CSS with a dark theme aesthetic:\n *\n * **Container:**\n * - Background: `bg-gray-900` (dark background for code area)\n * - Border: `border border-gray-700` (subtle gray border)\n * - Border radius: `rounded-lg` (8px rounded corners)\n * - Margin: `my-4` (1rem vertical spacing)\n * - Overflow: `overflow-hidden` (clips content to border radius)\n *\n * **Header:**\n * - Background: `bg-gray-800` (slightly lighter than code area)\n * - Border: `border-b border-gray-700` (separator from code)\n * - Padding: `px-4 py-2` (1rem horizontal, 0.5rem vertical)\n * - Layout: Flexbox with space-between for language label and copy button\n * - Language label: Uppercase, tracking-wider, text-xs, text-gray-300\n *\n * **Copy Button:**\n * - Default colors: `text-gray-300`\n * - Hover: `text-white`, `bg-gray-700`\n * - Padding: `px-2 py-1` (compact button)\n * - Border radius: `rounded`\n * - Transition: `transition-colors` for smooth hover effect\n * - Icon size: `w-4 h-4` (16x16px)\n * - Gap between icon and text: `gap-1.5`\n *\n * **Code Area:**\n * - Overflow: `overflow-x-auto` (horizontal scroll for long lines)\n * - Padding: 1rem (via SyntaxHighlighter customStyle)\n * - Font size: 0.875rem (14px, via SyntaxHighlighter customStyle)\n * - Font family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace\n * - Theme: oneDark color scheme for syntax highlighting\n *\n * @example\n * // Basic JavaScript code block\n * <CodeBlock\n *   language=\"javascript\"\n *   code={`function greet(name) {\n *   return \\`Hello, \\${name}!\\`;\n * }`}\n * />\n *\n * @example\n * // Python code with line numbers\n * <CodeBlock\n *   language=\"python\"\n *   code={`def factorial(n):\n *     if n <= 1:\n *         return 1\n *     return n * factorial(n - 1)`}\n *   showLineNumbers={true}\n * />\n *\n * @example\n * // TypeScript code block\n * <CodeBlock\n *   language=\"typescript\"\n *   code={`interface User {\n *   id: number;\n *   name: string;\n *   email: string;\n * }\n *\n * const user: User = {\n *   id: 1,\n *   name: \"Alice\",\n *   email: \"alice@example.com\"\n * };`}\n * />\n *\n * @example\n * // Plain text (no syntax highlighting)\n * <CodeBlock\n *   code=\"This is plain text without any syntax highlighting.\"\n * />\n *\n * @example\n * // SQL query with line numbers\n * <CodeBlock\n *   language=\"sql\"\n *   code={`SELECT users.name, COUNT(orders.id) as order_count\n * FROM users\n * LEFT JOIN orders ON users.id = orders.user_id\n * GROUP BY users.id\n * HAVING order_count > 5\n * ORDER BY order_count DESC;`}\n *   showLineNumbers={true}\n * />\n *\n * @example\n * // JSON configuration\n * <CodeBlock\n *   language=\"json\"\n *   code={`{\n *   \"name\": \"my-app\",\n *   \"version\": \"1.0.0\",\n *   \"dependencies\": {\n *     \"react\": \"^18.0.0\",\n *     \"typescript\": \"^5.0.0\"\n *   }\n * }`}\n * />\n */\n\nimport React, { useState } from 'react';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { oneDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport { CheckIcon, ClipboardIcon } from './ui/Icons';\n\n/**\n * Props for the CodeBlock component\n *\n * @interface CodeBlockProps\n * @property {string} [language='text'] - Programming language for syntax highlighting.\n *   Supports 100+ languages including: javascript, typescript, python, java, cpp, csharp,\n *   go, rust, ruby, php, html, css, json, xml, yaml, markdown, sql, bash, shell, and more.\n *   Defaults to 'text' for plain text without highlighting. Case-insensitive.\n *\n * @property {string} code - The code content to display. Can include newlines and special\n *   characters. Will be syntax highlighted based on the language prop. This is the raw code\n *   string that will be copied to clipboard when the copy button is clicked.\n *\n * @property {boolean} [showLineNumbers=false] - Whether to display line numbers alongside\n *   the code. Line numbers are right-aligned with padding and inherit colors from the\n *   oneDark theme. Useful for referencing specific lines in code reviews or documentation.\n */\ninterface CodeBlockProps {\n  language?: string;\n  code: string;\n  showLineNumbers?: boolean;\n}\n\nconst CodeBlock: React.FC<CodeBlockProps> = ({\n  language = 'text',\n  code,\n  showLineNumbers = false\n}) => {\n  const [copied, setCopied] = useState(false);\n\n  /**\n   * Handles copying code to clipboard with visual feedback\n   *\n   * Workflow:\n   * 1. Copies code string to clipboard using Clipboard API\n   * 2. Sets copied state to true (changes button to checkmark)\n   * 3. After 2 seconds, resets copied state back to false\n   * 4. If clipboard API fails (e.g., no HTTPS), logs error to console\n   *\n   * The Clipboard API requires a secure context (HTTPS or localhost).\n   * If the API is unavailable or denied, the error is logged but the UI\n   * remains functional (button just won't provide copy functionality).\n   *\n   * @internal\n   * @async\n   * @returns {Promise<void>}\n   */\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(code);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error('Failed to copy code:', err);\n    }\n  };\n\n  return (\n    <div className=\"relative my-4 rounded-lg overflow-hidden bg-gray-900 border border-gray-700\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700\">\n        <span className=\"text-xs font-medium text-gray-300 uppercase tracking-wider\">\n          {language}\n        </span>\n        <button\n          onClick={handleCopy}\n          className=\"flex items-center gap-1.5 px-2 py-1 text-xs text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors\"\n          title={copied ? 'Copied!' : 'Copy code'}\n        >\n          {copied ? (\n            <>\n              <CheckIcon className=\"w-4 h-4\" />\n              <span>Copied</span>\n            </>\n          ) : (\n            <>\n              <ClipboardIcon className=\"w-4 h-4\" />\n              <span>Copy</span>\n            </>\n          )}\n        </button>\n      </div>\n\n      {/* Code */}\n      <div className=\"overflow-x-auto\">\n        <SyntaxHighlighter\n          language={language}\n          style={oneDark}\n          showLineNumbers={showLineNumbers}\n          customStyle={{\n            margin: 0,\n            padding: '1rem',\n            background: 'transparent',\n            fontSize: '0.875rem',\n          }}\n          codeTagProps={{\n            style: {\n              fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace',\n            },\n          }}\n        >\n          {code}\n        </SyntaxHighlighter>\n      </div>\n    </div>\n  );\n};\n\nCodeBlock.displayName = 'CodeBlock';\n\nexport default CodeBlock;\n",
        "last_modified": "2026-01-02T15:11:36.277914"
      },
      "task_intent": {
        "title": "Document Frontend React Components and Hooks",
        "description": "Add comprehensive JSDoc documentation to all React components and custom hooks in the frontend, including prop types, usage examples, component purposes, state management, and side effects.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:01:11.069310",
  "last_updated": "2026-01-02T14:22:14.668976"
}
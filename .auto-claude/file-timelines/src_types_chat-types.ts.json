{
  "file_path": "src/types/chat-types.ts",
  "main_branch_history": [],
  "task_views": {
    "004-document-frontend-react-components-and-hooks": {
      "task_id": "004-document-frontend-react-components-and-hooks",
      "branch_point": {
        "commit_hash": "34a3f60da53773d90bd6579cb1cfd8417a1dd0b9",
        "content": "/**\n * Chat-related type definitions\n */\n\nexport interface ChatSession {\n  id: number;\n  documentId: string;\n  title: string;\n  status: 'active' | 'archived';\n  sessionId: string | null; // Claude SDK session ID for resuming\n  skills?: {\n    id: number;\n    documentId: string;\n    name: string;\n  }[];\n  agent?: {\n    id: number;\n    documentId: string;\n    name: string;\n    systemPrompt: string;\n    toolConfig?: {\n      allowedTools?: string[];\n      disallowedTools?: string[];\n    };\n    modelConfig?: {\n      model?: string;\n      temperature?: number;\n      maxTokens?: number;\n    };\n    mcpConfig?: any[];\n  };\n  customSystemPrompt?: string;\n  permissionMode: 'default' | 'bypass' | 'auto' | 'plan';\n  planMode?: boolean; // Legacy field, now part of permissionMode\n  createdAt: string;\n  updatedAt: string;\n  publishedAt?: string;\n}\n\nexport interface ChatMessage {\n  id: number;\n  documentId: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  attachments?: {\n    id: number;\n    documentId: string;\n    name: string;\n    url: string;\n    mime: string;\n    size: number;\n  }[];\n  metadata?: {\n    toolUses?: any[];\n    cost?: number;\n    usage?: {\n      input_tokens: number;\n      output_tokens: number;\n      cache_creation_input_tokens?: number;\n      cache_read_input_tokens?: number;\n    };\n    duration?: number;\n  };\n  timestamp: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface ChatAttachment {\n  file: File;\n  preview: string;\n  type: 'image' | 'pdf' | 'text';\n}\n\nexport interface CreateChatSessionRequest {\n  title: string;\n  skillIds: string[]; // Array of skill documentIds\n  agentId?: string; // Optional agent documentId\n  customSystemPrompt?: string; // Optional custom system prompt override\n  permissionMode?: 'default' | 'bypass' | 'auto' | 'plan';\n}\n\nexport interface CreateChatSessionResponse {\n  session: ChatSession;\n}\n\nexport interface SendMessageRequest {\n  sessionId: string;\n  message: string;\n  attachments?: {\n    name: string;\n    mimeType: string;\n    data: string; // base64\n  }[];\n  agentId?: string; // Optional agent override for this message\n  skillIds?: string[]; // Optional skills override for this message\n  permissionMode?: 'default' | 'bypass' | 'auto' | 'plan';\n}\n\n// Streaming event types for real-time chat updates\n\n/**\n * Event sent when assistant message starts streaming\n */\nexport interface AssistantMessageStartEvent {\n  type: 'assistant_message_start';\n  messageId: string;\n  timestamp: string;\n}\n\n/**\n * Event sent for each text chunk during streaming\n */\nexport interface AssistantMessageDeltaEvent {\n  type: 'assistant_message_delta';\n  delta: string;\n  messageId: string;\n  timestamp: string;\n}\n\n/**\n * Event sent when assistant message is complete\n */\nexport interface AssistantMessageCompleteEvent {\n  type: 'assistant_message_complete';\n  messageId: string;\n  content: string;\n  timestamp: string;\n  metadata?: {\n    toolUses?: any[];\n    cost?: number;\n    usage?: {\n      input_tokens: number;\n      output_tokens: number;\n      cache_creation_input_tokens?: number;\n      cache_read_input_tokens?: number;\n    };\n    duration?: number;\n  };\n}\n\n/**\n * Raw SDK message event (for debugging and tool tracking)\n */\nexport interface SdkMessageEvent {\n  type: 'sdk_message';\n  data: any;\n}\n\n/**\n * Error event\n */\nexport interface ErrorEvent {\n  type: 'error';\n  error: string;\n  timestamp: string;\n}\n\n/**\n * Result event (final completion)\n */\nexport interface ResultEvent {\n  type: 'result';\n  result: any;\n  timestamp: string;\n}\n\n/**\n * Stream ID event (sent at start to enable cancellation)\n */\nexport interface StreamIdEvent {\n  type: 'stream_id';\n  streamId: string;\n  timestamp: string;\n}\n\n/**\n * Cancelled event (sent when stream is cancelled)\n */\nexport interface CancelledEvent {\n  type: 'cancelled';\n  streamId: string;\n  timestamp: string;\n  reason?: string;\n}\n\n/**\n * Union type of all possible stream events\n */\nexport type ChatStreamMessage =\n  | StreamIdEvent\n  | AssistantMessageStartEvent\n  | AssistantMessageDeltaEvent\n  | AssistantMessageCompleteEvent\n  | SdkMessageEvent\n  | ErrorEvent\n  | ResultEvent\n  | CancelledEvent;\n\nexport interface GetChatMessagesResponse {\n  messages: ChatMessage[];\n  session: ChatSession;\n}\n\nexport interface GetChatSessionsResponse {\n  sessions: ChatSession[];\n}\n",
        "timestamp": "2026-01-02T14:22:14.293924"
      },
      "worktree_state": {
        "content": "/**\n * Chat-related type definitions\n */\n\n/**\n * Chat session from Strapi\n *\n * Represents a persistent chat conversation with associated\n * skills, agent, and configuration.\n */\nexport interface ChatSession {\n  /** Strapi numeric ID */\n  id: number;\n\n  /** Strapi document ID (UUID) */\n  documentId: string;\n\n  /** Session title */\n  title: string;\n\n  /** Session status */\n  status: 'active' | 'archived';\n\n  /** Claude SDK session ID for resuming (null if new) */\n  sessionId: string | null;\n\n  /** Associated skills */\n  skills?: {\n    id: number;\n    documentId: string;\n    name: string;\n  }[];\n\n  /** Associated agent with configuration */\n  agent?: {\n    id: number;\n    documentId: string;\n    name: string;\n    systemPrompt: string;\n    toolConfig?: {\n      allowedTools?: string[];\n      disallowedTools?: string[];\n    };\n    modelConfig?: {\n      model?: string;\n      temperature?: number;\n      maxTokens?: number;\n    };\n    mcpConfig?: any[];\n  };\n\n  /** Optional custom system prompt override */\n  customSystemPrompt?: string;\n\n  /** Permission mode for tool execution */\n  permissionMode: 'default' | 'bypass' | 'auto' | 'plan';\n\n  /** Legacy field, now part of permissionMode */\n  planMode?: boolean;\n\n  /** ISO timestamp when created */\n  createdAt: string;\n\n  /** ISO timestamp when last updated */\n  updatedAt: string;\n\n  /** ISO timestamp when published (Strapi field) */\n  publishedAt?: string;\n}\n\n/**\n * Chat message from Strapi\n *\n * Represents a single message in a chat session with\n * attachments, metadata, and token usage.\n */\nexport interface ChatMessage {\n  /** Strapi numeric ID */\n  id: number;\n\n  /** Strapi document ID (UUID) */\n  documentId: string;\n\n  /** Message role */\n  role: 'user' | 'assistant' | 'system';\n\n  /** Message content */\n  content: string;\n\n  /** File attachments */\n  attachments?: {\n    id: number;\n    documentId: string;\n    name: string;\n    url: string;\n    mime: string;\n    size: number;\n  }[];\n\n  /** Message metadata (tools, usage, cost) */\n  metadata?: {\n    /** Tool uses in this message */\n    toolUses?: any[];\n\n    /** Estimated cost in USD */\n    cost?: number;\n\n    /** Token usage */\n    usage?: {\n      input_tokens: number;\n      output_tokens: number;\n      cache_creation_input_tokens?: number;\n      cache_read_input_tokens?: number;\n    };\n\n    /** Execution duration in milliseconds */\n    duration?: number;\n  };\n\n  /** ISO timestamp for the message */\n  timestamp: string;\n\n  /** ISO timestamp when created */\n  createdAt: string;\n\n  /** ISO timestamp when last updated */\n  updatedAt: string;\n}\n\n/**\n * Chat attachment (client-side)\n *\n * File attachment before upload to Strapi.\n */\nexport interface ChatAttachment {\n  /** File object */\n  file: File;\n\n  /** Object URL for preview */\n  preview: string;\n\n  /** Categorized file type */\n  type: 'image' | 'pdf' | 'text';\n}\n\n/**\n * Create chat session request\n *\n * Request body for creating a new chat session.\n */\nexport interface CreateChatSessionRequest {\n  /** Session title */\n  title: string;\n\n  /** Array of skill documentIds */\n  skillIds: string[];\n\n  /** Optional agent documentId */\n  agentId?: string;\n\n  /** Optional custom system prompt override */\n  customSystemPrompt?: string;\n\n  /** Permission mode for tool execution */\n  permissionMode?: 'default' | 'bypass' | 'auto' | 'plan';\n}\n\n/**\n * Create chat session response\n *\n * Response containing the newly created session.\n */\nexport interface CreateChatSessionResponse {\n  /** Created chat session */\n  session: ChatSession;\n}\n\n/**\n * Send message request\n *\n * Request body for sending a message in a chat session.\n */\nexport interface SendMessageRequest {\n  /** Session document ID */\n  sessionId: string;\n\n  /** Message text */\n  message: string;\n\n  /** File attachments (base64 encoded) */\n  attachments?: {\n    name: string;\n    mimeType: string;\n    data: string; // base64\n  }[];\n\n  /** Optional agent override for this message */\n  agentId?: string;\n\n  /** Optional skills override for this message */\n  skillIds?: string[];\n\n  /** Optional permission mode override */\n  permissionMode?: 'default' | 'bypass' | 'auto' | 'plan';\n}\n\n// Streaming event types for real-time chat updates\n\n/**\n * Event sent when assistant message starts streaming\n */\nexport interface AssistantMessageStartEvent {\n  type: 'assistant_message_start';\n  messageId: string;\n  timestamp: string;\n}\n\n/**\n * Event sent for each text chunk during streaming\n */\nexport interface AssistantMessageDeltaEvent {\n  type: 'assistant_message_delta';\n  delta: string;\n  messageId: string;\n  timestamp: string;\n}\n\n/**\n * Event sent when assistant message is complete\n */\nexport interface AssistantMessageCompleteEvent {\n  type: 'assistant_message_complete';\n  messageId: string;\n  content: string;\n  timestamp: string;\n  metadata?: {\n    toolUses?: any[];\n    cost?: number;\n    usage?: {\n      input_tokens: number;\n      output_tokens: number;\n      cache_creation_input_tokens?: number;\n      cache_read_input_tokens?: number;\n    };\n    duration?: number;\n  };\n}\n\n/**\n * Raw SDK message event (for debugging and tool tracking)\n */\nexport interface SdkMessageEvent {\n  type: 'sdk_message';\n  data: any;\n}\n\n/**\n * Error event\n */\nexport interface ErrorEvent {\n  type: 'error';\n  error: string;\n  timestamp: string;\n}\n\n/**\n * Result event (final completion)\n */\nexport interface ResultEvent {\n  type: 'result';\n  result: any;\n  timestamp: string;\n}\n\n/**\n * Stream ID event (sent at start to enable cancellation)\n */\nexport interface StreamIdEvent {\n  type: 'stream_id';\n  streamId: string;\n  timestamp: string;\n}\n\n/**\n * Cancelled event (sent when stream is cancelled)\n */\nexport interface CancelledEvent {\n  type: 'cancelled';\n  streamId: string;\n  timestamp: string;\n  reason?: string;\n}\n\n/**\n * Union type of all possible stream events\n */\nexport type ChatStreamMessage =\n  | StreamIdEvent\n  | AssistantMessageStartEvent\n  | AssistantMessageDeltaEvent\n  | AssistantMessageCompleteEvent\n  | SdkMessageEvent\n  | ErrorEvent\n  | ResultEvent\n  | CancelledEvent;\n\n/**\n * Get chat messages response\n *\n * Response containing messages and session details.\n */\nexport interface GetChatMessagesResponse {\n  /** Array of chat messages */\n  messages: ChatMessage[];\n\n  /** Chat session details */\n  session: ChatSession;\n}\n\n/**\n * Get chat sessions response\n *\n * Response containing list of chat sessions.\n */\nexport interface GetChatSessionsResponse {\n  /** Array of chat sessions */\n  sessions: ChatSession[];\n}\n",
        "last_modified": "2026-01-02T15:11:36.269295"
      },
      "task_intent": {
        "title": "Document Frontend React Components and Hooks",
        "description": "Add comprehensive JSDoc documentation to all React components and custom hooks in the frontend, including prop types, usage examples, component purposes, state management, and side effects.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T14:01:10.636108",
  "last_updated": "2026-01-02T14:22:14.429202"
}
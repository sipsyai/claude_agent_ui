{
  "file_path": "src/web/manager/types.ts",
  "main_branch_history": [],
  "task_views": {
    "007-uygulaman-n-genel-yap-s-n-d-zenleyece-iz-yani-uygu": {
      "task_id": "007-uygulaman-n-genel-yap-s-n-d-zenleyece-iz-yani-uygu",
      "branch_point": {
        "commit_hash": "9355e1f79162ecd7611ae3213457e87085b7fe4d",
        "content": "export type AgentInputType = 'text' | 'textarea' | 'select' | 'file' | 'number';\n\nexport interface AgentInput {\n  name: string;\n  description: string;\n  type: AgentInputType;\n  required: boolean;\n  defaultValue?: any;\n  options?: string[];\n}\n\nexport interface Agent {\n  id: string;\n  name: string;\n  description: string;\n  inputs: AgentInput[];\n}\n\nexport enum ManagerView {\n    Dashboard = 'dashboard',\n    Chat = 'chat',  // \u2190 BU SATIRI EKLEY\u0130N\n    Agents = 'agents',\n    Commands = 'commands',\n    Skills = 'skills',\n    MCPServers = 'mcp-servers',\n    Tasks = 'tasks',\n    Settings = 'settings',\n}\n\n/**\n * MCP Server configuration for stdio transport\n */\nexport interface MCPStdioServerConfig {\n  type?: 'stdio';\n  command: string;\n  args?: string[];\n  env?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for SDK transport\n */\nexport interface MCPSdkServerConfig {\n  type: 'sdk';\n  name: string;\n  instance?: any;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for SSE transport\n */\nexport interface MCPSSEServerConfig {\n  type: 'sse';\n  url: string;\n  headers?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for HTTP transport\n */\nexport interface MCPHttpServerConfig {\n  type: 'http';\n  url: string;\n  headers?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * Union type for all MCP server configurations\n */\nexport type MCPServerConfig =\n  | MCPStdioServerConfig\n  | MCPSdkServerConfig\n  | MCPSSEServerConfig\n  | MCPHttpServerConfig;\n\n/**\n * MCP Tool definition (Strapi entity)\n */\nexport interface MCPTool {\n  id: string;\n  name: string;\n  description?: string;\n  inputSchema?: Record<string, unknown>;\n  mcpServer?: string; // Server ID\n  createdAt?: Date | string;\n  updatedAt?: Date | string;\n}\n\n/**\n * MCP Server representation with metadata\n */\nexport interface MCPServer {\n  id: string;\n  name: string;\n  type: 'stdio' | 'sdk' | 'sse' | 'http';\n  config: MCPServerConfig;\n  disabled?: boolean;\n  mcpTools?: MCPTool[];\n  toolsFetchedAt?: Date | string;\n  command?: string;\n  description?: string;\n}\n\n/**\n * Validation step for project setup\n */\nexport interface ValidationStep {\n  id: string;\n  label: string;\n  status: 'pending' | 'loading' | 'success' | 'error';\n  error?: string;\n}\n",
        "timestamp": "2026-01-02T15:21:46.864601"
      },
      "worktree_state": {
        "content": "export type AgentInputType = 'text' | 'textarea' | 'select' | 'file' | 'number';\n\nexport interface AgentInput {\n  name: string;\n  description: string;\n  type: AgentInputType;\n  required: boolean;\n  defaultValue?: any;\n  options?: string[];\n}\n\nexport interface Agent {\n  id: string;\n  name: string;\n  description: string;\n  inputs: AgentInput[];\n}\n\nexport enum ManagerView {\n    Dashboard = 'dashboard',\n    Chat = 'chat',\n    Agents = 'agents',\n    Commands = 'commands',\n    Skills = 'skills',\n    MCPServers = 'mcp-servers',\n    Tasks = 'tasks',\n    Flows = 'flows',\n    Settings = 'settings',\n}\n\n/**\n * MCP Server configuration for stdio transport\n */\nexport interface MCPStdioServerConfig {\n  type?: 'stdio';\n  command: string;\n  args?: string[];\n  env?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for SDK transport\n */\nexport interface MCPSdkServerConfig {\n  type: 'sdk';\n  name: string;\n  instance?: any;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for SSE transport\n */\nexport interface MCPSSEServerConfig {\n  type: 'sse';\n  url: string;\n  headers?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * MCP Server configuration for HTTP transport\n */\nexport interface MCPHttpServerConfig {\n  type: 'http';\n  url: string;\n  headers?: Record<string, string>;\n  disabled?: boolean;\n}\n\n/**\n * Union type for all MCP server configurations\n */\nexport type MCPServerConfig =\n  | MCPStdioServerConfig\n  | MCPSdkServerConfig\n  | MCPSSEServerConfig\n  | MCPHttpServerConfig;\n\n/**\n * MCP Tool definition (Strapi entity)\n */\nexport interface MCPTool {\n  id: string;\n  name: string;\n  description?: string;\n  inputSchema?: Record<string, unknown>;\n  mcpServer?: string; // Server ID\n  createdAt?: Date | string;\n  updatedAt?: Date | string;\n}\n\n/**\n * MCP Server representation with metadata\n */\nexport interface MCPServer {\n  id: string;\n  name: string;\n  type: 'stdio' | 'sdk' | 'sse' | 'http';\n  config: MCPServerConfig;\n  disabled?: boolean;\n  mcpTools?: MCPTool[];\n  toolsFetchedAt?: Date | string;\n  command?: string;\n  description?: string;\n}\n\n/**\n * Validation step for project setup\n */\nexport interface ValidationStep {\n  id: string;\n  label: string;\n  status: 'pending' | 'loading' | 'success' | 'error';\n  error?: string;\n}\n\n// =============================================================================\n// FLOW TYPES\n// =============================================================================\n\n/**\n * Flow lifecycle status\n */\nexport type FlowStatus = 'draft' | 'active' | 'paused' | 'archived';\n\n/**\n * Flow category for organization\n */\nexport type FlowCategory =\n  | 'web-scraping'\n  | 'data-processing'\n  | 'api-integration'\n  | 'file-manipulation'\n  | 'automation'\n  | 'custom';\n\n/**\n * Flow execution status\n */\nexport type FlowExecutionStatus =\n  | 'pending'\n  | 'running'\n  | 'completed'\n  | 'failed'\n  | 'cancelled';\n\n/**\n * How the flow execution was triggered\n */\nexport type FlowTriggerType = 'manual' | 'schedule' | 'webhook' | 'api';\n\n/**\n * Output delivery type\n */\nexport type FlowOutputType = 'response' | 'file' | 'database' | 'webhook' | 'email';\n\n/**\n * Output format type\n */\nexport type FlowOutputFormat = 'json' | 'markdown' | 'text' | 'html' | 'csv' | 'zip';\n\n/**\n * Node type discriminator\n */\nexport type FlowNodeType = 'input' | 'agent' | 'output';\n\n/**\n * Schedule type for flow scheduling\n */\nexport type FlowScheduleType = 'once' | 'cron' | 'interval';\n\n/**\n * Interval unit for interval-based scheduling\n */\nexport type FlowIntervalUnit = 'minutes' | 'hours' | 'days' | 'weeks';\n\n/**\n * Input field type for flow input nodes\n */\nexport type InputFieldType =\n  | 'text'\n  | 'textarea'\n  | 'number'\n  | 'url'\n  | 'email'\n  | 'file'\n  | 'select'\n  | 'multiselect'\n  | 'checkbox'\n  | 'date'\n  | 'datetime';\n\n/**\n * Input field definition for flow input nodes\n */\nexport interface FlowInputField {\n  name: string;\n  type: InputFieldType;\n  label: string;\n  required: boolean;\n  description?: string;\n  placeholder?: string;\n  defaultValue?: any;\n  options?: string[];\n  pattern?: string;\n  min?: number;\n  max?: number;\n}\n\n/**\n * UI position coordinates for node rendering\n */\nexport interface NodePosition {\n  x: number;\n  y: number;\n}\n\n/**\n * Base interface for all flow nodes\n */\nexport interface FlowNodeBase {\n  nodeId: string;\n  type: FlowNodeType;\n  name: string;\n  description?: string;\n  position: NodePosition;\n  nextNodeId?: string | null;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Input node for defining flow inputs\n */\nexport interface InputNode extends FlowNodeBase {\n  type: 'input';\n  inputFields: FlowInputField[];\n  validationRules?: Record<string, any>;\n}\n\n/**\n * Agent node for executing an agent with configured skills\n */\nexport interface AgentNode extends FlowNodeBase {\n  type: 'agent';\n  agentId: string;\n  agent?: Agent;\n  promptTemplate: string;\n  skills: string[];\n  modelOverride: 'default' | string;\n  maxTokens?: number;\n  timeout: number;\n  retryOnError: boolean;\n  maxRetries: number;\n}\n\n/**\n * Output node for defining how results are delivered\n */\nexport interface OutputNode extends FlowNodeBase {\n  type: 'output';\n  outputType: FlowOutputType;\n  format: FlowOutputFormat;\n  saveToFile: boolean;\n  filePath?: string;\n  fileName?: string;\n  includeMetadata: boolean;\n  includeTimestamp: boolean;\n  transformTemplate?: string;\n  webhookUrl?: string;\n  webhookHeaders?: Record<string, string>;\n}\n\n/**\n * Union type for all flow node types\n */\nexport type FlowNode = InputNode | AgentNode | OutputNode;\n\n/**\n * Input schema definition for flow validation\n */\nexport interface FlowInputSchema {\n  properties: Record<string, {\n    type: string;\n    description?: string;\n    default?: any;\n    enum?: any[];\n  }>;\n  required?: string[];\n}\n\n/**\n * Output schema definition for flow results\n */\nexport interface FlowOutputSchema {\n  properties: Record<string, {\n    type: string;\n    description?: string;\n  }>;\n}\n\n/**\n * Schedule configuration for automated flow execution\n */\nexport interface FlowSchedule {\n  /** Whether the schedule is currently active */\n  isEnabled: boolean;\n  /** Type of schedule */\n  scheduleType: FlowScheduleType;\n  /** Cron expression for cron-based scheduling (e.g., '0 9 * * 1-5' for weekdays at 9am) */\n  cronExpression?: string;\n  /** Interval value for interval-based scheduling */\n  intervalValue: number;\n  /** Unit for interval-based scheduling */\n  intervalUnit: FlowIntervalUnit;\n  /** When the schedule becomes active */\n  startDate?: string;\n  /** When the schedule expires */\n  endDate?: string;\n  /** Timezone for the schedule (e.g., 'America/New_York', 'Europe/Istanbul') */\n  timezone: string;\n  /** Calculated next run time (managed by scheduler service) */\n  nextRunAt?: string;\n  /** Last time the flow was executed by this schedule */\n  lastRunAt?: string;\n  /** Number of times this schedule has triggered an execution */\n  runCount: number;\n  /** Maximum number of runs (optional, unlimited if not set) */\n  maxRuns?: number;\n  /** Default input values to use when the schedule triggers */\n  defaultInput: Record<string, any>;\n  /** Whether to retry if the scheduled execution fails */\n  retryOnFailure: boolean;\n  /** Maximum number of retry attempts on failure */\n  maxRetries: number;\n  /** Delay in minutes between retry attempts */\n  retryDelayMinutes: number;\n}\n\n/**\n * Core Flow interface representing a workflow definition\n */\nexport interface Flow {\n  id: string;\n  name: string;\n  slug: string;\n  description?: string;\n  nodes: FlowNode[];\n  status: FlowStatus;\n  inputSchema: FlowInputSchema;\n  outputSchema: FlowOutputSchema;\n  isActive: boolean;\n  version: string;\n  category: FlowCategory;\n  metadata?: Record<string, any>;\n  /** Schedule configuration for automated execution */\n  schedule?: FlowSchedule;\n  /** Whether webhook triggering is enabled for this flow */\n  webhookEnabled: boolean;\n  /** Secret token for authenticating webhook requests */\n  webhookSecret?: string;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Log level for execution logs\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n/**\n * Execution log entry\n */\nexport interface FlowExecutionLog {\n  timestamp: string;\n  level: LogLevel;\n  message: string;\n  nodeId?: string;\n  data?: Record<string, any>;\n}\n\n/**\n * Status of individual node execution\n */\nexport type NodeExecutionStatus = 'pending' | 'running' | 'completed' | 'failed' | 'skipped';\n\n/**\n * Error category for classification\n */\nexport type ErrorCategory = 'transient' | 'permanent' | 'unknown';\n\n/**\n * Detailed error information with classification\n */\nexport interface FlowError {\n  message: string;\n  code?: string;\n  statusCode?: number;\n  category: ErrorCategory;\n  isRetryable: boolean;\n  timestamp: string;\n}\n\n/**\n * Retry attempt information\n */\nexport interface RetryAttempt {\n  attemptNumber: number;\n  startedAt: string;\n  completedAt?: string;\n  delayMs: number;\n  error?: string;\n  success: boolean;\n}\n\n/**\n * Retry state tracking for a node\n */\nexport interface NodeRetryState {\n  retryCount: number;\n  maxRetries: number;\n  attempts: RetryAttempt[];\n  lastError?: FlowError;\n  isWaitingForRetry: boolean;\n  nextRetryAt?: string;\n  totalRetryTime: number;\n}\n\n/**\n * Tracks execution state of a single node\n */\nexport interface NodeExecution {\n  nodeId: string;\n  nodeType: FlowNodeType;\n  status: NodeExecutionStatus;\n  startedAt?: string;\n  completedAt?: string;\n  executionTime?: number;\n  input?: Record<string, any>;\n  output?: Record<string, any>;\n  error?: string;\n  errorDetails?: Record<string, any>;\n  flowError?: FlowError;\n  tokensUsed?: number;\n  cost?: number;\n  retryCount?: number;\n  retryState?: NodeRetryState;\n  wasSkipped?: boolean;\n  defaultValueUsed?: any;\n}\n\n/**\n * Flow execution record tracking a single run of a flow\n */\nexport interface FlowExecution {\n  id: string;\n  flowId: string;\n  flow?: Flow;\n  status: FlowExecutionStatus;\n  input?: Record<string, any>;\n  output?: Record<string, any>;\n  logs: FlowExecutionLog[];\n  error?: string;\n  errorDetails?: Record<string, any>;\n  startedAt?: string;\n  completedAt?: string;\n  executionTime?: number;\n  nodeExecutions: NodeExecution[];\n  currentNodeId?: string;\n  tokensUsed: number;\n  cost: number;\n  triggeredBy: FlowTriggerType;\n  triggerData?: Record<string, any>;\n  retryCount: number;\n  parentExecutionId?: string;\n  metadata?: Record<string, any>;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * SSE update type for real-time execution monitoring\n */\nexport type FlowExecutionUpdateType =\n  | 'execution_started'\n  | 'execution_completed'\n  | 'execution_failed'\n  | 'execution_cancelled'\n  | 'node_started'\n  | 'node_completed'\n  | 'node_failed'\n  | 'node_retrying'\n  | 'log';\n\n/**\n * SSE update event for real-time execution monitoring\n */\nexport interface FlowExecutionUpdate {\n  type: FlowExecutionUpdateType;\n  executionId: string;\n  timestamp: string;\n  nodeId?: string;\n  nodeType?: FlowNodeType;\n  data?: {\n    status?: FlowExecutionStatus | NodeExecutionStatus;\n    output?: Record<string, any>;\n    error?: string;\n    errorCategory?: ErrorCategory;\n    log?: FlowExecutionLog;\n    tokensUsed?: number;\n    cost?: number;\n    executionTime?: number;\n    /** Retry-specific data */\n    retryCount?: number;\n    maxRetries?: number;\n    nextRetryIn?: number;\n    retryReason?: string;\n    isRetryable?: boolean;\n  };\n}\n\n/**\n * Request to start a flow execution\n */\nexport interface StartFlowExecutionRequest {\n  flowId: string;\n  input: Record<string, any>;\n  triggeredBy?: FlowTriggerType;\n  triggerData?: Record<string, any>;\n  waitForCompletion?: boolean;\n}\n\n/**\n * Statistics for a single flow\n */\nexport interface FlowStats {\n  flowId: string;\n  totalExecutions: number;\n  successCount: number;\n  failedCount: number;\n  cancelledCount: number;\n  successRate: number;\n  averageExecutionTime: number;\n  totalTokensUsed: number;\n  totalCost: number;\n  lastExecutedAt?: string;\n}\n\n/**\n * Global statistics across all flows\n */\nexport interface GlobalFlowStats {\n  totalFlows: number;\n  activeFlows: number;\n  totalExecutions: number;\n  runningExecutions: number;\n  successCount: number;\n  failedCount: number;\n  successRate: number;\n  totalTokensUsed: number;\n  totalCost: number;\n}\n\n/**\n * Type guard to check if a node is an InputNode\n */\nexport function isInputNode(node: FlowNode): node is InputNode {\n  return node.type === 'input';\n}\n\n/**\n * Type guard to check if a node is an AgentNode\n */\nexport function isAgentNode(node: FlowNode): node is AgentNode {\n  return node.type === 'agent';\n}\n\n/**\n * Type guard to check if a node is an OutputNode\n */\nexport function isOutputNode(node: FlowNode): node is OutputNode {\n  return node.type === 'output';\n}\n\n/**\n * Partial flow for creation operations\n */\nexport type FlowCreateInput = Omit<Flow, 'id' | 'createdAt' | 'updatedAt'>;\n\n/**\n * Partial flow for update operations\n */\nexport type FlowUpdateInput = Partial<Omit<Flow, 'id' | 'createdAt' | 'updatedAt'>>;\n",
        "last_modified": "2026-01-02T17:55:06.536730"
      },
      "task_intent": {
        "title": "007-uygulaman-n-genel-yap-s-n-d-zenleyece-iz-yani-uygu",
        "description": "Implement a workflow/flow system for organizing agents and skills into reusable, schedulable processes with input/output handling. This transforms the application from a simple agent manager to a process automation tool where users can define workflows like 'Web Scraper' that take input, run agents with skills, and produce structured outputs.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-02T15:21:47.018073",
  "last_updated": "2026-01-02T15:21:47.030827"
}
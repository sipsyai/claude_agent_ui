{
  "code_improvements": [
    {
      "id": "ci-001",
      "type": "code_improvements",
      "title": "Add Duplicate Agent Functionality",
      "description": "Add ability to duplicate/clone an existing agent with all its configuration, similar to the existing flow duplication feature. This allows users to quickly create agent variants without manually copying configuration.",
      "rationale": "Flow duplication pattern already exists in flow.routes.ts (POST /:id/duplicate endpoint at line 856) and flow-api.ts (duplicateFlow function). Agents share similar CRUD patterns via strapiClient and would benefit from the same clone capability.",
      "builds_upon": ["Flow Duplicate API", "Agent CRUD pattern via StrapiClient"],
      "estimated_effort": "small",
      "affected_files": [
        "src/routes/manager.routes.ts",
        "src/routes/manager.routes.strapi.ts",
        "src/services/strapi-client.ts",
        "src/web/manager/services/api.ts",
        "src/web/manager/components/AgentsPage.tsx"
      ],
      "existing_patterns": [
        "POST /api/flows/:id/duplicate in flow.routes.ts (line 856-889)",
        "duplicateFlow() in web/manager/services/flow-api.ts",
        "strapiClient.createAgent() for creating agent records"
      ],
      "implementation_approach": "1. Add POST /api/manager/agents/:id/duplicate endpoint in manager.routes.ts following flow duplicate pattern. 2. Fetch existing agent, deep clone data, generate new name with ' (Copy)' suffix. 3. Create new agent via strapiClient.createAgent(). 4. Add duplicateAgent() API function in web/manager/services/api.ts. 5. Add 'Duplicate' action button to AgentsPage using existing TrashIcon/PencilIcon pattern.",
      "status": "draft",
      "created_at": "2026-01-02T21:30:00.000Z"
    },
    {
      "id": "ci-002",
      "type": "code_improvements",
      "title": "Add Condition Node Type to Flow Editor",
      "description": "Add a new Condition node type that enables conditional branching in flows based on agent output or input field values. This extends the flow system to support more complex workflow logic.",
      "rationale": "The NodeHandler pattern in flow-nodes is well-established with InputNodeHandler, AgentNodeHandler, and OutputNodeHandler. The architecture supports registering new node types via registerNodeHandler(). Condition nodes would enable if/else branching in flow execution.",
      "builds_upon": ["NodeHandler interface pattern", "Flow Execution Service", "Node Registration Pattern"],
      "estimated_effort": "medium",
      "affected_files": [
        "src/services/flow-nodes/condition-node-handler.ts",
        "src/services/flow-nodes/index.ts",
        "src/types/flow-types.ts",
        "src/web/manager/components/flow-canvas/nodes/ConditionNode.tsx",
        "src/web/manager/components/flow-canvas/NodePalette.tsx"
      ],
      "existing_patterns": [
        "NodeHandler interface in flow-execution-service.ts",
        "AgentNodeHandler class implementation pattern (56-435 lines)",
        "registerAllNodeHandlers() in flow-nodes/index.ts (line 53-57)",
        "BaseNode.tsx component pattern for visual nodes"
      ],
      "implementation_approach": "1. Add ConditionNode type to flow-types.ts with condition expression and true/false output ports. 2. Create ConditionNodeHandler implementing NodeHandler interface with evaluate() logic for JSON path expressions. 3. Register in flow-nodes/index.ts nodeHandlers map. 4. Create ConditionNode.tsx component extending BaseNode pattern with two output handles. 5. Add to NodePalette with conditional branch icon.",
      "status": "draft",
      "created_at": "2026-01-02T21:30:00.000Z"
    },
    {
      "id": "ci-003",
      "type": "code_improvements",
      "title": "Add Keyboard Shortcuts to Chat Page",
      "description": "Extend the keyboard shortcuts pattern from Flow Editor to Chat Page for common operations like send message (Ctrl+Enter), new session (Ctrl+N), and clear selection (Escape).",
      "rationale": "useFlowKeyboardShortcuts hook provides a well-documented 514-line pattern for keyboard shortcuts with cross-platform support (Mac/Windows), input field awareness, and clean event handling. ChatPage could benefit from similar shortcuts for improved accessibility and power-user experience.",
      "builds_upon": ["useFlowKeyboardShortcuts hook", "ChatPage component", "ChatInput component"],
      "estimated_effort": "small",
      "affected_files": [
        "src/web/manager/hooks/useChatKeyboardShortcuts.ts",
        "src/web/manager/components/ChatPage.tsx"
      ],
      "existing_patterns": [
        "useFlowKeyboardShortcuts in hooks/useFlowKeyboardShortcuts.ts",
        "isMac() helper for platform detection (line 247-249)",
        "isInputField() helper for input awareness (line 255-267)",
        "Keyboard event pattern with modKey detection"
      ],
      "implementation_approach": "1. Create useChatKeyboardShortcuts hook following the exact pattern of useFlowKeyboardShortcuts.ts. 2. Implement: Ctrl+Enter to send, Ctrl+N for new session, Ctrl+L to clear chat, Escape to cancel. 3. Use same isMac() and modKey detection pattern. 4. Integrate with ChatPage using enabled option for conditional shortcuts. 5. Add to ChatInput for send shortcut when focused.",
      "status": "draft",
      "created_at": "2026-01-02T21:30:00.000Z"
    },
    {
      "id": "ci-004",
      "type": "code_improvements",
      "title": "Add Search and Filter to Agents Page",
      "description": "Add search box and filter capabilities to AgentsPage matching the pattern already used in SkillSelector component. Enables users to quickly find agents by name or description.",
      "rationale": "SkillSelector already implements real-time search filtering with multi-field search (name AND description). AgentsPage displays agent cards but lacks search functionality. The backend validator (agent.validators.ts) already supports search and filter query parameters via agentQuerySchema.",
      "builds_upon": ["SkillSelector search pattern", "Agent Query Validators", "SearchIcon component"],
      "estimated_effort": "trivial",
      "affected_files": [
        "src/web/manager/components/AgentsPage.tsx"
      ],
      "existing_patterns": [
        "Search filtering in SkillSelector.tsx with useState for searchTerm",
        "SearchIcon from components/ui/Icons.tsx (line 345)",
        "agentQuerySchema.search parameter in agent.validators.ts (line 74-75)",
        "Input component for text input"
      ],
      "implementation_approach": "1. Add useState<string>('') for searchTerm in AgentsPage. 2. Add Input component with SearchIcon at top of agents list section. 3. Implement useMemo filter on agents array: filter by name.toLowerCase().includes(searchTerm.toLowerCase()) OR description.toLowerCase().includes(searchTerm.toLowerCase()). 4. Apply same styling as SkillSelector search input.",
      "status": "draft",
      "created_at": "2026-01-02T21:30:00.000Z"
    },
    {
      "id": "ci-005",
      "type": "code_improvements",
      "title": "Add JSON Export/Import for Agents and Skills",
      "description": "Enable users to export agents and skills configuration as JSON files and import them, following the MCP server export/import pattern. Supports backup, sharing, and environment migration.",
      "rationale": "MCPServersPage already has working export/import functionality (handleExport at line 818-833, handleImportFile at line 857-879). Agents and Skills share similar configuration structures and would benefit from portable configuration export.",
      "builds_upon": ["MCP Server Export/Import pattern", "Agent CRUD", "Skill CRUD"],
      "estimated_effort": "small",
      "affected_files": [
        "src/routes/manager.routes.ts",
        "src/web/manager/services/api.ts",
        "src/web/manager/components/AgentsPage.tsx",
        "src/web/manager/components/SkillsPage.tsx"
      ],
      "existing_patterns": [
        "handleExport() in MCPServersPage.tsx creating Blob and download link",
        "handleImportFile() with FileReader and JSON.parse",
        "GET /api/manager/mcp-servers/export endpoint",
        "POST /api/manager/mcp-servers/import endpoint with mode parameter"
      ],
      "implementation_approach": "1. Add GET /agents/export endpoint returning all agents as JSON. 2. Add POST /agents/import with merge/overwrite mode. 3. Copy handleExport pattern to AgentsPage: JSON.stringify, Blob, download link. 4. Copy handleImportFile pattern with FileReader. 5. Add Export/Import buttons to AgentsPage header. 6. Repeat for SkillsPage.",
      "status": "draft",
      "created_at": "2026-01-02T21:30:00.000Z"
    }
  ]
}
